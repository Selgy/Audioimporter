{"version":3,"file":"main-bf52113c.js","sources":["../../../src/js/lib/cep/csinterface.js","../../../src/js/lib/cep/vulcan.js","../../../cep.config.ts","../../../src/shared/shared.ts","../../../src/js/lib/cep/node.ts","../../../src/js/lib/utils/bolt.ts","../../../node_modules/uuid/dist/esm-browser/stringify.js","../../../node_modules/uuid/dist/esm-browser/rng.js","../../../node_modules/uuid/dist/esm-browser/native.js","../../../node_modules/uuid/dist/esm-browser/v4.js","../../../src/js/main/main.tsx","../../../src/js/main/index.tsx"],"sourcesContent":["/**************************************************************************************************\r\n *\r\n * ADOBE SYSTEMS INCORPORATED\r\n * Copyright 2020 Adobe Systems Incorporated\r\n * All Rights Reserved.\r\n *\r\n * NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance with the\r\n * terms of the Adobe license agreement accompanying it.  If you have received this file from a\r\n * source other than Adobe, then your use, modification, or distribution of it requires the prior\r\n * written permission of Adobe.\r\n *\r\n **************************************************************************************************/\r\n\r\n/** CSInterface - v11.0.0 */\r\n\r\n/**\r\n * Stores constants for the window types supported by the CSXS infrastructure.\r\n */\r\nfunction CSXSWindowType() {}\r\n\r\n/** Constant for the CSXS window type Panel. */\r\nCSXSWindowType._PANEL = \"Panel\";\r\n\r\n/** Constant for the CSXS window type Modeless. */\r\nCSXSWindowType._MODELESS = \"Modeless\";\r\n\r\n/** Constant for the CSXS window type ModalDialog. */\r\nCSXSWindowType._MODAL_DIALOG = \"ModalDialog\";\r\n\r\n/** EvalScript error message */\r\nlet EvalScript_ErrMessage = \"EvalScript error.\";\r\n\r\n/**\r\n * @class Version\r\n * Defines a version number with major, minor, micro, and special\r\n * components. The major, minor and micro values are numeric; the special\r\n * value can be any string.\r\n *\r\n * @param major   The major version component, a positive integer up to nine digits long.\r\n * @param minor   The minor version component, a positive integer up to nine digits long.\r\n * @param micro   The micro version component, a positive integer up to nine digits long.\r\n * @param special The special version component, an arbitrary string.\r\n *\r\n * @return A new \\c Version object.\r\n */\r\nfunction Version(major, minor, micro, special) {\r\n  this.major = major;\r\n  this.minor = minor;\r\n  this.micro = micro;\r\n  this.special = special;\r\n}\r\n\r\n/**\r\n * The maximum value allowed for a numeric version component.\r\n * This reflects the maximum value allowed in PlugPlug and the manifest schema.\r\n */\r\nVersion.MAX_NUM = 999999999;\r\n\r\n/**\r\n * @class VersionBound\r\n * Defines a boundary for a version range, which associates a \\c Version object\r\n * with a flag for whether it is an inclusive or exclusive boundary.\r\n *\r\n * @param version   The \\c #Version object.\r\n * @param inclusive True if this boundary is inclusive, false if it is exclusive.\r\n *\r\n * @return A new \\c VersionBound object.\r\n */\r\nfunction VersionBound(version, inclusive) {\r\n  this.version = version;\r\n  this.inclusive = inclusive;\r\n}\r\n\r\n/**\r\n * @class VersionRange\r\n * Defines a range of versions using a lower boundary and optional upper boundary.\r\n *\r\n * @param lowerBound The \\c #VersionBound object.\r\n * @param upperBound The \\c #VersionBound object, or null for a range with no upper boundary.\r\n *\r\n * @return A new \\c VersionRange object.\r\n */\r\nfunction VersionRange(lowerBound, upperBound) {\r\n  this.lowerBound = lowerBound;\r\n  this.upperBound = upperBound;\r\n}\r\n\r\n/**\r\n * @class Runtime\r\n * Represents a runtime related to the CEP infrastructure.\r\n * Extensions can declare dependencies on particular\r\n * CEP runtime versions in the extension manifest.\r\n *\r\n * @param name    The runtime name.\r\n * @param version A \\c #VersionRange object that defines a range of valid versions.\r\n *\r\n * @return A new \\c Runtime object.\r\n */\r\nfunction Runtime(name, versionRange) {\r\n  this.name = name;\r\n  this.versionRange = versionRange;\r\n}\r\n\r\n/**\r\n * @class Extension\r\n * Encapsulates a CEP-based extension to an Adobe application.\r\n *\r\n * @param id              The unique identifier of this extension.\r\n * @param name            The localizable display name of this extension.\r\n * @param mainPath        The path of the \"index.html\" file.\r\n * @param basePath        The base path of this extension.\r\n * @param windowType          The window type of the main window of this extension.\r\n\t\t\t\t  Valid values are defined by \\c #CSXSWindowType.\r\n * @param width           The default width in pixels of the main window of this extension.\r\n * @param height          The default height in pixels of the main window of this extension.\r\n * @param minWidth        The minimum width in pixels of the main window of this extension.\r\n * @param minHeight       The minimum height in pixels of the main window of this extension.\r\n * @param maxWidth        The maximum width in pixels of the main window of this extension.\r\n * @param maxHeight       The maximum height in pixels of the main window of this extension.\r\n * @param defaultExtensionDataXml The extension data contained in the default \\c ExtensionDispatchInfo section of the extension manifest.\r\n * @param specialExtensionDataXml The extension data contained in the application-specific \\c ExtensionDispatchInfo section of the extension manifest.\r\n * @param requiredRuntimeList     An array of \\c Runtime objects for runtimes required by this extension.\r\n * @param isAutoVisible       True if this extension is visible on loading.\r\n * @param isPluginExtension   True if this extension has been deployed in the Plugins folder of the host application.\r\n *\r\n * @return A new \\c Extension object.\r\n */\r\nfunction Extension(\r\n  id,\r\n  name,\r\n  mainPath,\r\n  basePath,\r\n  windowType,\r\n  width,\r\n  height,\r\n  minWidth,\r\n  minHeight,\r\n  maxWidth,\r\n  maxHeight,\r\n  defaultExtensionDataXml,\r\n  specialExtensionDataXml,\r\n  requiredRuntimeList,\r\n  isAutoVisible,\r\n  isPluginExtension\r\n) {\r\n  this.id = id;\r\n  this.name = name;\r\n  this.mainPath = mainPath;\r\n  this.basePath = basePath;\r\n  this.windowType = windowType;\r\n  this.width = width;\r\n  this.height = height;\r\n  this.minWidth = minWidth;\r\n  this.minHeight = minHeight;\r\n  this.maxWidth = maxWidth;\r\n  this.maxHeight = maxHeight;\r\n  this.defaultExtensionDataXml = defaultExtensionDataXml;\r\n  this.specialExtensionDataXml = specialExtensionDataXml;\r\n  this.requiredRuntimeList = requiredRuntimeList;\r\n  this.isAutoVisible = isAutoVisible;\r\n  this.isPluginExtension = isPluginExtension;\r\n}\r\n\r\n/**\r\n * @class CSEvent\r\n * A standard JavaScript event, the base class for CEP events.\r\n *\r\n * @param type        The name of the event type.\r\n * @param scope       The scope of event, can be \"GLOBAL\" or \"APPLICATION\".\r\n * @param appId       The unique identifier of the application that generated the event.\r\n * @param extensionId     The unique identifier of the extension that generated the event.\r\n *\r\n * @return A new \\c CSEvent object\r\n */\r\nfunction CSEvent(type, scope, appId, extensionId) {\r\n  this.type = type;\r\n  this.scope = scope;\r\n  this.appId = appId;\r\n  this.extensionId = extensionId;\r\n}\r\n\r\n/** Event-specific data. */\r\nCSEvent.prototype.data = \"\";\r\n\r\n/**\r\n * @class SystemPath\r\n * Stores operating-system-specific location constants for use in the\r\n * \\c #CSInterface.getSystemPath() method.\r\n * @return A new \\c SystemPath object.\r\n */\r\nfunction SystemPath() {}\r\n\r\n/** The path to user data.  */\r\nSystemPath.USER_DATA = \"userData\";\r\n\r\n/** The path to common files for Adobe applications.  */\r\nSystemPath.COMMON_FILES = \"commonFiles\";\r\n\r\n/** The path to the user's default document folder.  */\r\nSystemPath.MY_DOCUMENTS = \"myDocuments\";\r\n\r\n/** @deprecated. Use \\c #SystemPath.Extension.  */\r\nSystemPath.APPLICATION = \"application\";\r\n\r\n/** The path to current extension.  */\r\nSystemPath.EXTENSION = \"extension\";\r\n\r\n/** The path to hosting application's executable.  */\r\nSystemPath.HOST_APPLICATION = \"hostApplication\";\r\n\r\n/**\r\n * @class ColorType\r\n * Stores color-type constants.\r\n */\r\nfunction ColorType() {}\r\n\r\n/** RGB color type. */\r\nColorType.RGB = \"rgb\";\r\n\r\n/** Gradient color type. */\r\nColorType.GRADIENT = \"gradient\";\r\n\r\n/** Null color type. */\r\nColorType.NONE = \"none\";\r\n\r\n/**\r\n * @class RGBColor\r\n * Stores an RGB color with red, green, blue, and alpha values.\r\n * All values are in the range [0.0 to 255.0]. Invalid numeric values are\r\n * converted to numbers within this range.\r\n *\r\n * @param red   The red value, in the range [0.0 to 255.0].\r\n * @param green The green value, in the range [0.0 to 255.0].\r\n * @param blue  The blue value, in the range [0.0 to 255.0].\r\n * @param alpha The alpha (transparency) value, in the range [0.0 to 255.0].\r\n *      The default, 255.0, means that the color is fully opaque.\r\n *\r\n * @return A new RGBColor object.\r\n */\r\nfunction RGBColor(red, green, blue, alpha) {\r\n  this.red = red;\r\n  this.green = green;\r\n  this.blue = blue;\r\n  this.alpha = alpha;\r\n}\r\n\r\n/**\r\n * @class Direction\r\n * A point value  in which the y component is 0 and the x component\r\n * is positive or negative for a right or left direction,\r\n * or the x component is 0 and the y component is positive or negative for\r\n * an up or down direction.\r\n *\r\n * @param x     The horizontal component of the point.\r\n * @param y     The vertical component of the point.\r\n *\r\n * @return A new \\c Direction object.\r\n */\r\nfunction Direction(x, y) {\r\n  this.x = x;\r\n  this.y = y;\r\n}\r\n\r\n/**\r\n * @class GradientStop\r\n * Stores gradient stop information.\r\n *\r\n * @param offset   The offset of the gradient stop, in the range [0.0 to 1.0].\r\n * @param rgbColor The color of the gradient at this point, an \\c #RGBColor object.\r\n *\r\n * @return GradientStop object.\r\n */\r\nfunction GradientStop(offset, rgbColor) {\r\n  this.offset = offset;\r\n  this.rgbColor = rgbColor;\r\n}\r\n\r\n/**\r\n  * @class GradientColor\r\n  * Stores gradient color information.\r\n  *\r\n  * @param type          The gradient type, must be \"linear\".\r\n  * @param direction     A \\c #Direction object for the direction of the gradient\r\n\t\t\t\t (up, down, right, or left).\r\n  * @param numStops          The number of stops in the gradient.\r\n  * @param gradientStopList  An array of \\c #GradientStop objects.\r\n  *\r\n  * @return A new \\c GradientColor object.\r\n  */\r\nfunction GradientColor(type, direction, numStops, arrGradientStop) {\r\n  this.type = type;\r\n  this.direction = direction;\r\n  this.numStops = numStops;\r\n  this.arrGradientStop = arrGradientStop;\r\n}\r\n\r\n/**\r\n  * @class UIColor\r\n  * Stores color information, including the type, anti-alias level, and specific color\r\n  * values in a color object of an appropriate type.\r\n  *\r\n  * @param type          The color type, 1 for \"rgb\" and 2 for \"gradient\".\r\n\t\t\t\t The supplied color object must correspond to this type.\r\n  * @param antialiasLevel    The anti-alias level constant.\r\n  * @param color         A \\c #RGBColor or \\c #GradientColor object containing specific color information.\r\n  *\r\n  * @return A new \\c UIColor object.\r\n  */\r\nfunction UIColor(type, antialiasLevel, color) {\r\n  this.type = type;\r\n  this.antialiasLevel = antialiasLevel;\r\n  this.color = color;\r\n}\r\n\r\n/**\r\n * @class AppSkinInfo\r\n * Stores window-skin properties, such as color and font. All color parameter values are \\c #UIColor objects except that systemHighlightColor is \\c #RGBColor object.\r\n *\r\n * @param baseFontFamily        The base font family of the application.\r\n * @param baseFontSize          The base font size of the application.\r\n * @param appBarBackgroundColor     The application bar background color.\r\n * @param panelBackgroundColor      The background color of the extension panel.\r\n * @param appBarBackgroundColorSRGB     The application bar background color, as sRGB.\r\n * @param panelBackgroundColorSRGB      The background color of the extension panel, as sRGB.\r\n * @param systemHighlightColor          The highlight color of the extension panel, if provided by the host application. Otherwise, the operating-system highlight color.\r\n *\r\n * @return AppSkinInfo object.\r\n */\r\nfunction AppSkinInfo(\r\n  baseFontFamily,\r\n  baseFontSize,\r\n  appBarBackgroundColor,\r\n  panelBackgroundColor,\r\n  appBarBackgroundColorSRGB,\r\n  panelBackgroundColorSRGB,\r\n  systemHighlightColor\r\n) {\r\n  this.baseFontFamily = baseFontFamily;\r\n  this.baseFontSize = baseFontSize;\r\n  this.appBarBackgroundColor = appBarBackgroundColor;\r\n  this.panelBackgroundColor = panelBackgroundColor;\r\n  this.appBarBackgroundColorSRGB = appBarBackgroundColorSRGB;\r\n  this.panelBackgroundColorSRGB = panelBackgroundColorSRGB;\r\n  this.systemHighlightColor = systemHighlightColor;\r\n}\r\n\r\n/**\r\n * @class HostEnvironment\r\n * Stores information about the environment in which the extension is loaded.\r\n *\r\n * @param appName   The application's name.\r\n * @param appVersion    The application's version.\r\n * @param appLocale The application's current license locale.\r\n * @param appUILocale   The application's current UI locale.\r\n * @param appId     The application's unique identifier.\r\n * @param isAppOnline  True if the application is currently online.\r\n * @param appSkinInfo   An \\c #AppSkinInfo object containing the application's default color and font styles.\r\n *\r\n * @return A new \\c HostEnvironment object.\r\n */\r\nfunction HostEnvironment(\r\n  appName,\r\n  appVersion,\r\n  appLocale,\r\n  appUILocale,\r\n  appId,\r\n  isAppOnline,\r\n  appSkinInfo\r\n) {\r\n  this.appName = appName;\r\n  this.appVersion = appVersion;\r\n  this.appLocale = appLocale;\r\n  this.appUILocale = appUILocale;\r\n  this.appId = appId;\r\n  this.isAppOnline = isAppOnline;\r\n  this.appSkinInfo = appSkinInfo;\r\n}\r\n\r\n/**\r\n * @class HostCapabilities\r\n * Stores information about the host capabilities.\r\n *\r\n * @param EXTENDED_PANEL_MENU True if the application supports panel menu.\r\n * @param EXTENDED_PANEL_ICONS True if the application supports panel icon.\r\n * @param DELEGATE_APE_ENGINE True if the application supports delegated APE engine.\r\n * @param SUPPORT_HTML_EXTENSIONS True if the application supports HTML extensions.\r\n * @param DISABLE_FLASH_EXTENSIONS True if the application disables FLASH extensions.\r\n *\r\n * @return A new \\c HostCapabilities object.\r\n */\r\nfunction HostCapabilities(\r\n  EXTENDED_PANEL_MENU,\r\n  EXTENDED_PANEL_ICONS,\r\n  DELEGATE_APE_ENGINE,\r\n  SUPPORT_HTML_EXTENSIONS,\r\n  DISABLE_FLASH_EXTENSIONS\r\n) {\r\n  this.EXTENDED_PANEL_MENU = EXTENDED_PANEL_MENU;\r\n  this.EXTENDED_PANEL_ICONS = EXTENDED_PANEL_ICONS;\r\n  this.DELEGATE_APE_ENGINE = DELEGATE_APE_ENGINE;\r\n  this.SUPPORT_HTML_EXTENSIONS = SUPPORT_HTML_EXTENSIONS;\r\n  this.DISABLE_FLASH_EXTENSIONS = DISABLE_FLASH_EXTENSIONS; // Since 5.0.0\r\n}\r\n\r\n/**\r\n * @class ApiVersion\r\n * Stores current api version.\r\n *\r\n * Since 4.2.0\r\n *\r\n * @param major  The major version\r\n * @param minor  The minor version.\r\n * @param micro  The micro version.\r\n *\r\n * @return ApiVersion object.\r\n */\r\nfunction ApiVersion(major, minor, micro) {\r\n  this.major = major;\r\n  this.minor = minor;\r\n  this.micro = micro;\r\n}\r\n\r\n/**\r\n * @class MenuItemStatus\r\n * Stores flyout menu item status\r\n *\r\n * Since 5.2.0\r\n *\r\n * @param menuItemLabel  The menu item label.\r\n * @param enabled        True if user wants to enable the menu item.\r\n * @param checked        True if user wants to check the menu item.\r\n *\r\n * @return MenuItemStatus object.\r\n */\r\nfunction MenuItemStatus(menuItemLabel, enabled, checked) {\r\n  this.menuItemLabel = menuItemLabel;\r\n  this.enabled = enabled;\r\n  this.checked = checked;\r\n}\r\n\r\n/**\r\n * @class ContextMenuItemStatus\r\n * Stores the status of the context menu item.\r\n *\r\n * Since 5.2.0\r\n *\r\n * @param menuItemID     The menu item id.\r\n * @param enabled        True if user wants to enable the menu item.\r\n * @param checked        True if user wants to check the menu item.\r\n *\r\n * @return MenuItemStatus object.\r\n */\r\nfunction ContextMenuItemStatus(menuItemID, enabled, checked) {\r\n  this.menuItemID = menuItemID;\r\n  this.enabled = enabled;\r\n  this.checked = checked;\r\n}\r\n//------------------------------ CSInterface ----------------------------------\r\n\r\n/**\r\n * @class CSInterface\r\n * This is the entry point to the CEP extensibility infrastructure.\r\n * Instantiate this object and use it to:\r\n * <ul>\r\n * <li>Access information about the host application in which an extension is running</li>\r\n * <li>Launch an extension</li>\r\n * <li>Register interest in event notifications, and dispatch events</li>\r\n * </ul>\r\n *\r\n * @return A new \\c CSInterface object\r\n */\r\nfunction CSInterface() {}\r\n\r\n/**\r\n * User can add this event listener to handle native application theme color changes.\r\n * Callback function gives extensions ability to fine-tune their theme color after the\r\n * global theme color has been changed.\r\n * The callback function should be like below:\r\n *\r\n * @example\r\n * // event is a CSEvent object, but user can ignore it.\r\n * function OnAppThemeColorChanged(event)\r\n * {\r\n *    // Should get a latest HostEnvironment object from application.\r\n *    var skinInfo = JSON.parse(window.__adobe_cep__.getHostEnvironment()).appSkinInfo;\r\n *    // Gets the style information such as color info from the skinInfo,\r\n *    // and redraw all UI controls of your extension according to the style info.\r\n * }\r\n */\r\nCSInterface.THEME_COLOR_CHANGED_EVENT =\r\n  \"com.adobe.csxs.events.ThemeColorChanged\";\r\n\r\n/** The host environment data object. */\r\nCSInterface.prototype.hostEnvironment = window.__adobe_cep__\r\n  ? JSON.parse(window.__adobe_cep__.getHostEnvironment())\r\n  : null;\r\n\r\n/** Retrieves information about the host environment in which the\r\n *  extension is currently running.\r\n *\r\n *   @return A \\c #HostEnvironment object.\r\n */\r\nCSInterface.prototype.getHostEnvironment = function () {\r\n  this.hostEnvironment = JSON.parse(window.__adobe_cep__.getHostEnvironment());\r\n  return this.hostEnvironment;\r\n};\r\n\r\n/** Loads binary file created which is located at url asynchronously\r\n *\r\n *@param urlName url at which binary file is located. Local files should start with 'file://'\r\n *@param callback Optional. A callback function that returns after binary is loaded\r\n *@example\r\n * To create JS binary use command ./cep_compiler test.js test.bin\r\n * To load JS binary asyncronously\r\n *   var CSLib = new CSInterface();\r\n *   CSLib.loadBinAsync(url, function () { });\r\n */\r\nCSInterface.prototype.loadBinAsync = function (urlName, callback) {\r\n  try {\r\n    var xhr = new XMLHttpRequest();\r\n    xhr.responseType = \"arraybuffer\"; // make response as ArrayBuffer\r\n    xhr.open(\"GET\", urlName, true);\r\n    xhr.onerror = function () {\r\n      console.log(\"Unable to load snapshot from given URL\");\r\n      return false;\r\n    };\r\n    xhr.send();\r\n    xhr.onload = () => {\r\n      window.__adobe_cep__.loadSnapshot(xhr.response);\r\n      if (typeof callback === \"function\") {\r\n        callback();\r\n      } else if (typeof callback !== \"undefined\") {\r\n        console.log(\"Provided callback is not a function\");\r\n      }\r\n    };\r\n  } catch (err) {\r\n    console.log(err);\r\n    return false;\r\n  }\r\n\r\n  return true;\r\n};\r\n\r\n/** Loads binary file created synchronously\r\n *\r\n *@param pathName the local path at which binary file is located\r\n *@example\r\n * To create JS binary use command ./cep_compiler test.js test.bin\r\n * To load JS binary syncronously\r\n *   var CSLib = new CSInterface();\r\n *   CSLib.loadBinSync(path);\r\n */\r\nCSInterface.prototype.loadBinSync = function (pathName) {\r\n  try {\r\n    var OSVersion = this.getOSInformation();\r\n    if (pathName.startsWith(\"file://\")) {\r\n      if (OSVersion.indexOf(\"Windows\") >= 0) {\r\n        pathName = pathName.replace(\"file:///\", \"\");\r\n      } else if (OSVersion.indexOf(\"Mac\") >= 0) {\r\n        pathName = pathName.replace(\"file://\", \"\");\r\n      }\r\n      window.__adobe_cep__.loadSnapshot(pathName);\r\n      return true;\r\n    }\r\n  } catch (err) {\r\n    console.log(err);\r\n    return false;\r\n  }\r\n  //control should not come here\r\n  return false;\r\n};\r\n\r\n/** Closes this extension. */\r\nCSInterface.prototype.closeExtension = function () {\r\n  window.__adobe_cep__.closeExtension();\r\n};\r\n\r\n/**\r\n * Retrieves a path for which a constant is defined in the system.\r\n *\r\n * @param pathType The path-type constant defined in \\c #SystemPath ,\r\n *\r\n * @return The platform-specific system path string.\r\n */\r\nCSInterface.prototype.getSystemPath = function (pathType) {\r\n  var path = decodeURI(window.__adobe_cep__.getSystemPath(pathType));\r\n  var OSVersion = this.getOSInformation();\r\n  if (OSVersion.indexOf(\"Windows\") >= 0) {\r\n    path = path.replace(\"file:///\", \"\");\r\n  } else if (OSVersion.indexOf(\"Mac\") >= 0) {\r\n    path = path.replace(\"file://\", \"\");\r\n  }\r\n  return path;\r\n};\r\n\r\n/**\r\n * Evaluates a JavaScript script, which can use the JavaScript DOM\r\n * of the host application.\r\n *\r\n * @param script    The JavaScript script.\r\n * @param callback  Optional. A callback function that receives the result of execution.\r\n *          If execution fails, the callback function receives the error message \\c EvalScript_ErrMessage.\r\n */\r\nCSInterface.prototype.evalScript = function (script, callback) {\r\n  if (callback === null || callback === undefined) {\r\n    callback = function (result) {};\r\n  }\r\n  window.__adobe_cep__.evalScript(script, callback);\r\n};\r\n\r\n/**\r\n * Retrieves the unique identifier of the application.\r\n * in which the extension is currently running.\r\n *\r\n * @return The unique ID string.\r\n */\r\nCSInterface.prototype.getApplicationID = function () {\r\n  var appId = this.hostEnvironment.appId;\r\n  return appId;\r\n};\r\n\r\n/**\r\n * Retrieves host capability information for the application\r\n * in which the extension is currently running.\r\n *\r\n * @return A \\c #HostCapabilities object.\r\n */\r\nCSInterface.prototype.getHostCapabilities = function () {\r\n  var hostCapabilities = JSON.parse(window.__adobe_cep__.getHostCapabilities());\r\n  return hostCapabilities;\r\n};\r\n\r\n/**\r\n * Triggers a CEP event programmatically. Yoy can use it to dispatch\r\n * an event of a predefined type, or of a type you have defined.\r\n *\r\n * @param event A \\c CSEvent object.\r\n */\r\nCSInterface.prototype.dispatchEvent = function (event) {\r\n  if (typeof event.data == \"object\") {\r\n    event.data = JSON.stringify(event.data);\r\n  }\r\n\r\n  window.__adobe_cep__.dispatchEvent(event);\r\n};\r\n\r\n/**\r\n * Registers an interest in a CEP event of a particular type, and\r\n * assigns an event handler.\r\n * The event infrastructure notifies your extension when events of this type occur,\r\n * passing the event object to the registered handler function.\r\n *\r\n * @param type     The name of the event type of interest.\r\n * @param listener The JavaScript handler function or method.\r\n * @param obj      Optional, the object containing the handler method, if any.\r\n *         Default is null.\r\n */\r\nCSInterface.prototype.addEventListener = function (type, listener, obj) {\r\n  window.__adobe_cep__.addEventListener(type, listener, obj);\r\n};\r\n\r\n/**\r\n * Removes a registered event listener.\r\n *\r\n * @param type      The name of the event type of interest.\r\n * @param listener  The JavaScript handler function or method that was registered.\r\n * @param obj       Optional, the object containing the handler method, if any.\r\n *          Default is null.\r\n */\r\nCSInterface.prototype.removeEventListener = function (type, listener, obj) {\r\n  window.__adobe_cep__.removeEventListener(type, listener, obj);\r\n};\r\n\r\n/**\r\n * Loads and launches another extension, or activates the extension if it is already loaded.\r\n *\r\n * @param extensionId       The extension's unique identifier.\r\n * @param startupParams     Not currently used, pass \"\".\r\n *\r\n * @example\r\n * To launch the extension \"help\" with ID \"HLP\" from this extension, call:\r\n * <code>requestOpenExtension(\"HLP\", \"\"); </code>\r\n *\r\n */\r\nCSInterface.prototype.requestOpenExtension = function (extensionId, params) {\r\n  window.__adobe_cep__.requestOpenExtension(extensionId, params);\r\n};\r\n\r\n/**\r\n * Retrieves the list of extensions currently loaded in the current host application.\r\n * The extension list is initialized once, and remains the same during the lifetime\r\n * of the CEP session.\r\n *\r\n * @param extensionIds  Optional, an array of unique identifiers for extensions of interest.\r\n *          If omitted, retrieves data for all extensions.\r\n *\r\n * @return Zero or more \\c #Extension objects.\r\n */\r\nCSInterface.prototype.getExtensions = function (extensionIds) {\r\n  var extensionIdsStr = JSON.stringify(extensionIds);\r\n  var extensionsStr = window.__adobe_cep__.getExtensions(extensionIdsStr);\r\n\r\n  var extensions = JSON.parse(extensionsStr);\r\n  return extensions;\r\n};\r\n\r\n/**\r\n * Retrieves network-related preferences.\r\n *\r\n * @return A JavaScript object containing network preferences.\r\n */\r\nCSInterface.prototype.getNetworkPreferences = function () {\r\n  var result = window.__adobe_cep__.getNetworkPreferences();\r\n  var networkPre = JSON.parse(result);\r\n\r\n  return networkPre;\r\n};\r\n\r\n/**\r\n * Initializes the resource bundle for this extension with property values\r\n * for the current application and locale.\r\n * To support multiple locales, you must define a property file for each locale,\r\n * containing keyed display-string values for that locale.\r\n * See localization documentation for Extension Builder and related products.\r\n *\r\n * Keys can be in the\r\n * form <code>key.value=\"localized string\"</code>, for use in HTML text elements.\r\n * For example, in this input element, the localized \\c key.value string is displayed\r\n * instead of the empty \\c value string:\r\n *\r\n * <code><input type=\"submit\" value=\"\" data-locale=\"key\"/></code>\r\n *\r\n * @return An object containing the resource bundle information.\r\n */\r\nCSInterface.prototype.initResourceBundle = function () {\r\n  var resourceBundle = JSON.parse(window.__adobe_cep__.initResourceBundle());\r\n  var resElms = document.querySelectorAll(\"[data-locale]\");\r\n  for (var n = 0; n < resElms.length; n++) {\r\n    var resEl = resElms[n];\r\n    // Get the resource key from the element.\r\n    var resKey = resEl.getAttribute(\"data-locale\");\r\n    if (resKey) {\r\n      // Get all the resources that start with the key.\r\n      for (var key in resourceBundle) {\r\n        if (key.indexOf(resKey) === 0) {\r\n          var resValue = resourceBundle[key];\r\n          if (key.length == resKey.length) {\r\n            resEl.innerHTML = resValue;\r\n          } else if (\".\" == key.charAt(resKey.length)) {\r\n            var attrKey = key.substring(resKey.length + 1);\r\n            resEl[attrKey] = resValue;\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }\r\n  return resourceBundle;\r\n};\r\n\r\n/**\r\n * Writes installation information to a file.\r\n *\r\n * @return The file path.\r\n */\r\nCSInterface.prototype.dumpInstallationInfo = function () {\r\n  return window.__adobe_cep__.dumpInstallationInfo();\r\n};\r\n\r\n/**\r\n * Retrieves version information for the current Operating System,\r\n * See http://www.useragentstring.com/pages/Chrome/ for Chrome \\c navigator.userAgent values.\r\n *\r\n * @return A string containing the OS version, or \"unknown Operation System\".\r\n * If user customizes the User Agent by setting CEF command parameter \"--user-agent\", only\r\n * \"Mac OS X\" or \"Windows\" will be returned.\r\n */\r\nCSInterface.prototype.getOSInformation = function () {\r\n  var userAgent = navigator.userAgent;\r\n\r\n  if (navigator.platform == \"Win32\" || navigator.platform == \"Windows\") {\r\n    var winVersion = \"Windows\";\r\n    var winBit = \"\";\r\n    if (userAgent.indexOf(\"Windows\") > -1) {\r\n      if (userAgent.indexOf(\"Windows NT 5.0\") > -1) {\r\n        winVersion = \"Windows 2000\";\r\n      } else if (userAgent.indexOf(\"Windows NT 5.1\") > -1) {\r\n        winVersion = \"Windows XP\";\r\n      } else if (userAgent.indexOf(\"Windows NT 5.2\") > -1) {\r\n        winVersion = \"Windows Server 2003\";\r\n      } else if (userAgent.indexOf(\"Windows NT 6.0\") > -1) {\r\n        winVersion = \"Windows Vista\";\r\n      } else if (userAgent.indexOf(\"Windows NT 6.1\") > -1) {\r\n        winVersion = \"Windows 7\";\r\n      } else if (userAgent.indexOf(\"Windows NT 6.2\") > -1) {\r\n        winVersion = \"Windows 8\";\r\n      } else if (userAgent.indexOf(\"Windows NT 6.3\") > -1) {\r\n        winVersion = \"Windows 8.1\";\r\n      } else if (userAgent.indexOf(\"Windows NT 10\") > -1) {\r\n        winVersion = \"Windows 10\";\r\n      }\r\n\r\n      if (userAgent.indexOf(\"WOW64\") > -1 || userAgent.indexOf(\"Win64\") > -1) {\r\n        winBit = \" 64-bit\";\r\n      } else {\r\n        winBit = \" 32-bit\";\r\n      }\r\n    }\r\n\r\n    return winVersion + winBit;\r\n  } else if (\r\n    navigator.platform == \"MacIntel\" ||\r\n    navigator.platform == \"Macintosh\"\r\n  ) {\r\n    var result = \"Mac OS X\";\r\n\r\n    if (userAgent.indexOf(\"Mac OS X\") > -1) {\r\n      result = userAgent.substring(\r\n        userAgent.indexOf(\"Mac OS X\"),\r\n        userAgent.indexOf(\")\")\r\n      );\r\n      result = result.replace(/_/g, \".\");\r\n    }\r\n\r\n    return result;\r\n  }\r\n\r\n  return \"Unknown Operation System\";\r\n};\r\n\r\n/**\r\n * Opens a page in the default system browser.\r\n *\r\n * Since 4.2.0\r\n *\r\n * @param url  The URL of the page/file to open, or the email address.\r\n * Must use HTTP/HTTPS/file/mailto protocol. For example:\r\n *   \"http://www.adobe.com\"\r\n *   \"https://github.com\"\r\n *   \"file:///C:/log.txt\"\r\n *   \"mailto:test@adobe.com\"\r\n *\r\n * @return One of these error codes:\\n\r\n *      <ul>\\n\r\n *          <li>NO_ERROR - 0</li>\\n\r\n *          <li>ERR_UNKNOWN - 1</li>\\n\r\n *          <li>ERR_INVALID_PARAMS - 2</li>\\n\r\n *          <li>ERR_INVALID_URL - 201</li>\\n\r\n *      </ul>\\n\r\n */\r\nCSInterface.prototype.openURLInDefaultBrowser = function (url) {\r\n  return cep.util.openURLInDefaultBrowser(url);\r\n};\r\n\r\n/**\r\n * Retrieves extension ID.\r\n *\r\n * Since 4.2.0\r\n *\r\n * @return extension ID.\r\n */\r\nCSInterface.prototype.getExtensionID = function () {\r\n  return window.__adobe_cep__.getExtensionId();\r\n};\r\n\r\n/**\r\n * Retrieves the scale factor of screen.\r\n * On Windows platform, the value of scale factor might be different from operating system's scale factor,\r\n * since host application may use its self-defined scale factor.\r\n *\r\n * Since 4.2.0\r\n *\r\n * @return One of the following float number.\r\n *      <ul>\\n\r\n *          <li> -1.0 when error occurs </li>\\n\r\n *          <li> 1.0 means normal screen </li>\\n\r\n *          <li> >1.0 means HiDPI screen </li>\\n\r\n *      </ul>\\n\r\n */\r\nCSInterface.prototype.getScaleFactor = function () {\r\n  return window.__adobe_cep__.getScaleFactor();\r\n};\r\n\r\n/**\r\n * Retrieves the scale factor of Monitor.\r\n *\r\n * Since 8.5.0\r\n *\r\n * @return value >= 1.0f\r\n * only available for windows machine\r\n */\r\nif (navigator.appVersion.toLowerCase().indexOf(\"windows\") >= 0) {\r\n  CSInterface.prototype.getMonitorScaleFactor = function () {\r\n    return window.__adobe_cep__.getMonitorScaleFactor();\r\n  };\r\n}\r\n\r\n/**\r\n * Set a handler to detect any changes of scale factor. This only works on Mac.\r\n *\r\n * Since 4.2.0\r\n *\r\n * @param handler   The function to be called when scale factor is changed.\r\n *\r\n */\r\nCSInterface.prototype.setScaleFactorChangedHandler = function (handler) {\r\n  window.__adobe_cep__.setScaleFactorChangedHandler(handler);\r\n};\r\n\r\n/**\r\n * Retrieves current API version.\r\n *\r\n * Since 4.2.0\r\n *\r\n * @return ApiVersion object.\r\n *\r\n */\r\nCSInterface.prototype.getCurrentApiVersion = function () {\r\n  var apiVersion = JSON.parse(window.__adobe_cep__.getCurrentApiVersion());\r\n  return apiVersion;\r\n};\r\n\r\n/**\r\n * Set panel flyout menu by an XML.\r\n *\r\n * Since 5.2.0\r\n *\r\n * Register a callback function for \"com.adobe.csxs.events.flyoutMenuClicked\" to get notified when a\r\n * menu item is clicked.\r\n * The \"data\" attribute of event is an object which contains \"menuId\" and \"menuName\" attributes.\r\n *\r\n * Register callback functions for \"com.adobe.csxs.events.flyoutMenuOpened\" and \"com.adobe.csxs.events.flyoutMenuClosed\"\r\n * respectively to get notified when flyout menu is opened or closed.\r\n *\r\n * @param menu     A XML string which describes menu structure.\r\n * An example menu XML:\r\n * <Menu>\r\n *   <MenuItem Id=\"menuItemId1\" Label=\"TestExample1\" Enabled=\"true\" Checked=\"false\"/>\r\n *   <MenuItem Label=\"TestExample2\">\r\n *     <MenuItem Label=\"TestExample2-1\" >\r\n *       <MenuItem Label=\"TestExample2-1-1\" Enabled=\"false\" Checked=\"true\"/>\r\n *     </MenuItem>\r\n *     <MenuItem Label=\"TestExample2-2\" Enabled=\"true\" Checked=\"true\"/>\r\n *   </MenuItem>\r\n *   <MenuItem Label=\"---\" />\r\n *   <MenuItem Label=\"TestExample3\" Enabled=\"false\" Checked=\"false\"/>\r\n * </Menu>\r\n *\r\n */\r\nCSInterface.prototype.setPanelFlyoutMenu = function (menu) {\r\n  if (\"string\" != typeof menu) {\r\n    return;\r\n  }\r\n\r\n  window.__adobe_cep__.invokeSync(\"setPanelFlyoutMenu\", menu);\r\n};\r\n\r\n/**\r\n * Updates a menu item in the extension window's flyout menu, by setting the enabled\r\n * and selection status.\r\n *\r\n * Since 5.2.0\r\n *\r\n * @param menuItemLabel The menu item label.\r\n * @param enabled       True to enable the item, false to disable it (gray it out).\r\n * @param checked       True to select the item, false to deselect it.\r\n *\r\n * @return false when the host application does not support this functionality (HostCapabilities.EXTENDED_PANEL_MENU is false).\r\n *         Fails silently if menu label is invalid.\r\n *\r\n * @see HostCapabilities.EXTENDED_PANEL_MENU\r\n */\r\nCSInterface.prototype.updatePanelMenuItem = function (\r\n  menuItemLabel,\r\n  enabled,\r\n  checked\r\n) {\r\n  var ret = false;\r\n  if (this.getHostCapabilities().EXTENDED_PANEL_MENU) {\r\n    var itemStatus = new MenuItemStatus(menuItemLabel, enabled, checked);\r\n    ret = window.__adobe_cep__.invokeSync(\r\n      \"updatePanelMenuItem\",\r\n      JSON.stringify(itemStatus)\r\n    );\r\n  }\r\n  return ret;\r\n};\r\n\r\n/**\r\n  * Set context menu by XML string.\r\n  *\r\n  * Since 5.2.0\r\n  *\r\n  * There are a number of conventions used to communicate what type of menu item to create and how it should be handled.\r\n  * - an item without menu ID or menu name is disabled and is not shown.\r\n  * - if the item name is \"---\" (three hyphens) then it is treated as a separator. The menu ID in this case will always be NULL.\r\n  * - Checkable attribute takes precedence over Checked attribute.\r\n  * - a PNG icon. For optimal display results please supply a 16 x 16px icon as larger dimensions will increase the size of the menu item.\r\n\t  The Chrome extension contextMenus API was taken as a reference.\r\n\t  https://developer.chrome.com/extensions/contextMenus\r\n  * - the items with icons and checkable items cannot coexist on the same menu level. The former take precedences over the latter.\r\n  *\r\n  * @param menu      A XML string which describes menu structure.\r\n  * @param callback  The callback function which is called when a menu item is clicked. The only parameter is the returned ID of clicked menu item.\r\n  *\r\n  * @description An example menu XML:\r\n  * <Menu>\r\n  *   <MenuItem Id=\"menuItemId1\" Label=\"TestExample1\" Enabled=\"true\" Checkable=\"true\" Checked=\"false\" Icon=\"./image/small_16X16.png\"/>\r\n  *   <MenuItem Id=\"menuItemId2\" Label=\"TestExample2\">\r\n  *     <MenuItem Id=\"menuItemId2-1\" Label=\"TestExample2-1\" >\r\n  *       <MenuItem Id=\"menuItemId2-1-1\" Label=\"TestExample2-1-1\" Enabled=\"false\" Checkable=\"true\" Checked=\"true\"/>\r\n  *     </MenuItem>\r\n  *     <MenuItem Id=\"menuItemId2-2\" Label=\"TestExample2-2\" Enabled=\"true\" Checkable=\"true\" Checked=\"true\"/>\r\n  *   </MenuItem>\r\n  *   <MenuItem Label=\"---\" />\r\n  *   <MenuItem Id=\"menuItemId3\" Label=\"TestExample3\" Enabled=\"false\" Checkable=\"true\" Checked=\"false\"/>\r\n  * </Menu>\r\n  */\r\nCSInterface.prototype.setContextMenu = function (menu, callback) {\r\n  if (\"string\" != typeof menu) {\r\n    return;\r\n  }\r\n\r\n  window.__adobe_cep__.invokeAsync(\"setContextMenu\", menu, callback);\r\n};\r\n\r\n/**\r\n  * Set context menu by JSON string.\r\n  *\r\n  * Since 6.0.0\r\n  *\r\n  * There are a number of conventions used to communicate what type of menu item to create and how it should be handled.\r\n  * - an item without menu ID or menu name is disabled and is not shown.\r\n  * - if the item label is \"---\" (three hyphens) then it is treated as a separator. The menu ID in this case will always be NULL.\r\n  * - Checkable attribute takes precedence over Checked attribute.\r\n  * - a PNG icon. For optimal display results please supply a 16 x 16px icon as larger dimensions will increase the size of the menu item.\r\n\t  The Chrome extension contextMenus API was taken as a reference.\r\n  * - the items with icons and checkable items cannot coexist on the same menu level. The former take precedences over the latter.\r\n\t  https://developer.chrome.com/extensions/contextMenus\r\n  *\r\n  * @param menu      A JSON string which describes menu structure.\r\n  * @param callback  The callback function which is called when a menu item is clicked. The only parameter is the returned ID of clicked menu item.\r\n  *\r\n  * @description An example menu JSON:\r\n  *\r\n  * {\r\n  *      \"menu\": [\r\n  *          {\r\n  *              \"id\": \"menuItemId1\",\r\n  *              \"label\": \"testExample1\",\r\n  *              \"enabled\": true,\r\n  *              \"checkable\": true,\r\n  *              \"checked\": false,\r\n  *              \"icon\": \"./image/small_16X16.png\"\r\n  *          },\r\n  *          {\r\n  *              \"id\": \"menuItemId2\",\r\n  *              \"label\": \"testExample2\",\r\n  *              \"menu\": [\r\n  *                  {\r\n  *                      \"id\": \"menuItemId2-1\",\r\n  *                      \"label\": \"testExample2-1\",\r\n  *                      \"menu\": [\r\n  *                          {\r\n  *                              \"id\": \"menuItemId2-1-1\",\r\n  *                              \"label\": \"testExample2-1-1\",\r\n  *                              \"enabled\": false,\r\n  *                              \"checkable\": true,\r\n  *                              \"checked\": true\r\n  *                          }\r\n  *                      ]\r\n  *                  },\r\n  *                  {\r\n  *                      \"id\": \"menuItemId2-2\",\r\n  *                      \"label\": \"testExample2-2\",\r\n  *                      \"enabled\": true,\r\n  *                      \"checkable\": true,\r\n  *                      \"checked\": true\r\n  *                  }\r\n  *              ]\r\n  *          },\r\n  *          {\r\n  *              \"label\": \"---\"\r\n  *          },\r\n  *          {\r\n  *              \"id\": \"menuItemId3\",\r\n  *              \"label\": \"testExample3\",\r\n  *              \"enabled\": false,\r\n  *              \"checkable\": true,\r\n  *              \"checked\": false\r\n  *          }\r\n  *      ]\r\n  *  }\r\n  *\r\n  */\r\nCSInterface.prototype.setContextMenuByJSON = function (menu, callback) {\r\n  if (\"string\" != typeof menu) {\r\n    return;\r\n  }\r\n\r\n  window.__adobe_cep__.invokeAsync(\"setContextMenuByJSON\", menu, callback);\r\n};\r\n\r\n/**\r\n * Updates a context menu item by setting the enabled and selection status.\r\n *\r\n * Since 5.2.0\r\n *\r\n * @param menuItemID    The menu item ID.\r\n * @param enabled       True to enable the item, false to disable it (gray it out).\r\n * @param checked       True to select the item, false to deselect it.\r\n */\r\nCSInterface.prototype.updateContextMenuItem = function (\r\n  menuItemID,\r\n  enabled,\r\n  checked\r\n) {\r\n  var itemStatus = new ContextMenuItemStatus(menuItemID, enabled, checked);\r\n  ret = window.__adobe_cep__.invokeSync(\r\n    \"updateContextMenuItem\",\r\n    JSON.stringify(itemStatus)\r\n  );\r\n};\r\n\r\n/**\r\n * Get the visibility status of an extension window.\r\n *\r\n * Since 6.0.0\r\n *\r\n * @return true if the extension window is visible; false if the extension window is hidden.\r\n */\r\nCSInterface.prototype.isWindowVisible = function () {\r\n  return window.__adobe_cep__.invokeSync(\"isWindowVisible\", \"\");\r\n};\r\n\r\n/**\r\n * Resize extension's content to the specified dimensions.\r\n * 1. Works with modal and modeless extensions in all Adobe products.\r\n * 2. Extension's manifest min/max size constraints apply and take precedence.\r\n * 3. For panel extensions\r\n *    3.1 This works in all Adobe products except:\r\n *        * Premiere Pro\r\n *        * Prelude\r\n *        * After Effects\r\n *    3.2 When the panel is in certain states (especially when being docked),\r\n *        it will not change to the desired dimensions even when the\r\n *        specified size satisfies min/max constraints.\r\n *\r\n * Since 6.0.0\r\n *\r\n * @param width  The new width\r\n * @param height The new height\r\n */\r\nCSInterface.prototype.resizeContent = function (width, height) {\r\n  window.__adobe_cep__.resizeContent(width, height);\r\n};\r\n\r\n/**\r\n * Register the invalid certificate callback for an extension.\r\n * This callback will be triggered when the extension tries to access the web site that contains the invalid certificate on the main frame.\r\n * But if the extension does not call this function and tries to access the web site containing the invalid certificate, a default error page will be shown.\r\n *\r\n * Since 6.1.0\r\n *\r\n * @param callback the callback function\r\n */\r\nCSInterface.prototype.registerInvalidCertificateCallback = function (callback) {\r\n  return window.__adobe_cep__.registerInvalidCertificateCallback(callback);\r\n};\r\n\r\n/**\r\n  * Register an interest in some key events to prevent them from being sent to the host application.\r\n  *\r\n  * This function works with modeless extensions and panel extensions.\r\n  * Generally all the key events will be sent to the host application for these two extensions if the current focused element\r\n  * is not text input or dropdown,\r\n  * If you want to intercept some key events and want them to be handled in the extension, please call this function\r\n  * in advance to prevent them being sent to the host application.\r\n  *\r\n  * Since 6.1.0\r\n  *\r\n  * @param keyEventsInterest      A JSON string describing those key events you are interested in. A null object or\r\n\t\t\t\t\t\t\t\t  an empty string will lead to removing the interest\r\n  *\r\n  * This JSON string should be an array, each object has following keys:\r\n  *\r\n  * keyCode:  [Required] represents an OS system dependent virtual key code identifying\r\n  *           the unmodified value of the pressed key.\r\n  * ctrlKey:  [optional] a Boolean that indicates if the control key was pressed (true) or not (false) when the event occurred.\r\n  * altKey:   [optional] a Boolean that indicates if the alt key was pressed (true) or not (false) when the event occurred.\r\n  * shiftKey: [optional] a Boolean that indicates if the shift key was pressed (true) or not (false) when the event occurred.\r\n  * metaKey:  [optional] (Mac Only) a Boolean that indicates if the Meta key was pressed (true) or not (false) when the event occurred.\r\n  *                      On Macintosh keyboards, this is the command key. To detect Windows key on Windows, please use keyCode instead.\r\n  * An example JSON string:\r\n  *\r\n  * [\r\n  *     {\r\n  *         \"keyCode\": 48\r\n  *     },\r\n  *     {\r\n  *         \"keyCode\": 123,\r\n  *         \"ctrlKey\": true\r\n  *     },\r\n  *     {\r\n  *         \"keyCode\": 123,\r\n  *         \"ctrlKey\": true,\r\n  *         \"metaKey\": true\r\n  *     }\r\n  * ]\r\n  *\r\n  */\r\nCSInterface.prototype.registerKeyEventsInterest = function (keyEventsInterest) {\r\n  return window.__adobe_cep__.registerKeyEventsInterest(keyEventsInterest);\r\n};\r\n\r\n/**\r\n * Set the title of the extension window.\r\n * This function works with modal and modeless extensions in all Adobe products, and panel extensions in Photoshop, InDesign, InCopy, Illustrator, Flash Pro and Dreamweaver.\r\n *\r\n * Since 6.1.0\r\n *\r\n * @param title The window title.\r\n */\r\nCSInterface.prototype.setWindowTitle = function (title) {\r\n  window.__adobe_cep__.invokeSync(\"setWindowTitle\", title);\r\n};\r\n\r\n/**\r\n * Get the title of the extension window.\r\n * This function works with modal and modeless extensions in all Adobe products, and panel extensions in Photoshop, InDesign, InCopy, Illustrator, Flash Pro and Dreamweaver.\r\n *\r\n * Since 6.1.0\r\n *\r\n * @return The window title.\r\n */\r\nCSInterface.prototype.getWindowTitle = function () {\r\n  return window.__adobe_cep__.invokeSync(\"getWindowTitle\", \"\");\r\n};\r\n\r\n// Boilerplate Added Export\r\nexport default CSInterface;\r\nexport {\r\n  CSXSWindowType,\r\n  Version,\r\n  VersionBound,\r\n  VersionRange,\r\n  Runtime,\r\n  Extension,\r\n  CSEvent,\r\n  SystemPath,\r\n  ColorType,\r\n  RGBColor,\r\n  Direction,\r\n  GradientStop,\r\n  GradientColor,\r\n  UIColor,\r\n  AppSkinInfo,\r\n  HostEnvironment,\r\n  HostCapabilities,\r\n  ApiVersion,\r\n  MenuItemStatus,\r\n  ContextMenuItemStatus,\r\n  CSInterface,\r\n};\r\n","/**************************************************************************************************\r\n *\r\n * ADOBE SYSTEMS INCORPORATED\r\n * Copyright 2020 Adobe Systems Incorporated\r\n * All Rights Reserved.\r\n *\r\n * NOTICE:  Adobe permits you to use, modify, and distribute this file in accordance with the\r\n * terms of the Adobe license agreement accompanying it.  If you have received this file from a\r\n * source other than Adobe, then your use, modification, or distribution of it requires the prior\r\n * written permission of Adobe.\r\n *\r\n **************************************************************************************************/\r\n\r\n/** Vulcan - v11.2.0 */\r\n\r\n/**\r\n * @class Vulcan\r\n *\r\n * The singleton instance, <tt>VulcanInterface</tt>, provides an interface\r\n * to the Vulcan. Allows you to launch CC applications\r\n * and discover information about them.\r\n */\r\nfunction Vulcan() {}\r\n\r\n/**\r\n * Gets all available application SAPCode-Specifiers on the local machine.\r\n *\r\n * Vulcan Control New 6.x APIs, and Deprecating older Vulcan Control APIs.\r\n * Changes : New getTargetSpecifiersEx returns productSAPCodeSpecifiers\r\n *\r\n * @return The array of all available application SAPCode-Specifiers.\r\n */\r\nVulcan.prototype.getTargetSpecifiersEx = function () {\r\n  var params = {};\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanGetTargetSpecifiersEx\",\r\n      JSON.stringify(params)\r\n    )\r\n  );\r\n};\r\n\r\n/**\r\n * Launches a CC application on the local machine, if it is not already running.\r\n *\r\n * Vulcan Control New 6.x APIs, and Deprecating older Vulcan Control APIs.\r\n * Changes : New launchAppEx uses productSAPCodeSpecifiers\r\n *\r\n * @param productSAPCodeSpecifier The application specifier; for example \"ILST-25.2.3\", \"ILST-25\", \"ILST-25.2.3-en_US\" and \"ILST. Refer to `Documentation/CEP 11.1 HTML Extension Cookbook.md#applications-integrated-with-cep` for product SAPCode.\r\n * @param focus           True to launch in foreground, or false to launch in the background.\r\n * @param cmdLine         Optional, command-line parameters to supply to the launch command.\r\n * @return True if the app can be launched, false otherwise.\r\n */\r\nVulcan.prototype.launchAppEx = function (\r\n  productSAPCodeSpecifier,\r\n  focus,\r\n  cmdLine\r\n) {\r\n  if (!requiredParamsValid(productSAPCodeSpecifier)) {\r\n    return false;\r\n  }\r\n\r\n  var params = {};\r\n  params.productSAPCodeSpecifier = productSAPCodeSpecifier;\r\n  params.focus = focus ? \"true\" : \"false\";\r\n  params.cmdLine = requiredParamsValid(cmdLine) ? cmdLine : \"\";\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\"vulcanLaunchAppEx\", JSON.stringify(params))\r\n  ).result;\r\n};\r\n\r\n/**\r\n * Checks whether a CC application is running on the local machine.\r\n *\r\n * Vulcan Control New 6.x APIs, and Deprecating older Vulcan Control APIs.\r\n * Changes : New isAppRunningEx uses productSAPCodeSpecifiers\r\n *\r\n * @param productSAPCodeSpecifier The application specifier; for example \"ILST-25.2.3\", \"ILST-25\", \"ILST-25.2.3-en_US\" and \"ILST. Refer to `Documentation/CEP 11.1 HTML Extension Cookbook.md#applications-integrated-with-cep` for product SAPCode.\r\n * @return True if the app is running, false otherwise.\r\n */\r\nVulcan.prototype.isAppRunningEx = function (productSAPCodeSpecifier) {\r\n  if (!requiredParamsValid(productSAPCodeSpecifier)) {\r\n    return false;\r\n  }\r\n\r\n  var params = {};\r\n  params.productSAPCodeSpecifier = productSAPCodeSpecifier;\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanIsAppRunningEx\",\r\n      JSON.stringify(params)\r\n    )\r\n  ).result;\r\n};\r\n\r\n/**\r\n * Checks whether a CC application is installed on the local machine.\r\n *\r\n * Vulcan Control New 6.x APIs, and Deprecating older Vulcan Control APIs.\r\n * Changes : New isAppInstalledEx uses productSAPCodeSpecifiers\r\n *\r\n * @param productSAPCodeSpecifier The application specifier; for example \"ILST-25.2.3\", \"ILST-25\", \"ILST-25.2.3-en_US\" and \"ILST. Refer to `Documentation/CEP 11.1 HTML Extension Cookbook.md#applications-integrated-with-cep` for product SAPCode.\r\n * @return True if the app is installed, false otherwise.\r\n */\r\nVulcan.prototype.isAppInstalledEx = function (productSAPCodeSpecifier) {\r\n  if (!requiredParamsValid(productSAPCodeSpecifier)) {\r\n    return false;\r\n  }\r\n\r\n  var params = {};\r\n  params.productSAPCodeSpecifier = productSAPCodeSpecifier;\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanIsAppInstalledEx\",\r\n      JSON.stringify(params)\r\n    )\r\n  ).result;\r\n};\r\n\r\n/**s\r\n * Retrieves the local install path of a CC application.\r\n *\r\n * Vulcan Control New 6.x APIs, and Deprecating older Vulcan Control APIs.\r\n * Changes : New getAppPathEx uses productSAPCodeSpecifiers\r\n *\r\n * @param productSAPCodeSpecifier The application specifier; for example \"ILST-25.2.3\", \"ILST-25\", \"ILST-25.2.3-en_US\" and \"ILST. Refer to `Documentation/CEP 11.1 HTML Extension Cookbook.md#applications-integrated-with-cep` for product SAPCode.\r\n * @return The path string if the application is found, \"\" otherwise.\r\n */\r\nVulcan.prototype.getAppPathEx = function (productSAPCodeSpecifier) {\r\n  if (!requiredParamsValid(productSAPCodeSpecifier)) {\r\n    return \"\";\r\n  }\r\n\r\n  var params = {};\r\n  params.productSAPCodeSpecifier = productSAPCodeSpecifier;\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanGetAppPathEx\",\r\n      JSON.stringify(params)\r\n    )\r\n  ).result;\r\n};\r\n\r\n/**\r\n * DEPRECATED API:: use getTargetSpecifiersEx\r\n * Gets all available application specifiers on the local machine.\r\n *\r\n * @return The array of all available application specifiers.\r\n */\r\nVulcan.prototype.getTargetSpecifiers = function () {\r\n  console.warn(\r\n    \"WARNING! Function 'getTargetSpecifiers' has been deprecated, please use the new 'getTargetSpecifiersEx' function instead!\"\r\n  );\r\n  var params = {};\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanGetTargetSpecifiers\",\r\n      JSON.stringify(params)\r\n    )\r\n  );\r\n};\r\n\r\n/**\r\n * DEPRECATED API:: use launchAppEx\r\n * Launches a CC application on the local machine, if it is not already running.\r\n *\r\n * @param targetSpecifier The application specifier; for example \"indesign\".\r\n *\r\n *        Note: In Windows 7 64-bit or Windows 8 64-bit system, some target applications (like Photoshop and Illustrator) have both 32-bit version\r\n *        and 64-bit version. Therefore, we need to specify the version by this parameter with \"photoshop-70.032\" or \"photoshop-70.064\". If you\r\n *        installed Photoshop 32-bit and 64-bit on one Windows 64-bit system and invoke this interface with parameter \"photoshop-70.032\", you may\r\n *        receive wrong result.\r\n *        The specifiers for Illustrator is \"illustrator-17.032\", \"illustrator-17.064\", \"illustrator-17\" and \"illustrator\".\r\n *\r\n *        In other platforms there is no such issue, so we can use \"photoshop\" or \"photoshop-70\" as specifier.\r\n * @param focus           True to launch in foreground, or false to launch in the background.\r\n * @param cmdLine         Optional, command-line parameters to supply to the launch command.\r\n * @return True if the app can be launched, false otherwise.\r\n */\r\nVulcan.prototype.launchApp = function (targetSpecifier, focus, cmdLine) {\r\n  console.warn(\r\n    \"WARNING! Function 'launchApp' has been deprecated, please use the new 'launchAppEx' function instead!\"\r\n  );\r\n  if (!requiredParamsValid(targetSpecifier)) {\r\n    return false;\r\n  }\r\n\r\n  var params = {};\r\n  params.targetSpecifier = targetSpecifier;\r\n  params.focus = focus ? \"true\" : \"false\";\r\n  params.cmdLine = requiredParamsValid(cmdLine) ? cmdLine : \"\";\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\"vulcanLaunchApp\", JSON.stringify(params))\r\n  ).result;\r\n};\r\n\r\n/**\r\n * DEPRECATED API:: use isAppRunningEx\r\n * Checks whether a CC application is running on the local machine.\r\n *\r\n * @param targetSpecifier The application specifier; for example \"indesign\".\r\n *\r\n *        Note: In Windows 7 64-bit or Windows 8 64-bit system, some target applications (like Photoshop and Illustrator) have both 32-bit version\r\n *        and 64-bit version. Therefore, we need to specify the version by this parameter with \"photoshop-70.032\" or \"photoshop-70.064\". If you\r\n *        installed Photoshop 32-bit and 64-bit on one Windows 64-bit system and invoke this interface with parameter \"photoshop-70.032\", you may\r\n *        receive wrong result.\r\n *        The specifiers for Illustrator is \"illustrator-17.032\", \"illustrator-17.064\", \"illustrator-17\" and \"illustrator\".\r\n *\r\n *        In other platforms there is no such issue, so we can use \"photoshop\" or \"photoshop-70\" as specifier.\r\n * @return True if the app is running, false otherwise.\r\n */\r\nVulcan.prototype.isAppRunning = function (targetSpecifier) {\r\n  console.warn(\r\n    \"WARNING! Function 'isAppRunning' has been deprecated, please use the new 'isAppRunningEx' function instead!\"\r\n  );\r\n  if (!requiredParamsValid(targetSpecifier)) {\r\n    return false;\r\n  }\r\n\r\n  var params = {};\r\n  params.targetSpecifier = targetSpecifier;\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanIsAppRunning\",\r\n      JSON.stringify(params)\r\n    )\r\n  ).result;\r\n};\r\n\r\n/**\r\n * DEPRECATED API:: use isAppInstalledEx\r\n * Checks whether a CC application is installed on the local machine.\r\n *\r\n * @param targetSpecifier The application specifier; for example \"indesign\".\r\n *\r\n *        Note: In Windows 7 64-bit or Windows 8 64-bit system, some target applications (like Photoshop and Illustrator) have both 32-bit version\r\n *        and 64-bit version. Therefore, we need to specify the version by this parameter with \"photoshop-70.032\" or \"photoshop-70.064\". If you\r\n *        installed Photoshop 32-bit and 64-bit on one Windows 64-bit system and invoke this interface with parameter \"photoshop-70.032\", you may\r\n *        receive wrong result.\r\n *        The specifiers for Illustrator is \"illustrator-17.032\", \"illustrator-17.064\", \"illustrator-17\" and \"illustrator\".\r\n *\r\n *        In other platforms there is no such issue, so we can use \"photoshop\" or \"photoshop-70\" as specifier.\r\n * @return True if the app is installed, false otherwise.\r\n */\r\nVulcan.prototype.isAppInstalled = function (targetSpecifier) {\r\n  console.warn(\r\n    \"WARNING! Function 'isAppInstalled' has been deprecated, please use the new 'isAppInstalledEx' function instead!\"\r\n  );\r\n  if (!requiredParamsValid(targetSpecifier)) {\r\n    return false;\r\n  }\r\n\r\n  var params = {};\r\n  params.targetSpecifier = targetSpecifier;\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanIsAppInstalled\",\r\n      JSON.stringify(params)\r\n    )\r\n  ).result;\r\n};\r\n\r\n/**\r\n * DEPRECATED API:: use getAppPathEx\r\n * Retrieves the local install path of a CC application.\r\n *\r\n * @param targetSpecifier The application specifier; for example \"indesign\".\r\n *\r\n *        Note: In Windows 7 64-bit or Windows 8 64-bit system, some target applications (like Photoshop and Illustrator) have both 32-bit version\r\n *        and 64-bit version. Therefore, we need to specify the version by this parameter with \"photoshop-70.032\" or \"photoshop-70.064\". If you\r\n *        installed Photoshop 32-bit and 64-bit on one Windows 64-bit system and invoke this interface with parameter \"photoshop-70.032\", you may\r\n *        receive wrong result.\r\n *        The specifiers for Illustrator is \"illustrator-17.032\", \"illustrator-17.064\", \"illustrator-17\" and \"illustrator\".\r\n *\r\n *        In other platforms there is no such issue, so we can use \"photoshop\" or \"photoshop-70\" as specifier.\r\n * @return The path string if the application is found, \"\" otherwise.\r\n */\r\nVulcan.prototype.getAppPath = function (targetSpecifier) {\r\n  console.warn(\r\n    \"WARNING! Function 'getAppPath' has been deprecated, please use the new 'getAppPathEx' function instead!\"\r\n  );\r\n  if (!requiredParamsValid(targetSpecifier)) {\r\n    return \"\";\r\n  }\r\n\r\n  var params = {};\r\n  params.targetSpecifier = targetSpecifier;\r\n\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\"vulcanGetAppPath\", JSON.stringify(params))\r\n  ).result;\r\n};\r\n\r\n/**\r\n * Registers a message listener callback function for a Vulcan message.\r\n *\r\n * @param type            The message type.\r\n * @param callback        The callback function that handles the message.\r\n *                        Takes one argument, the message object.\r\n * @param obj             Optional, the object containing the callback method, if any.\r\n *                        Default is null.\r\n */\r\nVulcan.prototype.addMessageListener = function (type, callback, obj) {\r\n  if (\r\n    !requiredParamsValid(type, callback) ||\r\n    !strStartsWith(type, VulcanMessage.TYPE_PREFIX)\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  var params = {};\r\n  params.type = type;\r\n\r\n  window.__adobe_cep__.invokeAsync(\r\n    \"vulcanAddMessageListener\",\r\n    JSON.stringify(params),\r\n    callback,\r\n    obj\r\n  );\r\n};\r\n\r\n/**\r\n * Removes a registered message listener callback function for a Vulcan message.\r\n *\r\n * @param type            The message type.\r\n * @param callback        The callback function that was registered.\r\n *                        Takes one argument, the message object.\r\n * @param obj             Optional, the object containing the callback method, if any.\r\n *                        Default is null.\r\n */\r\nVulcan.prototype.removeMessageListener = function (type, callback, obj) {\r\n  if (\r\n    !requiredParamsValid(type, callback) ||\r\n    !strStartsWith(type, VulcanMessage.TYPE_PREFIX)\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  var params = {};\r\n  params.type = type;\r\n\r\n  window.__adobe_cep__.invokeAsync(\r\n    \"vulcanRemoveMessageListener\",\r\n    JSON.stringify(params),\r\n    callback,\r\n    obj\r\n  );\r\n};\r\n\r\n/**\r\n * Dispatches a Vulcan message.\r\n *\r\n * @param vulcanMessage   The message object.\r\n */\r\nVulcan.prototype.dispatchMessage = function (vulcanMessage) {\r\n  if (\r\n    !requiredParamsValid(vulcanMessage) ||\r\n    !strStartsWith(vulcanMessage.type, VulcanMessage.TYPE_PREFIX)\r\n  ) {\r\n    return;\r\n  }\r\n\r\n  var params = {};\r\n  var message = new VulcanMessage(vulcanMessage.type);\r\n  message.initialize(vulcanMessage);\r\n  params.vulcanMessage = message;\r\n\r\n  window.__adobe_cep__.invokeSync(\r\n    \"vulcanDispatchMessage\",\r\n    JSON.stringify(params)\r\n  );\r\n};\r\n\r\n/**\r\n * Retrieves the message payload of a Vulcan message for the registered message listener callback function.\r\n *\r\n * @param vulcanMessage   The message object.\r\n * @return                A string containing the message payload.\r\n */\r\nVulcan.prototype.getPayload = function (vulcanMessage) {\r\n  if (\r\n    !requiredParamsValid(vulcanMessage) ||\r\n    !strStartsWith(vulcanMessage.type, VulcanMessage.TYPE_PREFIX)\r\n  ) {\r\n    return null;\r\n  }\r\n\r\n  var message = new VulcanMessage(vulcanMessage.type);\r\n  message.initialize(vulcanMessage);\r\n  return message.getPayload();\r\n};\r\n\r\n/**\r\n * Gets all available endpoints of the running Vulcan-enabled applications.\r\n *\r\n * Since 7.0.0\r\n *\r\n * @return                The array of all available endpoints.\r\n * An example endpoint string:\r\n * <endPoint>\r\n *   <appId>PHXS</appId>\r\n *   <appVersion>16.1.0</appVersion>\r\n * </endPoint>\r\n */\r\nVulcan.prototype.getEndPoints = function () {\r\n  var params = {};\r\n  return JSON.parse(\r\n    window.__adobe_cep__.invokeSync(\r\n      \"vulcanGetEndPoints\",\r\n      JSON.stringify(params)\r\n    )\r\n  );\r\n};\r\n\r\n/**\r\n * Gets the endpoint for itself.\r\n *\r\n * Since 7.0.0\r\n *\r\n * @return                The endpoint string for itself.\r\n */\r\nVulcan.prototype.getSelfEndPoint = function () {\r\n  var params = {};\r\n  return window.__adobe_cep__.invokeSync(\r\n    \"vulcanGetSelfEndPoint\",\r\n    JSON.stringify(params)\r\n  );\r\n};\r\n\r\n/** Singleton instance of Vulcan **/\r\nvar VulcanInterface = new Vulcan();\r\n\r\n//--------------------------------- Vulcan Message ------------------------------\r\n\r\n/**\r\n * @class VulcanMessage\r\n * Message type for sending messages between host applications.\r\n * A message of this type can be sent to the designated destination\r\n * when appId and appVersion are provided and valid. Otherwise,\r\n * the message is broadcast to all running Vulcan-enabled applications.\r\n *\r\n * To send a message between extensions running within one\r\n * application, use the <code>CSEvent</code> type in CSInterface.js.\r\n *\r\n * @param type            The message type.\r\n * @param appId           The peer appId.\r\n * @param appVersion      The peer appVersion.\r\n *\r\n */\r\nfunction VulcanMessage(type, appId, appVersion) {\r\n  this.type = type;\r\n  this.scope = VulcanMessage.SCOPE_SUITE;\r\n  this.appId = requiredParamsValid(appId)\r\n    ? appId\r\n    : VulcanMessage.DEFAULT_APP_ID;\r\n  this.appVersion = requiredParamsValid(appVersion)\r\n    ? appVersion\r\n    : VulcanMessage.DEFAULT_APP_VERSION;\r\n  this.data = VulcanMessage.DEFAULT_DATA;\r\n}\r\n\r\nVulcanMessage.TYPE_PREFIX = \"vulcan.SuiteMessage.\";\r\nVulcanMessage.SCOPE_SUITE = \"GLOBAL\";\r\nVulcanMessage.DEFAULT_APP_ID = \"UNKNOWN\";\r\nVulcanMessage.DEFAULT_APP_VERSION = \"UNKNOWN\";\r\nVulcanMessage.DEFAULT_DATA = \"<data><payload></payload></data>\";\r\nVulcanMessage.dataTemplate = \"<data>{0}</data>\";\r\nVulcanMessage.payloadTemplate = \"<payload>{0}</payload>\";\r\n\r\n/**\r\n * Initializes this message instance.\r\n *\r\n * @param message         A \\c message instance to use for initialization.\r\n */\r\nVulcanMessage.prototype.initialize = function (message) {\r\n  this.type = message.type;\r\n  this.scope = message.scope;\r\n  this.appId = message.appId;\r\n  this.appVersion = message.appVersion;\r\n  this.data = message.data;\r\n};\r\n\r\n/**\r\n * Retrieves the message data.\r\n *\r\n * @return A data string in XML format.\r\n */\r\nVulcanMessage.prototype.xmlData = function () {\r\n  if (this.data === undefined) {\r\n    var str = \"\";\r\n    str = String.format(VulcanMessage.payloadTemplate, str);\r\n    this.data = String.format(VulcanMessage.dataTemplate, str);\r\n  }\r\n  return this.data;\r\n};\r\n\r\n/**\r\n * Sets the message payload of this message.\r\n *\r\n * @param payload         A string containing the message payload.\r\n */\r\nVulcanMessage.prototype.setPayload = function (payload) {\r\n  var str = cep.encoding.convertion.utf8_to_b64(payload);\r\n  str = String.format(VulcanMessage.payloadTemplate, str);\r\n  this.data = String.format(VulcanMessage.dataTemplate, str);\r\n};\r\n\r\n/**\r\n * Retrieves the message payload of this message.\r\n *\r\n * @return                A string containing the message payload.\r\n */\r\nVulcanMessage.prototype.getPayload = function () {\r\n  var str = GetValueByKey(this.data, \"payload\");\r\n  if (str !== null) {\r\n    return cep.encoding.convertion.b64_to_utf8(str);\r\n  }\r\n  return null;\r\n};\r\n\r\n/**\r\n * Converts the properties of this instance to a string.\r\n *\r\n * @return The string version of this instance.\r\n */\r\nVulcanMessage.prototype.toString = function () {\r\n  var str = \"type=\" + this.type;\r\n  str += \", scope=\" + this.scope;\r\n  str += \", appId=\" + this.appId;\r\n  str += \", appVersion=\" + this.appVersion;\r\n  str += \", data=\" + this.xmlData();\r\n  return str;\r\n};\r\n\r\n//--------------------------------------- Util --------------------------------\r\n\r\n/**\r\n * Formats a string based on a template.\r\n *\r\n * @param src The format template.\r\n *\r\n * @return The formatted string\r\n */\r\nString.format = function (src) {\r\n  if (arguments.length === 0) {\r\n    return null;\r\n  }\r\n\r\n  var args = Array.prototype.slice.call(arguments, 1);\r\n  return src.replace(/\\{(\\d+)\\}/g, function (m, i) {\r\n    return args[i];\r\n  });\r\n};\r\n\r\n/**\r\n * Retrieves the content of an XML element.\r\n *\r\n * @param xmlStr    The XML string.\r\n * @param key       The name of the tag.\r\n *\r\n * @return          The content of the tag, or the empty string\r\n *                  if such tag is not found or the tag has no content.\r\n */\r\nfunction GetValueByKey(xmlStr, key) {\r\n  if (window.DOMParser) {\r\n    var parser = new window.DOMParser();\r\n    try {\r\n      var xmlDoc = parser.parseFromString(xmlStr, \"text/xml\");\r\n      var node = xmlDoc.getElementsByTagName(key)[0];\r\n      if (node && node.childNodes[0]) {\r\n        return node.childNodes[0].nodeValue;\r\n      }\r\n    } catch (e) {\r\n      //log the error\r\n    }\r\n  }\r\n  return \"\";\r\n}\r\n\r\n/**\r\n * Reports whether required parameters are valid.\r\n *\r\n * @return    True if all required parameters are valid,\r\n *            false if any of the required parameters are invalid.\r\n */\r\nfunction requiredParamsValid() {\r\n  for (var i = 0; i < arguments.length; i++) {\r\n    var argument = arguments[i];\r\n    if (argument === undefined || argument === null) {\r\n      return false;\r\n    }\r\n  }\r\n  return true;\r\n}\r\n\r\n/**\r\n * Reports whether a string has a given prefix.\r\n *\r\n * @param str       The target string.\r\n * @param prefix    The specific prefix string.\r\n *\r\n * @return          True if the string has the prefix, false if not.\r\n */\r\nfunction strStartsWith(str, prefix) {\r\n  if (typeof str != \"string\") {\r\n    return false;\r\n  }\r\n  return str.indexOf(prefix) === 0;\r\n}\r\n\r\n// Boilerplate Added Export\r\nexport { VulcanMessage };\r\nexport default Vulcan;\r\n","import { CEP_Config } from \"vite-cep-plugin\";\r\nimport { version } from \"./package.json\";\r\n\r\nconst config: CEP_Config = {\r\n  version,\r\n  id: \"com.AudioImporterV2.cep\",\r\n  displayName: \"Audio Importer V2\",\r\n  symlink: \"local\",\r\n  port: 3000,\r\n  servePort: 5000,\r\n  startingDebugPort: 8850,\r\n  extensionManifestVersion: 6.0,\r\n  requiredRuntimeVersion: 9.0,\r\n  hosts: [\r\n    { name: \"PPRO\", version: \"[0.0,99.9]\" }\r\n  ],\r\n  type: \"Panel\",\r\n  iconDarkNormal: \"./src/assets/light-icon.png\",\r\n  iconNormal: \"./src/assets/dark-icon.png\",\r\n  iconDarkNormalRollOver: \"./src/assets/light-icon.png\",\r\n  iconNormalRollOver: \"./src/assets/dark-icon.png\",\r\n  parameters: [\"--v=0\", \"--enable-nodejs\", \"--mixed-context\"],\r\n  width: 500,\r\n  height: 550,\r\n\r\n  panels: [\r\n    {\r\n      mainPath: \"./main/index.html\",\r\n      name: \"main\",\r\n      panelDisplayName: \"Audio Importer V2\",\r\n      autoVisible: true,\r\n      width: 710,\r\n      height: 500,\r\n      minWidth: 710,\r\n      minHeight: 350,\r\n      maxWidth: 710,\r\n      maxHeight: 850,\r\n      type: \"Modeless\", // Change the panel type\r\n      // Other possible types for the panel\r\n      // \"Panel\" - Standard panel\r\n      // \"ModalDialog\" - Modal dialog\r\n      // \"Modeless\" - Modeless dialog\r\n      // \"Custom\" - Custom type, often used for background tasks or other custom implementations\r\n\r\n    },\r\n    {\r\n      mainPath: \"./settings/index.html\", \r\n      name: \"settings\", \r\n      autoVisible: false, \r\n      type: \"Custom\", \r\n      startOnEvents: [\"com.adobe.csxs.events.ApplicationInitialized\", \"applicationActive\"], \r\n      height: 1, \r\n    }\r\n  ],\r\n  build: {\r\n    jsxBin: \"off\",\r\n    sourceMap: true,\r\n  },\r\n  zxp: {\r\n    country: \"US\",\r\n    province: \"CA\",\r\n    org: \"MyCompany\",\r\n    password: \"mypassword\",\r\n    tsa: \"http://timestamp.digicert.com/\",\r\n    sourceMap: false,\r\n    jsxBin: \"off\",\r\n  },\r\n  installModules: [],\r\n  copyAssets: [\r\n    \"./target/release/audio_importer.exe\",\r\n    \"./js\",\r\n    \"./jsx\",\r\n  ],\r\n\r\n\r\n  copyZipAssets: [],\r\n};\r\n\r\nexport default config;","import config from \"../../cep.config\";\r\nexport const ns = config.id;\r\n","// Abstracted built-in Node.js Modules\r\n\r\n//@ts-ignore\r\nexport const crypto = (\r\n  typeof window.cep !== \"undefined\" ? require(\"crypto\") : {}\r\n) as typeof import(\"crypto\");\r\nexport const assert = (\r\n  typeof window.cep !== \"undefined\" ? require(\"assert\") : {}\r\n) as typeof import(\"assert\");\r\nexport const buffer = (\r\n  typeof window.cep !== \"undefined\" ? require(\"buffer\") : {}\r\n) as typeof import(\"buffer\");\r\nexport const child_process = (\r\n  typeof window.cep !== \"undefined\" ? require(\"child_process\") : {}\r\n) as typeof import(\"child_process\");\r\nexport const cluster = (\r\n  typeof window.cep !== \"undefined\" ? require(\"cluster\") : {}\r\n) as typeof import(\"cluster\");\r\nexport const dgram = (\r\n  typeof window.cep !== \"undefined\" ? require(\"dgram\") : {}\r\n) as typeof import(\"dgram\");\r\nexport const dns = (\r\n  typeof window.cep !== \"undefined\" ? require(\"dns\") : {}\r\n) as typeof import(\"dns\");\r\nexport const domain = (\r\n  typeof window.cep !== \"undefined\" ? require(\"domain\") : {}\r\n) as typeof import(\"domain\");\r\nexport const events = (\r\n  typeof window.cep !== \"undefined\" ? require(\"events\") : {}\r\n) as typeof import(\"events\");\r\nexport const fs = (\r\n  typeof window.cep !== \"undefined\" ? require(\"fs\") : {}\r\n) as typeof import(\"fs\");\r\nexport const http = (\r\n  typeof window.cep !== \"undefined\" ? require(\"http\") : {}\r\n) as typeof import(\"http\");\r\nexport const https = (\r\n  typeof window.cep !== \"undefined\" ? require(\"https\") : {}\r\n) as typeof import(\"https\");\r\nexport const net = (\r\n  typeof window.cep !== \"undefined\" ? require(\"net\") : {}\r\n) as typeof import(\"net\");\r\nexport const os = (\r\n  typeof window.cep !== \"undefined\" ? require(\"os\") : {}\r\n) as typeof import(\"os\");\r\nexport const path = (\r\n  typeof window.cep !== \"undefined\" ? require(\"path\") : {}\r\n) as typeof import(\"path\");\r\nexport const punycode = (\r\n  typeof window.cep !== \"undefined\" ? require(\"punycode\") : {}\r\n) as typeof import(\"punycode\");\r\nexport const querystring = (\r\n  typeof window.cep !== \"undefined\" ? require(\"querystring\") : {}\r\n) as typeof import(\"querystring\");\r\nexport const readline = (\r\n  typeof window.cep !== \"undefined\" ? require(\"readline\") : {}\r\n) as typeof import(\"readline\");\r\nexport const stream = (\r\n  typeof window.cep !== \"undefined\" ? require(\"stream\") : {}\r\n) as typeof import(\"stream\");\r\nexport const string_decoder = (\r\n  typeof window.cep !== \"undefined\" ? require(\"string_decoder\") : {}\r\n) as typeof import(\"string_decoder\");\r\nexport const timers = (\r\n  typeof window.cep !== \"undefined\" ? require(\"timers\") : {}\r\n) as typeof import(\"timers\");\r\nexport const tls = (\r\n  typeof window.cep !== \"undefined\" ? require(\"tls\") : {}\r\n) as typeof import(\"tls\");\r\nexport const tty = (\r\n  typeof window.cep !== \"undefined\" ? require(\"tty\") : {}\r\n) as typeof import(\"tty\");\r\nexport const url = (\r\n  typeof window.cep !== \"undefined\" ? require(\"url\") : {}\r\n) as typeof import(\"url\");\r\nexport const util = (\r\n  typeof window.cep !== \"undefined\" ? require(\"util\") : {}\r\n) as typeof import(\"util\");\r\nexport const v8 = (\r\n  typeof window.cep !== \"undefined\" ? require(\"v8\") : {}\r\n) as typeof import(\"v8\");\r\nexport const vm = (\r\n  typeof window.cep !== \"undefined\" ? require(\"vm\") : {}\r\n) as typeof import(\"vm\");\r\nexport const zlib = (\r\n  typeof window.cep !== \"undefined\" ? require(\"zlib\") : {}\r\n) as typeof import(\"zlib\");\r\n","import CSInterface, { CSEvent } from \"../cep/csinterface\";\r\nimport Vulcan, { VulcanMessage } from \"../cep/vulcan\";\r\nimport { ns } from \"../../../shared/shared\";\r\nimport { fs } from \"../cep/node\";\r\n\r\nexport const csi = new CSInterface();\r\nexport const vulcan = new Vulcan();\r\n\r\n// jsx utils\r\n\r\n/**\r\n * @function EvalES\r\n * Evaluates a string in ExtendScript scoped to the project's namespace\r\n * Optionally, pass true to the isGlobal param to avoid scoping\r\n *\r\n * @param script    The script as a string to be evaluated\r\n * @param isGlobal  Optional. Defaults to false,\r\n *\r\n * @return String Result.\r\n */\r\n\r\nexport const evalES = (script: string, isGlobal = false): Promise<string> => {\r\n  return new Promise(function (resolve, reject) {\r\n    const pre = isGlobal\r\n      ? \"\"\r\n      : `var host = typeof $ !== 'undefined' ? $ : window; host[\"${ns}\"].`;\r\n    const fullString = pre + script;\r\n    csi.evalScript(\r\n      \"try{\" + fullString + \"}catch(e){alert(e);}\",\r\n      (res: string) => {\r\n        resolve(res);\r\n      }\r\n    );\r\n  });\r\n};\r\n\r\nimport type { Scripts } from \"@esTypes/index\";\r\nimport type { EventTS } from \"../../../shared/universals\";\r\n\r\ntype ArgTypes<F extends Function> = F extends (...args: infer A) => any\r\n  ? A\r\n  : never;\r\ntype ReturnType<F extends Function> = F extends (...args: infer A) => infer B\r\n  ? B\r\n  : never;\r\n\r\n/**\r\n * @description End-to-end type-safe ExtendScript evaluation with error handling\r\n * Call ExtendScript functions from CEP with type-safe parameters and return types.\r\n * Any ExtendScript errors are captured and logged to the CEP console for tracing\r\n *\r\n * @param functionName The name of the function to be evaluated.\r\n * @param args the list of arguments taken by the function.\r\n *\r\n * @return Promise resolving to function native return type.\r\n *\r\n * @example\r\n * // CEP\r\n * evalTS(\"myFunc\", 60, 'test').then((res) => {\r\n *    console.log(res.word);\r\n * });\r\n *\r\n * // ExtendScript\r\n * export const myFunc = (num: number, word: string) => {\r\n *    return { num, word };\r\n * }\r\n *\r\n */\r\n\r\nexport const evalTS = <\r\n  Key extends string & keyof Scripts,\r\n  Func extends Function & Scripts[Key]\r\n>(\r\n  functionName: Key,\r\n  ...args: ArgTypes<Func>\r\n): Promise<ReturnType<Func>> => {\r\n  return new Promise(function (resolve, reject) {\r\n    const formattedArgs = args\r\n      .map((arg) => {\r\n        console.log(JSON.stringify(arg));\r\n        return `${JSON.stringify(arg)}`;\r\n      })\r\n      .join(\",\");\r\n    csi.evalScript(\r\n      `try{\r\n          var host = typeof $ !== 'undefined' ? $ : window;\r\n          var res = host[\"${ns}\"].${functionName}(${formattedArgs});\r\n          JSON.stringify(res);\r\n        }catch(e){\r\n          e.fileName = new File(e.fileName).fsName;\r\n          JSON.stringify(e);\r\n        }`,\r\n      (res: string) => {\r\n        try {\r\n          //@ts-ignore\r\n          if (res === \"undefined\") return resolve();\r\n          const parsed = JSON.parse(res);\r\n          if (parsed.name === \"ReferenceError\") {\r\n            console.error(\"REFERENCE ERROR\");\r\n            reject(parsed);\r\n          } else {\r\n            resolve(parsed);\r\n          }\r\n        } catch (error) {\r\n          reject(res);\r\n        }\r\n      }\r\n    );\r\n  });\r\n};\r\n\r\nexport const evalFile = (file: string) => {\r\n  return evalES(\r\n    \"typeof $ !== 'undefined' ? $.evalFile(\\\"\" +\r\n      file +\r\n      '\") : fl.runScript(FLfile.platformPathToURI(\"' +\r\n      file +\r\n      '\"));',\r\n    true\r\n  );\r\n};\r\n\r\n/**\r\n * @function listenTS End-to-end Type-Safe ExtendScript to JavaScript Events\r\n * Uses the PlugPlug ExternalObject to trigger events in CEP panels\r\n * Function comes scoped to the panel's namespace to avoid conflicts\r\n * Simply declare your event name and value in the shared/universals.ts file\r\n * Listen for events with listenTS() in your CEP panel\r\n * Trigger those events with dispatchTS() ExtendScript\r\n * @param event The event name to listen for (defined in EventTS in shared/universals.ts)\r\n * @param callback The callback function to be executed when the event is triggered\r\n * @param isLocal Whether to scope the event to the panel's namespace. Defaults to true\r\n *\r\n * @example\r\n *\r\n * // 1. Declare Type in EventTS in shared/universals.ts\r\n * export type EventTS = {\r\n *  'myCustomEvent': {\r\n *   name: string;\r\n *   value: number;\r\n * }\r\n *  // [... other events]\r\n * };\r\n *\r\n * // 2. Listen in CEP\r\n * listenTS(\"myCustomEvent\", (data) => {\r\n *   console.log(\"name is\", data.name);\r\n *   console.log(\"value is\", data.value);\r\n * });\r\n *\r\n * // 3. Dispatch in ExtendScript\r\n * dispatchTS(\"myCustomEvent\", { name: \"name\", value: 20 });\r\n *\r\n */\r\nexport const listenTS = <Key extends string & keyof EventTS>(\r\n  event: Key,\r\n  callback: (data: EventTS[Key]) => void,\r\n  isLocal = true\r\n) => {\r\n  const fullEvent = isLocal ? `${ns}.${event}` : event;\r\n  const csi = new CSInterface();\r\n  // console.log(`listening to ${fullEvent}`);\r\n  const thisCallback = (e: { data: EventTS[Key] }) => {\r\n    callback(e.data);\r\n  };\r\n\r\n  // remove any existing listeners\r\n  csi.removeEventListener(fullEvent, thisCallback, null);\r\n  // add the event listener\r\n  csi.addEventListener(fullEvent, thisCallback);\r\n};\r\n\r\n/**\r\n * @function dispatchTS Displatches an event within or between CEP panels with Type-Safety\r\n * See listenTS() in the CEP panel for more info\r\n * @param event The event name to listen for (defined in EventTS in shared/universals.ts)\r\n * @param callback The callback function to be executed when the event is triggered\r\n * @param scope The scope of the event. Defaults to \"APPLICATION\"\r\n * @param appId The application ID. Defaults to the current application\r\n * @param id The extension ID. Defaults to the current extension\r\n * @param isLocal Whether to scope the event to the panel's namespace. Defaults to true\r\n */\r\nexport const dispatchTS = <Key extends string & keyof EventTS>(\r\n  event: Key,\r\n  data: EventTS[Key],\r\n  scope = \"APPLICATION\",\r\n  appId = csi.getApplicationID() as string,\r\n  id = csi.getExtensionID() as string,\r\n  isLocal = true\r\n) => {\r\n  const fullEvent = isLocal ? `${ns}.${event}` : event;\r\n  // console.log(`dispatching ${fullEvent}`);\r\n  const csEvent = new CSEvent(fullEvent, scope, appId, id);\r\n  csEvent.data = data;\r\n  csi.dispatchEvent(csEvent);\r\n};\r\n\r\n// js utils\r\n\r\nexport const initBolt = (log = true) => {\r\n  if (window.cep) {\r\n    const extRoot = csi.getSystemPath(\"extension\");\r\n    const jsxSrc = `${extRoot}/jsx/index.js`;\r\n    const jsxBinSrc = `${extRoot}/jsx/index.jsxbin`;\r\n    if (fs.existsSync(jsxSrc)) {\r\n      if (log) console.log(jsxSrc);\r\n      evalFile(jsxSrc);\r\n    } else if (fs.existsSync(jsxBinSrc)) {\r\n      if (log) console.log(jsxBinSrc);\r\n      evalFile(jsxBinSrc);\r\n    }\r\n  }\r\n};\r\n\r\nexport const posix = (str: string) => str.replace(/\\\\/g, \"/\");\r\n\r\nexport const openLinkInBrowser = (url: string) => {\r\n  if (window.cep) {\r\n    csi.openURLInDefaultBrowser(url);\r\n  } else {\r\n    location.href = url;\r\n  }\r\n};\r\n\r\nexport const getAppBackgroundColor = () => {\r\n  const { green, blue, red } = JSON.parse(\r\n    window.__adobe_cep__.getHostEnvironment() as string\r\n  ).appSkinInfo.panelBackgroundColor.color;\r\n  return {\r\n    rgb: {\r\n      r: red,\r\n      g: green,\r\n      b: blue,\r\n    },\r\n    hex: `#${red.toString(16)}${green.toString(16)}${blue.toString(16)}`,\r\n  };\r\n};\r\n\r\nexport const subscribeBackgroundColor = (callback: (color: string) => void) => {\r\n  const getColor = () => {\r\n    const newColor = getAppBackgroundColor();\r\n    console.log(\"BG Color Updated: \", { rgb: newColor.rgb });\r\n    const { r, g, b } = newColor.rgb;\r\n    return `rgb(${r}, ${g}, ${b})`;\r\n  };\r\n  // get current color\r\n  callback(getColor());\r\n  // listen for changes\r\n  csi.addEventListener(\r\n    \"com.adobe.csxs.events.ThemeColorChanged\",\r\n    () => callback(getColor()),\r\n    {}\r\n  );\r\n};\r\n\r\n// vulcan\r\n\r\ndeclare type IVulcanMessageObject = {\r\n  event: string;\r\n  callbackID?: string;\r\n  data?: string | null;\r\n  payload?: object;\r\n};\r\n\r\nexport const vulcanSend = (id: string, msgObj: IVulcanMessageObject) => {\r\n  const msg = new VulcanMessage(VulcanMessage.TYPE_PREFIX + id, null, null);\r\n  const msgStr = JSON.stringify(msgObj);\r\n  msg.setPayload(msgStr);\r\n  vulcan.dispatchMessage(msg);\r\n};\r\n\r\nexport const vulcanListen = (id: string, callback: Function) => {\r\n  vulcan.addMessageListener(\r\n    VulcanMessage.TYPE_PREFIX + id,\r\n    (res: any) => {\r\n      var msgStr = vulcan.getPayload(res);\r\n      const msgObj = JSON.parse(msgStr);\r\n      callback(msgObj);\r\n    },\r\n    null\r\n  );\r\n};\r\n\r\nexport const isAppRunning = (targetSpecifier: string) => {\r\n  const { major, minor, micro } = csi.getCurrentApiVersion();\r\n  const version = parseFloat(`${major}.${minor}`);\r\n  if (version >= 11.2) {\r\n    return vulcan.isAppRunningEx(targetSpecifier.toUpperCase());\r\n  } else {\r\n    return vulcan.isAppRunning(targetSpecifier);\r\n  }\r\n};\r\n\r\ninterface IOpenDialogResult {\r\n  data: string[];\r\n}\r\nexport const selectFolder = (\r\n  dir: string,\r\n  msg: string,\r\n  callback: (res: string) => void\r\n) => {\r\n  const result = (\r\n    window.cep.fs.showOpenDialogEx || window.cep.fs.showOpenDialog\r\n  )(false, true, msg, dir) as IOpenDialogResult;\r\n  if (result.data?.length > 0) {\r\n    const folder = decodeURIComponent(result.data[0].replace(\"file://\", \"\"));\r\n    callback(folder);\r\n  }\r\n};\r\n\r\nexport const selectFile = (\r\n  dir: string,\r\n  msg: string,\r\n  callback: (res: string) => void\r\n) => {\r\n  const result = (\r\n    window.cep.fs.showOpenDialogEx || window.cep.fs.showOpenDialog\r\n  )(false, false, msg, dir) as IOpenDialogResult;\r\n  if (result.data?.length > 0) {\r\n    const folder = decodeURIComponent(result.data[0].replace(\"file://\", \"\"));\r\n    callback(folder);\r\n  }\r\n};\r\n","import validate from './validate.js';\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nvar byteToHex = [];\nfor (var i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\nexport function unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  //\n  // Note to future-self: No, you can't remove the `toLowerCase()` call.\n  // REF: https://github.com/uuidjs/uuid/pull/677#issuecomment-1757351351\n  return (byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]]).toLowerCase();\n}\nfunction stringify(arr, offset = 0) {\n  var uuid = unsafeStringify(arr, offset);\n  // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n  if (!validate(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n  return uuid;\n}\nexport default stringify;","// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\n\nvar getRandomValues;\nvar rnds8 = new Uint8Array(16);\nexport default function rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n  return getRandomValues(rnds8);\n}","var randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nexport default {\n  randomUUID\n};","import native from './native.js';\nimport rng from './rng.js';\nimport { unsafeStringify } from './stringify.js';\nfunction v4(options, buf, offset) {\n  if (native.randomUUID && !buf && !options) {\n    return native.randomUUID();\n  }\n  options = options || {};\n  var rnds = options.random || (options.rng || rng)();\n\n  // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80;\n\n  // Copy bytes to buffer, if provided\n  if (buf) {\n    offset = offset || 0;\n    for (var i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n    return buf;\n  }\n  return unsafeStringify(rnds);\n}\nexport default v4;","import React, { useState, useEffect, useRef, useCallback } from 'react';\r\nimport { FaVolumeUp, FaWaveSquare } from 'react-icons/fa';\r\nimport { v4 as uuidv4 } from 'uuid';\r\nimport './styles.css';\r\n// Define your types\r\ninterface AudioBinding {\r\n  path: string;\r\n  pitch: number;\r\n  track: string;\r\n  volume: number;\r\n}\r\n\r\ninterface KeyBinding {\r\n  id: string;\r\n  key: string;\r\n  binding: AudioBinding;\r\n}\r\n\r\nconsole.log('main.tsx is being executed');\r\n\r\ndeclare global {\r\n  interface Window {\r\n    electron: {\r\n      ipcRenderer: {\r\n        send: (channel: string, data: any) => void;\r\n        on: (channel: string, func: (...args: any[]) => void) => void;\r\n        removeListener: (channel: string, func: (...args: any[]) => void) => void;\r\n      };\r\n    };\r\n  }\r\n}\r\n\r\nconst Main: React.FC = () => {\r\n  console.log('Main component is rendering');\r\n\r\n  // State variables\r\n  const [configArray, setConfigArray] = useState<KeyBinding[]>([]);\r\n  const [debugLog, setDebugLog] = useState<string[]>([]);\r\n  const [isAddingBinding, setIsAddingBinding] = useState(false);\r\n  const [isListeningForKey, setIsListeningForKey] = useState(false);\r\n  const [isEditing, setIsEditing] = useState(false);\r\n  const [keyBeingEdited, setKeyBeingEdited] = useState<string | null>(null);\r\n  const [idBeingEdited, setIdBeingEdited] = useState<string | null>(null);\r\n  const [isWebSocketReady, setIsWebSocketReady] = useState(false);\r\n  const [isProfilesLoaded, setIsProfilesLoaded] = useState(false);\r\n  const [lastSelectedProfile, setLastSelectedProfile] = useState<string | null>(null);\r\n  const [loading, setLoading] = useState(false);\r\n  const path = window.electron ? require('path') : null;\r\n  const os = require('os');\r\n  const isMac = os.platform() === 'darwin';\r\n  const isWindows = os.platform() === 'win32';\r\n  \r\n  // Profile management state variables\r\n  const [profiles, setProfiles] = useState<string[]>([]);\r\n  const [currentProfile, setCurrentProfile] = useState<string | null>(null);\r\n\r\n  // Ref to hold the last selected profile\r\n  const lastProfileRef = useRef<string | null>(null);\r\n\r\n  // Refs\r\n  const isListeningForKeyRef = useRef(isListeningForKey);\r\n  const isEditingRef = useRef(isEditing);\r\n  const keyBeingEditedRef = useRef(keyBeingEdited);\r\n  const idBeingEditedRef = useRef(idBeingEdited);\r\n  const fileInputRef = useRef<HTMLInputElement>(null);\r\n  const socketRef = useRef<WebSocket | null>(null);\r\n\r\n  // Update refs when state changes\r\n  useEffect(() => {\r\n    isListeningForKeyRef.current = isListeningForKey;\r\n  }, [isListeningForKey]);\r\n\r\n  useEffect(() => {\r\n    isEditingRef.current = isEditing;\r\n  }, [isEditing]);\r\n\r\n  useEffect(() => {\r\n    keyBeingEditedRef.current = keyBeingEdited;\r\n  }, [keyBeingEdited]);\r\n\r\n  useEffect(() => {\r\n    idBeingEditedRef.current = idBeingEdited;\r\n  }, [idBeingEdited]);\r\n\r\n\r\n\r\n  // Function to append messages to the debug log\r\n  const appendToDebugLog = (message: string) => {\r\n    console.log('Debug log:', message);\r\n    setDebugLog((prevLog) => [...prevLog, message]);\r\n  };\r\n\r\n\r\n  // Function to normalize key combinations\r\n  const normalizeKeyCombination = (keyCombination: string): string => {\r\n    const keyMap: { [key: string]: string } = {\r\n      LAlt: 'Alt',\r\n      RAlt: 'Alt',\r\n      LControl: 'Ctrl',\r\n      RControl: 'Ctrl',\r\n      ControlLeft: 'Ctrl',\r\n      ControlRight: 'Ctrl',\r\n      MetaLeft: 'Cmd', // macOS Command key\r\n      MetaRight: 'Cmd', // macOS Command key\r\n      Numpad1: '1',\r\n      Numpad2: '2',\r\n      Numpad3: '3',\r\n      Numpad4: '4',\r\n      Numpad5: '5',\r\n      Numpad6: '6',\r\n      Numpad7: '7',\r\n      Numpad8: '8',\r\n      Numpad9: '9',\r\n      Numpad0: '0',\r\n      // Add more key mappings as needed\r\n    };\r\n\r\n    const priority = ['ctrl', 'shift', 'alt'];\r\n\r\n    const mappedKeys = keyCombination\r\n      .split('+')\r\n      .map((key) => keyMap[key] || key)\r\n      .map((key) => key.toLowerCase());\r\n\r\n    const sortedKeys = mappedKeys.sort((a, b) => {\r\n      const aIndex = priority.indexOf(a.charAt(0).toLowerCase() + a.slice(1));\r\n      const bIndex = priority.indexOf(b.charAt(0).toLowerCase() + b.slice(1));\r\n\r\n      if (aIndex === -1 && bIndex === -1) return a.localeCompare(b);\r\n      if (aIndex === -1) return 1;\r\n      if (bIndex === -1) return -1;\r\n      return aIndex - bIndex;\r\n    });\r\n\r\n    return sortedKeys.join('+');\r\n  };\r\n\r\n  const loadConfig = useCallback((profileName?: string) => {\r\n    const profile = profileName || currentProfile;\r\n    if (!profile) {\r\n      appendToDebugLog('No profile specified or selected. Cannot load config.');\r\n      return;\r\n    }\r\n    appendToDebugLog(`Attempting to load config for profile: ${profile}`);\r\n    \r\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n      appendToDebugLog(`WebSocket is open. Sending LOAD_CONFIG request for profile: ${profile}`);\r\n      setLoading(true); // Set loading to true before starting config load\r\n      socketRef.current.send(`LOAD_CONFIG:${profile}`);\r\n    } else {\r\n      appendToDebugLog('Cannot load config: WebSocket is not open.');\r\n    }\r\n  }, [currentProfile]);\r\n\r\n\r\n  const switchProfile = (profileName: string) => {\r\n    appendToDebugLog(`Switching profile to: ${profileName}`);\r\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n      setCurrentProfile(profileName);  // Set current profile state\r\n      lastProfileRef.current = profileName;  // Also update the last profile ref\r\n      appendToDebugLog(`Profile set: ${profileName}`);\r\n      setConfigArray([]);  // Clear bindings UI before loading the new profile's bindings\r\n  \r\n      socketRef.current.send(`SAVE_LAST_SELECTED_PROFILE:${profileName}`);\r\n      socketRef.current.send(`SWITCH_PROFILE:${profileName}`);\r\n    } else {\r\n      appendToDebugLog('WebSocket is not initialized or ready.');\r\n    }\r\n  };\r\n  \r\n  \r\n  const saveConfig = (newConfigArray: KeyBinding[]) => {\r\n    // Ensure the current profile is selected before proceeding\r\n    const activeProfile = currentProfile || lastProfileRef.current;\r\n\r\n    if (!activeProfile) {\r\n        appendToDebugLog('Cannot save config: No current profile selected.');\r\n        return;\r\n    }\r\n\r\n    if (!socketRef.current || socketRef.current.readyState !== WebSocket.OPEN) {\r\n        appendToDebugLog('WebSocket is not initialized or not ready.');\r\n        return;\r\n    }\r\n\r\n    const configObject = newConfigArray.reduce((obj, keyBinding) => {\r\n        obj[keyBinding.key] = keyBinding.binding;\r\n        return obj;\r\n    }, {} as { [key: string]: AudioBinding });\r\n\r\n    try {\r\n        appendToDebugLog(`Sending config to server for profile ${activeProfile}: ${JSON.stringify(configObject)}`);\r\n        \r\n        const message = JSON.stringify({\r\n            profile: activeProfile,  // Ensure the correct profile is included\r\n            config: configObject,\r\n        });\r\n\r\n        socketRef.current.send(`SAVE_CONFIG:${message}`);\r\n        appendToDebugLog('Config sent successfully');\r\n        setConfigArray(newConfigArray);  // Update the local state\r\n    } catch (error: unknown) {\r\n        if (error instanceof Error) {\r\n            appendToDebugLog(`Error saving config: ${error.message}`);\r\n        } else {\r\n            appendToDebugLog('Unexpected error saving config.');\r\n        }\r\n    }\r\n};\r\n\r\n  \r\n\r\n\r\n\r\n  // Function to update a binding\r\n  const updateBinding = (id: string, value: AudioBinding) => {\r\n    console.log('Updating binding with value:', value);\r\n    setConfigArray((prevConfig) => {\r\n      const index = prevConfig.findIndex((kb) => kb.id === id);\r\n      if (index === -1) {\r\n        appendToDebugLog(`Keybinding with id ${id} not found in config.`);\r\n        return prevConfig;\r\n      }\r\n\r\n      const newConfig = [...prevConfig];\r\n      newConfig[index] = { ...newConfig[index], binding: value };\r\n\r\n      appendToDebugLog(`Updating config for id: ${id} with value: ${JSON.stringify(value)}`);\r\n      saveConfig(newConfig);\r\n      return newConfig;\r\n    });\r\n  };\r\n\r\n  // Function to stop listening for key input\r\n  const stopListening = () => {\r\n    appendToDebugLog('Stopping key listener...');\r\n    setIsListeningForKey(false);\r\n    isListeningForKeyRef.current = false;\r\n    appendToDebugLog('isListeningForKey set to false');\r\n    setIsAddingBinding(false);\r\n    appendToDebugLog('isAddingBinding set to false');\r\n    if (isEditing) {\r\n      setIsEditing(false);\r\n      setKeyBeingEdited(null);\r\n      setIdBeingEdited(null);\r\n      appendToDebugLog('Editing state reset');\r\n    }\r\n  };\r\n\r\n  const editKeyBind = (id: string, newCombo: string) => {\r\n    appendToDebugLog(`Editing key binding with id ${id} to ${newCombo}`);\r\n  \r\n    // Use currentProfile or fallback to lastProfileRef.current\r\n    const activeProfile = currentProfile || lastProfileRef.current;\r\n    \r\n    if (!activeProfile) {\r\n      appendToDebugLog('Cannot edit binding: No current profile selected.');\r\n      stopListening();  // Stop listening if profile is missing\r\n      return;\r\n    }\r\n  \r\n    const normalizedNewCombo = normalizeKeyCombination(newCombo);\r\n  \r\n    setConfigArray((prevConfig) => {\r\n      if (prevConfig.some((kb) => kb.key === normalizedNewCombo && kb.id !== id)) {\r\n        appendToDebugLog(`Key combination ${normalizedNewCombo} already exists in config.`);\r\n        stopListening();  // Stop listening if the combo already exists\r\n        return prevConfig;\r\n      }\r\n  \r\n      const index = prevConfig.findIndex((kb) => kb.id === id);\r\n      if (index === -1) {\r\n        appendToDebugLog(`Keybinding with id ${id} not found in config.`);\r\n        stopListening();  // Stop listening if no binding is found\r\n        return prevConfig;\r\n      }\r\n  \r\n      const newConfig = [...prevConfig];\r\n      newConfig[index] = { ...newConfig[index], key: normalizedNewCombo };\r\n  \r\n      appendToDebugLog(`Config after editing: ${JSON.stringify(newConfig)}`);\r\n  \r\n      saveConfig(newConfig);  // Save the new configuration\r\n      stopListening();  // Stop the listener after editing\r\n      setIsEditing(false);\r\n      setKeyBeingEdited(null);\r\n      setIdBeingEdited(null);\r\n  \r\n      return newConfig;\r\n    });\r\n  };\r\n  \r\n  \r\n  \r\n\r\n  \r\n  \r\n\r\n  // Function to handle incoming key combinations\r\n  const handleCombo = (combo: string) => {\r\n    const normalizedCombo = normalizeKeyCombination(combo);\r\n    if (configArray.some((kb) => kb.key === normalizedCombo)) {\r\n      appendToDebugLog(`Processing combo: ${normalizedCombo}`);\r\n      // Add your logic here to handle the combo\r\n    } else {\r\n      appendToDebugLog(`Combo ${normalizedCombo} not found in config`);\r\n    }\r\n  };\r\n\r\n  const addNewKeyBind = useCallback(\r\n    (keyCombination: string) => {\r\n      appendToDebugLog(`Detected key combination: ${keyCombination}`);\r\n      const normalizedCombination = normalizeKeyCombination(keyCombination);\r\n      appendToDebugLog(`Normalized key combination: ${normalizedCombination}`);\r\n  \r\n      // Ensure that the correct profile is being used\r\n      const activeProfile = currentProfile || lastProfileRef.current;\r\n  \r\n      if (!activeProfile) {\r\n        appendToDebugLog('Cannot add new binding: No current profile selected.');\r\n        return;\r\n      }\r\n  \r\n      setConfigArray((prevConfig) => {\r\n        if (prevConfig.some((kb) => kb.key === normalizedCombination)) {\r\n          appendToDebugLog(`Key combination ${normalizedCombination} already exists in config.`);\r\n          stopListening();\r\n          return prevConfig;\r\n        }\r\n  \r\n        const newKeyBinding: KeyBinding = {\r\n          id: uuidv4(),\r\n          key: normalizedCombination,\r\n          binding: { volume: 0, pitch: 0, track: 'A1', path: '' },\r\n        };\r\n  \r\n        const newConfig = [...prevConfig, newKeyBinding];\r\n  \r\n        appendToDebugLog(`New config before saving: ${JSON.stringify(newConfig)}`);\r\n        saveConfig(newConfig); // Save the new config\r\n        appendToDebugLog(`Key binding ${normalizedCombination} added to config.`);\r\n  \r\n        stopListening(); // Stop listening after adding the binding\r\n        return newConfig;\r\n      });\r\n    },\r\n    [appendToDebugLog, saveConfig, stopListening, currentProfile]\r\n  );\r\n  \r\n  \r\n\r\nuseEffect(() => {\r\n  console.log('useEffect hook is running');\r\n\r\n  // Start WebSocket connection and wait for it to open\r\n  startWebSocketConnection();\r\n\r\n  return () => {\r\n    if (socketRef.current) {\r\n      socketRef.current.close(); // Clean up WebSocket on component unmount\r\n    }\r\n  };\r\n}, []);\r\n\r\nfunction startWebSocketConnection() {\r\n  if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n    appendToDebugLog('WebSocket already connected');\r\n    return;\r\n  }\r\n\r\n  appendToDebugLog('Establishing WebSocket connection...');\r\n  socketRef.current = new WebSocket('ws://localhost:7878');  // Use the correct address\r\n\r\n  socketRef.current.onopen = () => {\r\n    appendToDebugLog('Connected to server');\r\n    setIsWebSocketReady(true);  // Ensure this is set\r\n    loadProfiles();\r\n    socketRef.current?.send('GET_LAST_SELECTED_PROFILE');\r\n  };\r\n  \r\n\r\n  socketRef.current.onerror = (error) => {\r\n    appendToDebugLog(`WebSocket Error: ${error}`);\r\n  };\r\n\r\n  socketRef.current.onclose = (event) => {\r\n    appendToDebugLog(`Disconnected from server: ${event.reason}`);\r\n    setIsWebSocketReady(false);  // WebSocket is no longer ready\r\n\r\n    // Try reconnecting after 5 seconds\r\n    setTimeout(() => {\r\n      appendToDebugLog('Attempting to reconnect...');\r\n      startWebSocketConnection();\r\n    }, 5000);\r\n  };\r\n\r\n  socketRef.current.onmessage = (event) => {\r\n    const data = event.data;\r\n    appendToDebugLog(`Received message: ${data}`);\r\n\r\n    if (data.startsWith('PROFILE_SWITCHED:')) {\r\n      const profileName = data.replace('PROFILE_SWITCHED:', '');\r\n      setCurrentProfile(profileName);  // Update the state\r\n      lastProfileRef.current = profileName;  // Also update the ref for fallback\r\n      appendToDebugLog(`Profile switched to: ${profileName}`);\r\n  }\r\n  \r\n    // Handle configuration message\r\n    if (data.startsWith('CONFIG:')) {\r\n        try {\r\n            // Parse the config data\r\n            const configData = JSON.parse(data.replace('CONFIG:', ''));\r\n\r\n            appendToDebugLog(`Parsed config data: ${JSON.stringify(configData)}`);\r\n\r\n            // Ensure that `binding` is typed as `AudioBinding`\r\n            const configArray: KeyBinding[] = Object.entries(configData).map(([key, binding]) => ({\r\n                id: uuidv4(),\r\n                key: normalizeKeyCombination(key),\r\n                binding: binding as AudioBinding, // Explicitly cast `binding` to `AudioBinding`\r\n            }));\r\n\r\n            appendToDebugLog(`Converted config array: ${JSON.stringify(configArray)}`);\r\n\r\n            setConfigArray(configArray); // This should now work correctly\r\n            appendToDebugLog('Config loaded and converted to array successfully');\r\n        } catch (error) {\r\n            appendToDebugLog(`Error parsing CONFIG message: ${error}`);\r\n        }\r\n    }\r\n\r\n    // Handle profiles list message\r\n    if (data.startsWith('PROFILES:')) {\r\n        const profilesData = JSON.parse(data.replace('PROFILES:', ''));\r\n        setProfiles(profilesData);\r\n        setIsProfilesLoaded(true);  // Ensure this is set to true\r\n        appendToDebugLog('Profiles loaded');\r\n    }\r\n\r\n\r\n    // Handle last selected profile message\r\n    if (data.startsWith('LAST_SELECTED_PROFILE:')) {\r\n      const lastProfile = data.replace('LAST_SELECTED_PROFILE:', '').trim();\r\n      if (lastProfile && lastProfile !== 'None') {\r\n        setCurrentProfile(lastProfile);  // Update state\r\n        lastProfileRef.current = lastProfile;  // Also update the ref for fallback\r\n        appendToDebugLog(`Restored last selected profile: ${lastProfile}`);\r\n        socketRef.current?.send(`SWITCH_PROFILE:${lastProfile}`);  // Switch to the last selected profile\r\n      } else {\r\n        appendToDebugLog('No last selected profile found');\r\n      }\r\n    }\r\n\r\n    if (data.startsWith('COMBO:')) {\r\n      const combo = data.replace('COMBO:', '');\r\n      appendToDebugLog(`Processed combo: ${combo}`);\r\n    \r\n      // Ensure correct profile is being used\r\n      const activeProfile = currentProfile || lastProfileRef.current;\r\n    \r\n      if (!activeProfile) {\r\n        appendToDebugLog('Cannot process combo: No current profile selected.');\r\n        stopListening();\r\n        return;\r\n      }\r\n    \r\n      // If listening for a key combo, handle the key binding edit or addition\r\n      if (isListeningForKeyRef.current) {\r\n        if (isEditingRef.current && idBeingEditedRef.current) {\r\n          editKeyBind(idBeingEditedRef.current, combo);  // Use edit logic\r\n        } else {\r\n          addNewKeyBind(combo);  // Use add logic\r\n        }\r\n        stopListening();  // Stop listening after handling the combo\r\n      } else {\r\n        handleCombo(combo);  // Handle the combo if not in key listening mode\r\n      }\r\n    }\r\n    \r\n\r\n    // Handle profile creation\r\n    if (data.startsWith('PROFILE_CREATED:')) {\r\n        const profileName = data.replace('PROFILE_CREATED:', '');\r\n        setProfiles((prev) => [...prev, profileName]);\r\n        setCurrentProfile(profileName);\r\n        setConfigArray([]); // Clear the bindings for the newly created profile\r\n        appendToDebugLog(`Profile created and switched to: ${profileName}`);\r\n    }\r\n\r\n    // Handle profile deletion\r\n    if (data.startsWith('PROFILE_DELETED:')) {\r\n        const profileName = data.replace('PROFILE_DELETED:', '');\r\n        setProfiles((prev) => prev.filter((p) => p !== profileName));\r\n\r\n        // Automatically switch to another profile if available\r\n        if (currentProfile === profileName) {\r\n            const newProfile = profiles.find((p) => p !== profileName) || null;\r\n            setCurrentProfile(newProfile);\r\n\r\n            if (newProfile) {\r\n                socketRef.current?.send(`SWITCH_PROFILE:${newProfile}`);\r\n                setConfigArray([]); // Clear configArray before loading new profile's config\r\n                loadConfig(newProfile); // Pass new profile as argument\r\n            } else {\r\n                setConfigArray([]); // Clear configArray if no profiles left\r\n            }\r\n        }\r\n        appendToDebugLog(`Profile deleted: ${profileName}`);\r\n    }\r\n\r\n    // Handle errors\r\n    if (data.startsWith('ERROR:')) {\r\n        const errorMessage = data.replace('ERROR:', '');\r\n        appendToDebugLog(`Error: ${errorMessage}`);\r\n    }\r\n};\r\n\r\n  \r\n  \r\n  \r\n\r\n  \r\n  \r\n}\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n  // Function to start listening for key input\r\n  const startKeyListener = useCallback(() => {\r\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n      appendToDebugLog('WebSocket connection is open. Starting key listener...');\r\n      setIsListeningForKey(true);\r\n      isListeningForKeyRef.current = true;\r\n      appendToDebugLog('isListeningForKey set to true');\r\n    } else {\r\n      appendToDebugLog('WebSocket connection is not open. Cannot start key listener.');\r\n    }\r\n  }, [appendToDebugLog]);\r\n\r\n  // Function to initiate editing a key binding\r\n  const editBinding = (id: string, key: string) => {\r\n    if (!isListeningForKey && !isEditing) {\r\n      setIsEditing(true);\r\n      setKeyBeingEdited(key);\r\n      setIdBeingEdited(id);\r\n      appendToDebugLog(`Editing binding for key: ${key} with id: ${id}`);\r\n      startKeyListener();\r\n    }\r\n  };\r\n\r\n  // Function to initiate adding a new binding\r\n  const addBinding = () => {\r\n    if (!isListeningForKey && !isEditing) {\r\n      setIsAddingBinding(true);\r\n      appendToDebugLog('Add binding clicked. isListeningForKey set to true');\r\n      startKeyListener();\r\n    }\r\n  };\r\n\r\n  const selectAudioFile = (id: string) => {\r\n    appendToDebugLog(`Attempting to select audio file for id: ${id}`);\r\n    if (fileInputRef.current) {\r\n      appendToDebugLog('File input reference is available.');\r\n      fileInputRef.current.click();\r\n      fileInputRef.current.onchange = (event) => {\r\n        appendToDebugLog('File input change event triggered.');\r\n        const file = (event.target as HTMLInputElement).files?.[0];\r\n        if (file) {\r\n          appendToDebugLog(`File selected: ${file.name}`);\r\n          const filePath = path ? path.resolve((file as any).path || file.name) : file.name; // Cross-platform path handling\r\n          appendToDebugLog(`File path resolved to: ${filePath}`);\r\n          const keyBinding = configArray.find((kb) => kb.id === id);\r\n          if (keyBinding) {\r\n            updateBinding(id, { ...keyBinding.binding, path: filePath });\r\n            appendToDebugLog(`Selected audio file for id ${id}: ${filePath}`);\r\n          }\r\n        } else {\r\n          appendToDebugLog('No file selected.');\r\n        }\r\n      };\r\n    } else {\r\n      appendToDebugLog('File input reference is not available.');\r\n    }\r\n  };\r\n  \r\n\r\n  // Function to delete a binding\r\n  const deleteBinding = (id: string) => {\r\n    setConfigArray((prevConfig) => {\r\n      const index = prevConfig.findIndex((kb) => kb.id === id);\r\n      if (index === -1) {\r\n        appendToDebugLog(`Keybinding with id ${id} not found in config.`);\r\n        return prevConfig;\r\n      }\r\n\r\n      const newConfig = [...prevConfig];\r\n      newConfig.splice(index, 1);\r\n\r\n      appendToDebugLog(`Deleting binding with id: ${id}`);\r\n      saveConfig(newConfig);\r\n      appendToDebugLog(`Binding deleted for id ${id}`);\r\n      return newConfig;\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (currentProfile && isWebSocketReady) {\r\n      appendToDebugLog(`Loading config for profile: ${currentProfile}`);\r\n      loadConfig(currentProfile);\r\n    }\r\n  }, [currentProfile, isWebSocketReady, loadConfig]);\r\n  \r\n\r\n\r\n\r\n  const extractFileName = (filePath: string): string => {\r\n    if (!path) return filePath;  // Return raw path if `path` is not available (i.e., in a web environment)\r\n    return path.basename(filePath); // Use `path.basename` for cross-platform compatibility\r\n  };\r\n  \r\n\r\n  // Function to handle number input changes\r\n  const handleNumberInput = useCallback(\r\n    (id: string, field: 'volume' | 'pitch', value: string) => {\r\n      // Check if the value is a valid number or an allowed partial value\r\n      if (value === '' || value === '-' || value === '-.' || /^-?\\d*\\.?\\d*$/.test(value)) {\r\n        // Allow updating the input with the temporary value\r\n        const keyBinding = configArray.find((kb) => kb.id === id);\r\n        if (keyBinding) {\r\n          updateBinding(id, { ...keyBinding.binding, [field]: value });\r\n        }\r\n      }\r\n\r\n      // Check if the value is a valid number within the acceptable range\r\n      const numValue = parseFloat(value);\r\n      if (!isNaN(numValue)) {\r\n        // Apply limits only if the field is 'pitch'\r\n        if (field === 'pitch' && (numValue < -12 || numValue > 12)) {\r\n          return; // Pitch should be between -12 and 12\r\n        }\r\n        // Update binding with the valid numeric value\r\n        const keyBinding = configArray.find((kb) => kb.id === id);\r\n        if (keyBinding) {\r\n          updateBinding(id, { ...keyBinding.binding, [field]: numValue });\r\n        }\r\n      }\r\n    },\r\n    [configArray, updateBinding]\r\n  );\r\n\r\n\r\n\r\n  // Function to load profiles from the server\r\n  const loadProfiles = () => {\r\n    if (socketRef.current && socketRef.current.readyState === WebSocket.OPEN) {\r\n      try {\r\n        socketRef.current.send('GET_PROFILES');\r\n      } catch (error) {\r\n        appendToDebugLog(`Error loading profiles: ${error}`);\r\n      }\r\n    } else {\r\n      appendToDebugLog('Cannot load profiles: WebSocket is not open.');\r\n    }\r\n  };\r\n\r\n\r\n\r\n  const createProfile = () => {\r\n    const profileName = prompt('Enter new profile name:');\r\n    if (profileName) {\r\n      // Send WebSocket request to create the profile on the server\r\n      socketRef.current?.send(`CREATE_PROFILE:${profileName}`);\r\n      \r\n      // Optimistically update the profiles state to show it in the list immediately\r\n      setProfiles((prevProfiles) => [...prevProfiles, profileName]);\r\n  \r\n      // Set the new profile as the current profile\r\n      setCurrentProfile(profileName);\r\n  \r\n      // Clear the bindings for the newly created profile\r\n      setConfigArray([]);\r\n      appendToDebugLog(`New profile created and switched to: ${profileName}`);\r\n  \r\n      // Save an empty or default configuration for the newly created profile\r\n      const defaultConfig = {};\r\n      socketRef.current?.send(`SAVE_CONFIG:${JSON.stringify({\r\n        profile: profileName,\r\n        config: defaultConfig,\r\n      })}`);\r\n      appendToDebugLog(`New profile configuration saved for ${profileName}`);\r\n    }\r\n  };\r\n  \r\n  \r\n\r\n  const deleteProfile = () => {\r\n    if (currentProfile && confirm(`Are you sure you want to delete profile '${currentProfile}'?`)) {\r\n      // Send a message to the server to delete the profile and its configuration\r\n      socketRef.current?.send(`DELETE_PROFILE:${currentProfile}`);\r\n  \r\n      // Optimistically remove the profile from the state\r\n      setProfiles((prevProfiles) => prevProfiles.filter((p) => p !== currentProfile));\r\n      \r\n      const newProfile = profiles.find((p) => p !== currentProfile) || null;\r\n  \r\n      // Switch to a new profile if one exists, otherwise clear the UI\r\n      if (newProfile) {\r\n        setCurrentProfile(newProfile);\r\n        setConfigArray([]); // Clear the current bindings UI\r\n        socketRef.current?.send(`SWITCH_PROFILE:${newProfile}`);\r\n        loadConfig(newProfile); // Pass the newProfile as an argument\r\n      } else {\r\n        // If no profiles are left, clear everything\r\n        setCurrentProfile(null);\r\n        setConfigArray([]); // Clear config array if no profiles are left\r\n      }\r\n  \r\n      appendToDebugLog(`Profile '${currentProfile}' deleted successfully`);\r\n    }\r\n  };\r\n  \r\n\r\n\r\n// Ensure that WebSocket is ready and profiles are loaded before rendering\r\nif (!isWebSocketReady || !isProfilesLoaded) {\r\n  return (\r\n    <div\r\n      style={{\r\n        fontFamily: 'Roboto, sans-serif',\r\n        backgroundColor: '#1e2057',\r\n        color: '#ffffff',\r\n        padding: '10px',\r\n        textAlign: 'center',\r\n      }}\r\n    >\r\n      <div>Loading profiles, please wait...</div>\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n\r\n  // If no current profile is selected, prompt the user to create one\r\n  if (!currentProfile) {\r\n    return (\r\n      <div\r\n        style={{\r\n          fontFamily: 'Roboto, sans-serif',\r\n          backgroundColor: '#1e2057',\r\n          color: '#ffffff',\r\n          padding: '10px',\r\n        }}\r\n      >\r\n        <div\r\n          style={{\r\n            marginBottom: '15px',\r\n            padding: '10px',\r\n            backgroundColor: '#2e2f77',\r\n            borderRadius: '5px',\r\n          }}\r\n        >\r\n          <p>No profiles available. Please create a new profile.</p>\r\n          <button\r\n            onClick={createProfile}\r\n            style={{\r\n              padding: '10px',\r\n              backgroundColor: '#4e52ff',\r\n              color: '#ffffff',\r\n              borderRadius: '2px',\r\n              border: 'none',\r\n              cursor: 'pointer',\r\n            }}\r\n          >\r\n            Create Profile\r\n          </button>\r\n        </div>\r\n      </div>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <div className=\"main-container\">\r\n      {/* Loading Spinner or Profiles */}\r\n      {!isWebSocketReady || !isProfilesLoaded ? (\r\n        <div className=\"spinner-container\">\r\n          <div className=\"spinner-message\">Loading profiles, please wait...</div>\r\n          <div className=\"spinner\">🔄</div> {/* Spinner Animation */}\r\n        </div>\r\n      ) : (\r\n        <>\r\n          {/* If no current profile is selected, prompt the user to create one */}\r\n          {!currentProfile ? (\r\n            <div className=\"profile-section\">\r\n              <div>\r\n                <p>No profiles available. Please create a new profile.</p>\r\n                <button className=\"button\" onClick={createProfile}>\r\n                  Create Profile\r\n                </button>\r\n              </div>\r\n            </div>\r\n          ) : (\r\n            <>\r\n              {/* Profile Management Section */}\r\n              <div className=\"profile-section\">\r\n                <div className=\"profile-select-wrapper\">\r\n                  <div>\r\n                    <label htmlFor=\"profile-select\" style={{ marginRight: '10px' }}>\r\n                      Profile:\r\n                    </label>\r\n                    <select\r\n                      id=\"profile-select\"\r\n                      value={currentProfile}\r\n                      onChange={(e) => switchProfile(e.target.value)}\r\n                      className=\"track-select\"\r\n                    >\r\n                      {profiles.map((profile) => (\r\n                        <option key={profile} value={profile}>\r\n                          {profile}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                    <button\r\n                      className=\"button\"\r\n                      onClick={createProfile}\r\n                    >\r\n                      New Profile\r\n                    </button>\r\n                    <button\r\n                      className=\"button\"\r\n                      style={{ backgroundColor: '#ff5b3b' }}\r\n                      onClick={deleteProfile}\r\n                    >\r\n                      Delete Profile\r\n                    </button>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n\r\n              {/* Add Binding Section */}\r\n              <div className=\"add-binding-container\">\r\n                <input\r\n                  type=\"text\"\r\n                  readOnly\r\n                  value={\r\n                    isListeningForKey\r\n                      ? isEditing\r\n                        ? `Editing ${keyBeingEdited || ''}: Press new key...`\r\n                        : 'Press a key combination...'\r\n                      : 'Click Add Binding to start'\r\n                  }\r\n                  className=\"key-binding-input\"\r\n                />\r\n                <button\r\n                  className=\"button\"\r\n                  onClick={addBinding}\r\n                  disabled={isListeningForKey || isEditing}\r\n                >\r\n                  {isListeningForKey ? 'Listening...' : 'Add Binding'}\r\n                </button>\r\n              </div>\r\n\r\n              {/* Hidden file input for audio selection */}\r\n              <input\r\n                type=\"file\"\r\n                ref={fileInputRef}\r\n                className=\"file-input\"\r\n                accept=\"audio/*\"\r\n              />\r\n\r\n              {/* Keybind Rows */}\r\n              <div>\r\n                {configArray.map((keyBinding) => (\r\n                  <div key={keyBinding.id} className=\"binding-card\">\r\n                    <button\r\n                      className=\"delete-button\"\r\n                      onClick={() => deleteBinding(keyBinding.id)}\r\n                    >\r\n                      ✖\r\n                    </button>\r\n                    <input\r\n                      type=\"text\"\r\n                      readOnly\r\n                      value={keyBinding.key}\r\n                      className=\"key-binding-input\"\r\n                    />\r\n                    <button\r\n                      className=\"button\"\r\n                      onClick={() => editBinding(keyBinding.id, keyBinding.key)}\r\n                      disabled={isListeningForKey || isEditing}\r\n                    >\r\n                      Edit\r\n                    </button>\r\n                    <select\r\n                      value={keyBinding.binding.track}\r\n                      onChange={(e) =>\r\n                        updateBinding(keyBinding.id, { ...keyBinding.binding, track: e.target.value })\r\n                      }\r\n                      className=\"track-select\"\r\n                    >\r\n                      {Array.from({ length: 15 }, (_, i) => (\r\n                        <option key={i} value={`A${i + 1}`}>\r\n                          A{i + 1}\r\n                        </option>\r\n                      ))}\r\n                    </select>\r\n                    <input\r\n                      type=\"text\"\r\n                      readOnly\r\n                      value={extractFileName(keyBinding.binding.path)}\r\n                      className=\"key-binding-input\"\r\n                    />\r\n                    <button\r\n                      className=\"button\"\r\n                      onClick={() => selectAudioFile(keyBinding.id)}\r\n                    >\r\n                      Audio...\r\n                    </button>\r\n\r\n                    {/* Volume Section */}\r\n                    <div className=\"input-wrapper\">\r\n                      <span className=\"volume-icon\">🔊</span> {/* Volume icon */}\r\n                      <input\r\n                        type=\"number\"\r\n                        value={keyBinding.binding.volume}\r\n                        onChange={(e) => handleNumberInput(keyBinding.id, 'volume', e.target.value)}\r\n                        className=\"number-input\"\r\n                      />\r\n                      <span className=\"input-label\">dB</span>\r\n                    </div>\r\n\r\n                    {/* Pitch Section */}\r\n                    <div className=\"input-wrapper\">\r\n                      <span className=\"wave-square-icon\">🌀</span> {/* WaveSquare icon */}\r\n                      <input\r\n                        type=\"number\"\r\n                        value={keyBinding.binding.pitch}\r\n                        onChange={(e) => handleNumberInput(keyBinding.id, 'pitch', e.target.value)}\r\n                        min=\"-12\"\r\n                        max=\"12\"\r\n                        step=\"1\"\r\n                        className=\"number-input\"\r\n                      />\r\n                      <span className=\"input-label\">st</span>\r\n                    </div>\r\n                  </div>\r\n                ))}\r\n              </div>\r\n            </>\r\n          )}\r\n        </>\r\n      )}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Main;","import React from \"react\";\r\nimport ReactDOM from \"react-dom/client\";\r\nimport { initBolt } from \"../lib/utils/bolt\";\r\n\r\n\r\nimport Main from \"./main\";\r\n\r\ninitBolt();\r\n\r\nReactDOM.createRoot(document.getElementById(\"root\") as HTMLElement).render(\r\n  <React.StrictMode>\r\n    <Main />\r\n  </React.StrictMode>\r\n);"],"names":["MenuItemStatus","menuItemLabel","enabled","checked","ContextMenuItemStatus","menuItemID","CSInterface","urlName","callback","xhr","err","pathName","OSVersion","pathType","path","script","result","appId","hostCapabilities","event","type","listener","obj","extensionId","params","extensionIds","extensionIdsStr","extensionsStr","extensions","networkPre","resourceBundle","resElms","n","resEl","resKey","key","resValue","attrKey","userAgent","winVersion","winBit","url","handler","apiVersion","menu","ret","itemStatus","width","height","keyEventsInterest","title","src","args","m","i","config","version","ns","fs","csi","evalES","isGlobal","resolve","reject","fullString","res","evalFile","file","initBolt","log","extRoot","jsxSrc","jsxBinSrc","byteToHex","unsafeStringify","arr","offset","getRandomValues","rnds8","rng","randomUUID","native","v4","options","buf","rnds","Main","configArray","setConfigArray","useState","debugLog","setDebugLog","isAddingBinding","setIsAddingBinding","isListeningForKey","setIsListeningForKey","isEditing","setIsEditing","keyBeingEdited","setKeyBeingEdited","idBeingEdited","setIdBeingEdited","isWebSocketReady","setIsWebSocketReady","isProfilesLoaded","setIsProfilesLoaded","loading","setLoading","os","profiles","setProfiles","currentProfile","setCurrentProfile","lastProfileRef","useRef","isListeningForKeyRef","isEditingRef","keyBeingEditedRef","idBeingEditedRef","fileInputRef","socketRef","useEffect","appendToDebugLog","message","prevLog","normalizeKeyCombination","keyCombination","keyMap","priority","a","b","aIndex","bIndex","loadConfig","useCallback","profileName","profile","switchProfile","saveConfig","newConfigArray","activeProfile","configObject","keyBinding","error","updateBinding","id","value","prevConfig","index","kb","newConfig","stopListening","editKeyBind","newCombo","normalizedNewCombo","handleCombo","combo","normalizedCombo","addNewKeyBind","normalizedCombination","newKeyBinding","uuidv4","startWebSocketConnection","loadProfiles","_a","data","configData","binding","profilesData","lastProfile","prev","p","newProfile","_b","errorMessage","startKeyListener","editBinding","addBinding","selectAudioFile","filePath","deleteBinding","extractFileName","handleNumberInput","field","numValue","createProfile","prevProfiles","defaultConfig","deleteProfile","jsx","jsxs","Fragment","e","_","ReactDOM","React"],"mappings":"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","x_google_ignoreList":[6,7,8,9]}