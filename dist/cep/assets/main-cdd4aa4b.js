"use strict";var exports = typeof exports === "undefined" ? {} : exports;;const a=typeof cep_node !== 'undefined'?cep_node.require(cep_node.global["__dir"+"name"] + "/assets/client-b54d271c.js"):require("../assets/client-b54d271c.js");function L(e,n,r){this.menuItemLabel=e,this.enabled=n,this.checked=r}function B(e,n,r){this.menuItemID=e,this.enabled=n,this.checked=r}function s(){}s.THEME_COLOR_CHANGED_EVENT="com.adobe.csxs.events.ThemeColorChanged";s.prototype.hostEnvironment=window.__adobe_cep__?JSON.parse(window.__adobe_cep__.getHostEnvironment()):null;s.prototype.getHostEnvironment=function(){return this.hostEnvironment=JSON.parse(window.__adobe_cep__.getHostEnvironment()),this.hostEnvironment};s.prototype.loadBinAsync=function(e,n){try{var r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("GET",e,!0),r.onerror=function(){return console.log("Unable to load snapshot from given URL"),!1},r.send(),r.onload=()=>{window.__adobe_cep__.loadSnapshot(r.response),typeof n=="function"?n():typeof n<"u"&&console.log("Provided callback is not a function")}}catch(c){return console.log(c),!1}return!0};s.prototype.loadBinSync=function(e){try{var n=this.getOSInformation();if(e.startsWith("file://"))return n.indexOf("Windows")>=0?e=e.replace("file:///",""):n.indexOf("Mac")>=0&&(e=e.replace("file://","")),window.__adobe_cep__.loadSnapshot(e),!0}catch(r){return console.log(r),!1}return!1};s.prototype.closeExtension=function(){window.__adobe_cep__.closeExtension()};s.prototype.getSystemPath=function(e){var n=decodeURI(window.__adobe_cep__.getSystemPath(e)),r=this.getOSInformation();return r.indexOf("Windows")>=0?n=n.replace("file:///",""):r.indexOf("Mac")>=0&&(n=n.replace("file://","")),n};s.prototype.evalScript=function(e,n){n==null&&(n=function(r){}),window.__adobe_cep__.evalScript(e,n)};s.prototype.getApplicationID=function(){var e=this.hostEnvironment.appId;return e};s.prototype.getHostCapabilities=function(){var e=JSON.parse(window.__adobe_cep__.getHostCapabilities());return e};s.prototype.dispatchEvent=function(e){typeof e.data=="object"&&(e.data=JSON.stringify(e.data)),window.__adobe_cep__.dispatchEvent(e)};s.prototype.addEventListener=function(e,n,r){window.__adobe_cep__.addEventListener(e,n,r)};s.prototype.removeEventListener=function(e,n,r){window.__adobe_cep__.removeEventListener(e,n,r)};s.prototype.requestOpenExtension=function(e,n){window.__adobe_cep__.requestOpenExtension(e,n)};s.prototype.getExtensions=function(e){var n=JSON.stringify(e),r=window.__adobe_cep__.getExtensions(n),c=JSON.parse(r);return c};s.prototype.getNetworkPreferences=function(){var e=window.__adobe_cep__.getNetworkPreferences(),n=JSON.parse(e);return n};s.prototype.initResourceBundle=function(){for(var e=JSON.parse(window.__adobe_cep__.initResourceBundle()),n=document.querySelectorAll("[data-locale]"),r=0;r<n.length;r++){var c=n[r],w=c.getAttribute("data-locale");if(w){for(var g in e)if(g.indexOf(w)===0){var l=e[g];if(g.length==w.length)c.innerHTML=l;else if(g.charAt(w.length)=="."){var m=g.substring(w.length+1);c[m]=l}}}}return e};s.prototype.dumpInstallationInfo=function(){return window.__adobe_cep__.dumpInstallationInfo()};s.prototype.getOSInformation=function(){var e=navigator.userAgent;if(navigator.platform=="Win32"||navigator.platform=="Windows"){var n="Windows",r="";return e.indexOf("Windows")>-1&&(e.indexOf("Windows NT 5.0")>-1?n="Windows 2000":e.indexOf("Windows NT 5.1")>-1?n="Windows XP":e.indexOf("Windows NT 5.2")>-1?n="Windows Server 2003":e.indexOf("Windows NT 6.0")>-1?n="Windows Vista":e.indexOf("Windows NT 6.1")>-1?n="Windows 7":e.indexOf("Windows NT 6.2")>-1?n="Windows 8":e.indexOf("Windows NT 6.3")>-1?n="Windows 8.1":e.indexOf("Windows NT 10")>-1&&(n="Windows 10"),e.indexOf("WOW64")>-1||e.indexOf("Win64")>-1?r=" 64-bit":r=" 32-bit"),n+r}else if(navigator.platform=="MacIntel"||navigator.platform=="Macintosh"){var c="Mac OS X";return e.indexOf("Mac OS X")>-1&&(c=e.substring(e.indexOf("Mac OS X"),e.indexOf(")")),c=c.replace(/_/g,".")),c}return"Unknown Operation System"};s.prototype.openURLInDefaultBrowser=function(e){return cep.util.openURLInDefaultBrowser(e)};s.prototype.getExtensionID=function(){return window.__adobe_cep__.getExtensionId()};s.prototype.getScaleFactor=function(){return window.__adobe_cep__.getScaleFactor()};navigator.appVersion.toLowerCase().indexOf("windows")>=0&&(s.prototype.getMonitorScaleFactor=function(){return window.__adobe_cep__.getMonitorScaleFactor()});s.prototype.setScaleFactorChangedHandler=function(e){window.__adobe_cep__.setScaleFactorChangedHandler(e)};s.prototype.getCurrentApiVersion=function(){var e=JSON.parse(window.__adobe_cep__.getCurrentApiVersion());return e};s.prototype.setPanelFlyoutMenu=function(e){typeof e=="string"&&window.__adobe_cep__.invokeSync("setPanelFlyoutMenu",e)};s.prototype.updatePanelMenuItem=function(e,n,r){var c=!1;if(this.getHostCapabilities().EXTENDED_PANEL_MENU){var w=new L(e,n,r);c=window.__adobe_cep__.invokeSync("updatePanelMenuItem",JSON.stringify(w))}return c};s.prototype.setContextMenu=function(e,n){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenu",e,n)};s.prototype.setContextMenuByJSON=function(e,n){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenuByJSON",e,n)};s.prototype.updateContextMenuItem=function(e,n,r){var c=new B(e,n,r);ret=window.__adobe_cep__.invokeSync("updateContextMenuItem",JSON.stringify(c))};s.prototype.isWindowVisible=function(){return window.__adobe_cep__.invokeSync("isWindowVisible","")};s.prototype.resizeContent=function(e,n){window.__adobe_cep__.resizeContent(e,n)};s.prototype.registerInvalidCertificateCallback=function(e){return window.__adobe_cep__.registerInvalidCertificateCallback(e)};s.prototype.registerKeyEventsInterest=function(e){return window.__adobe_cep__.registerKeyEventsInterest(e)};s.prototype.setWindowTitle=function(e){window.__adobe_cep__.invokeSync("setWindowTitle",e)};s.prototype.getWindowTitle=function(){return window.__adobe_cep__.invokeSync("getWindowTitle","")};String.format=function(e){if(arguments.length===0)return null;var n=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(r,c){return n[c]})};const P="0.0.1",D={version:P,id:"com.AudioImporterV2.cep",displayName:"Audio Importer V2",symlink:"local",port:3e3,servePort:5e3,startingDebugPort:8850,extensionManifestVersion:6,requiredRuntimeVersion:9,hosts:[{name:"PPRO",version:"[0.0,99.9]"}],type:"Panel",iconDarkNormal:"./src/assets/light-icon.png",iconNormal:"./src/assets/dark-icon.png",iconDarkNormalRollOver:"./src/assets/light-icon.png",iconNormalRollOver:"./src/assets/dark-icon.png",parameters:["--v=0","--enable-nodejs","--mixed-context"],width:500,height:550,panels:[{mainPath:"./main/index.html",name:"main",panelDisplayName:"Audio Importer V2",autoVisible:!0,width:690,height:650},{mainPath:"./settings/index.html",name:"settings",autoVisible:!1,type:"Custom",startOnEvents:["com.adobe.csxs.events.ApplicationInitialized","applicationActive"],height:1}],build:{jsxBin:"off",sourceMap:!0},zxp:{country:"US",province:"CA",org:"MyCompany",password:"mypassword",tsa:"http://timestamp.digicert.com/",sourceMap:!1,jsxBin:"off"},installModules:[],copyAssets:["./target/release/audio_importer.exe","./js","./jsx"],copyZipAssets:[]},T=D.id;typeof window.cep<"u"&&require("crypto");typeof window.cep<"u"&&require("assert");typeof window.cep<"u"&&require("buffer");typeof window.cep<"u"&&require("child_process");typeof window.cep<"u"&&require("cluster");typeof window.cep<"u"&&require("dgram");typeof window.cep<"u"&&require("dns");typeof window.cep<"u"&&require("domain");typeof window.cep<"u"&&require("events");const N=typeof window.cep<"u"?require("fs"):{};typeof window.cep<"u"&&require("http");typeof window.cep<"u"&&require("https");typeof window.cep<"u"&&require("net");typeof window.cep<"u"&&require("os");typeof window.cep<"u"&&require("path");typeof window.cep<"u"&&require("punycode");typeof window.cep<"u"&&require("querystring");typeof window.cep<"u"&&require("readline");typeof window.cep<"u"&&require("stream");typeof window.cep<"u"&&require("string_decoder");typeof window.cep<"u"&&require("timers");typeof window.cep<"u"&&require("tls");typeof window.cep<"u"&&require("tty");typeof window.cep<"u"&&require("url");typeof window.cep<"u"&&require("util");typeof window.cep<"u"&&require("v8");typeof window.cep<"u"&&require("vm");typeof window.cep<"u"&&require("zlib");const R=new s,J=(e,n=!1)=>new Promise(function(r,c){const g=(n?"":`var host = typeof $ !== 'undefined' ? $ : window; host["${T}"].`)+e;R.evalScript("try{"+g+"}catch(e){alert(e);}",l=>{r(l)})}),I=e=>J(`typeof $ !== 'undefined' ? $.evalFile("`+e+'") : fl.runScript(FLfile.platformPathToURI("'+e+'"));',!0),U=(e=!0)=>{if(window.cep){const n=R.getSystemPath("extension"),r=`${n}/jsx/index.js`,c=`${n}/jsx/index.jsxbin`;N.existsSync(r)?(e&&console.log(r),I(r)):N.existsSync(c)&&(e&&console.log(c),I(c))}};console.log("main.tsx is being executed");const H=()=>{console.log("Main component is rendering");const[e,n]=a.reactExports.useState({}),[r,c]=a.reactExports.useState([]),[w,g]=a.reactExports.useState(!1),[l,m]=a.reactExports.useState(!1),S=a.reactExports.useRef(l),b=a.reactExports.useRef(null),p=a.reactExports.useRef(null);a.reactExports.useEffect(()=>(console.log("useEffect hook is running"),O(),()=>{p.current&&p.current.close()}),[]),a.reactExports.useEffect(()=>{p.current&&(p.current.onmessage=t=>{const o=t.data;if(i(`Received message: ${o}`),typeof o=="string"){if(o.startsWith("CONFIG:")){const d=JSON.parse(o.replace("CONFIG:",""));n(d),i("Config loaded successfully from server")}else if(o.startsWith("COMBO:")){const d=o.replace("COMBO:","");i(`Processed combo: ${d}`),A(d)}}})},[]);const O=a.reactExports.useCallback(()=>{if(p.current&&p.current.readyState===WebSocket.OPEN){i("WebSocket already connected");return}i("Establishing WebSocket connection..."),p.current=new WebSocket("ws://localhost:7878"),p.current.onopen=()=>{i("Connected to Rust server"),W()},p.current.onmessage=t=>{const o=t.data;if(i(`Received message: ${o}`),typeof o=="string"&&o.startsWith("CONFIG:")){const d=JSON.parse(o.replace("CONFIG:",""));n(d),i("Config loaded successfully from server")}},p.current.onerror=t=>{i(`WebSocket Error: ${t instanceof ErrorEvent?t.message:"Unknown error"}`)},p.current.onclose=t=>{i(`Disconnected from Rust server: ${t.reason}`),setTimeout(O,5e3)}},[]),i=t=>{console.log("Debug log:",t),c(o=>[...o,t])},W=()=>{var t;console.log("Loading config");try{(t=p.current)==null||t.send("LOAD_CONFIG")}catch(o){o instanceof Error?i(`Error loading config: ${o.message}`):i("Unexpected error loading config."),console.error("Error loading config:",o)}},h=t=>{var o;try{i(`Sending config to server: ${JSON.stringify(t)}`),(o=p.current)==null||o.send(`SAVE_CONFIG:${JSON.stringify(t)}`),i("Config sent successfully"),n(t)}catch(d){d instanceof Error?i(`Error saving config: ${d.message}`):i("Unexpected error saving config.")}},A=t=>{const o=t.split("+").sort().join("+");e[o]?i(`Processing combo: ${o}`):i(`Combo ${o} not found in config`)},v=()=>{i("Stopping key listener..."),m(!1),S.current=!1,i("isListeningForKey set to false"),g(!1),i("isAddingBinding set to false")},E=a.reactExports.useCallback(t=>{i(`Detected key combination: ${t}`);const o=t.split("+").sort().join("+");i(`Sorted key combination: ${o}`),n(d=>{if(i(`Current config: ${JSON.stringify(d)}`),d[o])return i(`Key combination ${o} already exists in config.`),v(),d;{const f={...d,[o]:{volume:0,pitch:0,track:"A1",path:""}};return i(`New config before saving: ${JSON.stringify(f)}`),h(f),i(`Key binding ${o} added to config.`),v(),p.current&&(p.current.onmessage=u=>{const _=u.data;if(i(`Received message: ${_}`),typeof _=="string"&&_.startsWith("CONFIG:")){const x=JSON.parse(_.replace("CONFIG:",""));n(x),i("Config loaded successfully from server")}}),f}})},[v]),j=a.reactExports.useCallback(()=>{p.current&&p.current.readyState===WebSocket.OPEN?(i("WebSocket connection is open. Starting key listener..."),m(!0),S.current=!0,i("isListeningForKey set to true"),p.current.onmessage=t=>{const o=t.data;if(i(`Received message: ${o}`),typeof o=="string"&&o.startsWith("COMBO:")){const d=o.replace("COMBO:","");i(`Processed combo: ${d}`),E(d)}}):i("WebSocket connection is not open. Cannot start key listener.")},[E]),M=()=>{l||(g(!0),i("Add binding clicked. isListeningForKey set to true"),j())},k=t=>{i(`Attempting to select audio file for key: ${t}`),b.current?(i("File input reference is available."),b.current.click(),b.current.onchange=o=>{var f;i("File input change event triggered.");const d=(f=o.target.files)==null?void 0:f[0];if(d){i(`File selected: ${d.name}`);const u=d.path||d.name;i(`File path resolved to: ${u}`),y(t,{...e[t],path:u}),i(`Selected audio file for ${t}: ${u}`)}else i("No file selected.")}):i("File input reference is not available.")},y=(t,o)=>{n(d=>{const f={...d,[t]:o};return i(`Updating config for key: ${t} with value: ${JSON.stringify(o)}`),h(f),i(`Binding updated for ${t}`),f})},$=t=>{n(o=>{const{[t]:d,...f}=o;return i(`Deleting binding for key: ${t}`),h(f),i(`Binding deleted for ${t}`),f})},q=t=>{const o={LAlt:"Alt",RAlt:"Alt",LControl:"Ctrl",RControl:"Ctrl",ControlLeft:"Ctrl",ControlRight:"Ctrl",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",Numpad0:"0"},d=["Ctrl","Shift","Alt"];return t.split("+").map(u=>o[u]||u).sort((u,_)=>{const x=d.indexOf(u),C=d.indexOf(_);return x===-1&&C===-1?u.localeCompare(_):x===-1?1:C===-1?-1:x-C}).join("+")},F=t=>{var o;return((o=t.split("\\").pop())==null?void 0:o.split("/").pop())||""};return a.jsxs("div",{style:{fontFamily:"Roboto, sans-serif",backgroundColor:"#1e2057",color:"#ffffff",padding:"10px"},children:[a.jsx("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#2e2f77",borderRadius:"5px"},children:a.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[a.jsx("input",{type:"text",readOnly:!0,value:l?"Press a key combination...":"Click Add Binding to start",style:{width:"250px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px"}}),a.jsx("button",{onClick:M,disabled:l,style:{width:"150px",padding:"6px",backgroundColor:l?"#2e3177":"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",cursor:l?"not-allowed":"pointer"},children:l?"Listening...":"Add Binding"})]})}),a.jsx("input",{type:"file",ref:b,style:{display:"none"},accept:"audio/*"}),a.jsx("div",{children:Object.keys(e).map(t=>a.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",backgroundColor:"#2e2f77",padding:"10px",borderRadius:"5px"},children:[a.jsx("button",{onClick:()=>$(t),style:{width:"30px",height:"30px",padding:"6px",backgroundColor:"transparent",color:"#ff5b3b",borderRadius:"50%",border:"none",cursor:"pointer",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"10px"},children:"✖"}),a.jsx("input",{type:"text",readOnly:!0,value:q(t),style:{width:"70px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px",textAlign:"center"}}),a.jsx("button",{onClick:()=>console.log(`Edit binding for ${t}`),style:{width:"50px",padding:"6px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",marginRight:"10px"},children:"Edit"}),a.jsx("select",{value:e[t].track,onChange:o=>y(t,{...e[t],track:o.target.value}),style:{width:"70px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"},children:Array.from({length:15},(o,d)=>a.jsxs("option",{value:`A${d+1}`,children:["A",d+1]},d))}),a.jsx("input",{type:"text",readOnly:!0,value:F(e[t].path),style:{width:"120px",padding:"7px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"}}),a.jsx("button",{onClick:()=>k(t),style:{width:"120px",padding:"6px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",marginRight:"10px"},children:"Select audio..."}),a.jsx("input",{type:"number",value:e[t].volume,onChange:o=>y(t,{...e[t],volume:parseInt(o.target.value)}),style:{width:"30px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"}}),a.jsx("input",{type:"number",value:e[t].pitch,onChange:o=>y(t,{...e[t],pitch:parseInt(o.target.value)}),style:{width:"30px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"}}),a.jsx("label",{style:{display:"flex",alignItems:"center",marginLeft:"5px",justifyContent:"center"},children:a.jsx("input",{type:"checkbox",checked:e[t].importInMiddle||!1,onChange:o=>y(t,{...e[t],importInMiddle:o.target.checked}),style:{marginRight:"0px"}})})]},t))})]})};console.log("Exporting Main component");U();a.client.createRoot(document.getElementById("root")).render(a.jsx(a.React.StrictMode,{children:a.jsx(H,{})}));
//# sourceMappingURL=main-cdd4aa4b.js.map
