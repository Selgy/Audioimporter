"use strict";var exports = typeof exports === "undefined" ? {} : exports;;const o=typeof cep_node !== 'undefined'?cep_node.require(cep_node.global["__dir"+"name"] + "/assets/client-97072a1f.js"):require("../assets/client-97072a1f.js");function ve(e,t,i){this.menuItemLabel=e,this.enabled=t,this.checked=i}function Ee(e,t,i){this.menuItemID=e,this.enabled=t,this.checked=i}function p(){}p.THEME_COLOR_CHANGED_EVENT="com.adobe.csxs.events.ThemeColorChanged";p.prototype.hostEnvironment=window.__adobe_cep__?JSON.parse(window.__adobe_cep__.getHostEnvironment()):null;p.prototype.getHostEnvironment=function(){return this.hostEnvironment=JSON.parse(window.__adobe_cep__.getHostEnvironment()),this.hostEnvironment};p.prototype.loadBinAsync=function(e,t){try{var i=new XMLHttpRequest;i.responseType="arraybuffer",i.open("GET",e,!0),i.onerror=function(){return console.log("Unable to load snapshot from given URL"),!1},i.send(),i.onload=()=>{window.__adobe_cep__.loadSnapshot(i.response),typeof t=="function"?t():typeof t<"u"&&console.log("Provided callback is not a function")}}catch(c){return console.log(c),!1}return!0};p.prototype.loadBinSync=function(e){try{var t=this.getOSInformation();if(e.startsWith("file://"))return t.indexOf("Windows")>=0?e=e.replace("file:///",""):t.indexOf("Mac")>=0&&(e=e.replace("file://","")),window.__adobe_cep__.loadSnapshot(e),!0}catch(i){return console.log(i),!1}return!1};p.prototype.closeExtension=function(){window.__adobe_cep__.closeExtension()};p.prototype.getSystemPath=function(e){var t=decodeURI(window.__adobe_cep__.getSystemPath(e)),i=this.getOSInformation();return i.indexOf("Windows")>=0?t=t.replace("file:///",""):i.indexOf("Mac")>=0&&(t=t.replace("file://","")),t};p.prototype.evalScript=function(e,t){t==null&&(t=function(i){}),window.__adobe_cep__.evalScript(e,t)};p.prototype.getApplicationID=function(){var e=this.hostEnvironment.appId;return e};p.prototype.getHostCapabilities=function(){var e=JSON.parse(window.__adobe_cep__.getHostCapabilities());return e};p.prototype.dispatchEvent=function(e){typeof e.data=="object"&&(e.data=JSON.stringify(e.data)),window.__adobe_cep__.dispatchEvent(e)};p.prototype.addEventListener=function(e,t,i){window.__adobe_cep__.addEventListener(e,t,i)};p.prototype.removeEventListener=function(e,t,i){window.__adobe_cep__.removeEventListener(e,t,i)};p.prototype.requestOpenExtension=function(e,t){window.__adobe_cep__.requestOpenExtension(e,t)};p.prototype.getExtensions=function(e){var t=JSON.stringify(e),i=window.__adobe_cep__.getExtensions(t),c=JSON.parse(i);return c};p.prototype.getNetworkPreferences=function(){var e=window.__adobe_cep__.getNetworkPreferences(),t=JSON.parse(e);return t};p.prototype.initResourceBundle=function(){for(var e=JSON.parse(window.__adobe_cep__.initResourceBundle()),t=document.querySelectorAll("[data-locale]"),i=0;i<t.length;i++){var c=t[i],g=c.getAttribute("data-locale");if(g){for(var w in e)if(w.indexOf(g)===0){var y=e[w];if(w.length==g.length)c.innerHTML=y;else if(w.charAt(g.length)=="."){var v=w.substring(g.length+1);c[v]=y}}}}return e};p.prototype.dumpInstallationInfo=function(){return window.__adobe_cep__.dumpInstallationInfo()};p.prototype.getOSInformation=function(){var e=navigator.userAgent;if(navigator.platform=="Win32"||navigator.platform=="Windows"){var t="Windows",i="";return e.indexOf("Windows")>-1&&(e.indexOf("Windows NT 5.0")>-1?t="Windows 2000":e.indexOf("Windows NT 5.1")>-1?t="Windows XP":e.indexOf("Windows NT 5.2")>-1?t="Windows Server 2003":e.indexOf("Windows NT 6.0")>-1?t="Windows Vista":e.indexOf("Windows NT 6.1")>-1?t="Windows 7":e.indexOf("Windows NT 6.2")>-1?t="Windows 8":e.indexOf("Windows NT 6.3")>-1?t="Windows 8.1":e.indexOf("Windows NT 10")>-1&&(t="Windows 10"),e.indexOf("WOW64")>-1||e.indexOf("Win64")>-1?i=" 64-bit":i=" 32-bit"),t+i}else if(navigator.platform=="MacIntel"||navigator.platform=="Macintosh"){var c="Mac OS X";return e.indexOf("Mac OS X")>-1&&(c=e.substring(e.indexOf("Mac OS X"),e.indexOf(")")),c=c.replace(/_/g,".")),c}return"Unknown Operation System"};p.prototype.openURLInDefaultBrowser=function(e){return cep.util.openURLInDefaultBrowser(e)};p.prototype.getExtensionID=function(){return window.__adobe_cep__.getExtensionId()};p.prototype.getScaleFactor=function(){return window.__adobe_cep__.getScaleFactor()};navigator.appVersion.toLowerCase().indexOf("windows")>=0&&(p.prototype.getMonitorScaleFactor=function(){return window.__adobe_cep__.getMonitorScaleFactor()});p.prototype.setScaleFactorChangedHandler=function(e){window.__adobe_cep__.setScaleFactorChangedHandler(e)};p.prototype.getCurrentApiVersion=function(){var e=JSON.parse(window.__adobe_cep__.getCurrentApiVersion());return e};p.prototype.setPanelFlyoutMenu=function(e){typeof e=="string"&&window.__adobe_cep__.invokeSync("setPanelFlyoutMenu",e)};p.prototype.updatePanelMenuItem=function(e,t,i){var c=!1;if(this.getHostCapabilities().EXTENDED_PANEL_MENU){var g=new ve(e,t,i);c=window.__adobe_cep__.invokeSync("updatePanelMenuItem",JSON.stringify(g))}return c};p.prototype.setContextMenu=function(e,t){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenu",e,t)};p.prototype.setContextMenuByJSON=function(e,t){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenuByJSON",e,t)};p.prototype.updateContextMenuItem=function(e,t,i){var c=new Ee(e,t,i);ret=window.__adobe_cep__.invokeSync("updateContextMenuItem",JSON.stringify(c))};p.prototype.isWindowVisible=function(){return window.__adobe_cep__.invokeSync("isWindowVisible","")};p.prototype.resizeContent=function(e,t){window.__adobe_cep__.resizeContent(e,t)};p.prototype.registerInvalidCertificateCallback=function(e){return window.__adobe_cep__.registerInvalidCertificateCallback(e)};p.prototype.registerKeyEventsInterest=function(e){return window.__adobe_cep__.registerKeyEventsInterest(e)};p.prototype.setWindowTitle=function(e){window.__adobe_cep__.invokeSync("setWindowTitle",e)};p.prototype.getWindowTitle=function(){return window.__adobe_cep__.invokeSync("getWindowTitle","")};String.format=function(e){if(arguments.length===0)return null;var t=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(i,c){return t[c]})};const Oe="0.0.1",Se={version:Oe,id:"com.AudioImporterV2.cep",displayName:"Audio Importer V2",symlink:"local",port:3e3,servePort:5e3,startingDebugPort:8850,extensionManifestVersion:6,requiredRuntimeVersion:9,hosts:[{name:"PPRO",version:"[0.0,99.9]"}],type:"Panel",iconDarkNormal:"./src/assets/light-icon.png",iconNormal:"./src/assets/dark-icon.png",iconDarkNormalRollOver:"./src/assets/light-icon.png",iconNormalRollOver:"./src/assets/dark-icon.png",parameters:["--v=0","--enable-nodejs","--mixed-context"],width:500,height:550,panels:[{mainPath:"./main/index.html",name:"main",panelDisplayName:"Audio Importer V2",autoVisible:!0,width:710,height:500,minWidth:710,minHeight:350,maxWidth:710,maxHeight:850,type:"Modeless"},{mainPath:"./settings/index.html",name:"settings",autoVisible:!1,type:"Custom",startOnEvents:["com.adobe.csxs.events.ApplicationInitialized","applicationActive"],height:1}],build:{jsxBin:"off",sourceMap:!0},zxp:{country:"US",province:"CA",org:"MyCompany",password:"mypassword",tsa:"http://timestamp.digicert.com/",sourceMap:!1,jsxBin:"off"},installModules:[],copyAssets:["./target/release/audio_importer.exe","./js","./jsx"],copyZipAssets:[]},Ce=Se.id;typeof window.cep<"u"&&require("crypto");typeof window.cep<"u"&&require("assert");typeof window.cep<"u"&&require("buffer");typeof window.cep<"u"&&require("child_process");typeof window.cep<"u"&&require("cluster");typeof window.cep<"u"&&require("dgram");typeof window.cep<"u"&&require("dns");typeof window.cep<"u"&&require("domain");typeof window.cep<"u"&&require("events");const oe=typeof window.cep<"u"?require("fs"):{};typeof window.cep<"u"&&require("http");typeof window.cep<"u"&&require("https");typeof window.cep<"u"&&require("net");typeof window.cep<"u"&&require("os");typeof window.cep<"u"&&require("path");typeof window.cep<"u"&&require("punycode");typeof window.cep<"u"&&require("querystring");typeof window.cep<"u"&&require("readline");typeof window.cep<"u"&&require("stream");typeof window.cep<"u"&&require("string_decoder");typeof window.cep<"u"&&require("timers");typeof window.cep<"u"&&require("tls");typeof window.cep<"u"&&require("tty");typeof window.cep<"u"&&require("url");typeof window.cep<"u"&&require("util");typeof window.cep<"u"&&require("v8");typeof window.cep<"u"&&require("vm");typeof window.cep<"u"&&require("zlib");const ce=new p,Re=(e,t=!1)=>new Promise(function(i,c){const w=(t?"":`var host = typeof $ !== 'undefined' ? $ : window; host["${Ce}"].`)+e;ce.evalScript("try{"+w+"}catch(e){alert(e);}",y=>{i(y)})}),re=e=>Re(`typeof $ !== 'undefined' ? $.evalFile("`+e+'") : fl.runScript(FLfile.platformPathToURI("'+e+'"));',!0),Ie=(e=!0)=>{if(window.cep){const t=ce.getSystemPath("extension"),i=`${t}/jsx/index.js`,c=`${t}/jsx/index.jsxbin`;oe.existsSync(i)?(e&&console.log(i),re(i)):oe.existsSync(c)&&(e&&console.log(c),re(c))}};var de={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ie=o.React.createContext&&o.React.createContext(de),Pe=["attr","size","title"];function je(e,t){if(e==null)return{};var i=Ne(e,t),c,g;if(Object.getOwnPropertySymbols){var w=Object.getOwnPropertySymbols(e);for(g=0;g<w.length;g++)c=w[g],!(t.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(e,c)&&(i[c]=e[c])}return i}function Ne(e,t){if(e==null)return{};var i={};for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){if(t.indexOf(c)>=0)continue;i[c]=e[c]}return i}function A(){return A=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(e[c]=i[c])}return e},A.apply(this,arguments)}function se(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter(function(g){return Object.getOwnPropertyDescriptor(e,g).enumerable})),i.push.apply(i,c)}return i}function D(e){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?se(Object(i),!0).forEach(function(c){ke(e,c,i[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):se(Object(i)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(i,c))})}return e}function ke(e,t,i){return t=We(t),t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function We(e){var t=Le(e,"string");return typeof t=="symbol"?t:t+""}function Le(e,t){if(typeof e!="object"||!e)return e;var i=e[Symbol.toPrimitive];if(i!==void 0){var c=i.call(e,t||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function le(e){return e&&e.map((t,i)=>o.React.createElement(t.tag,D({key:i},t.attr),le(t.child)))}function fe(e){return t=>o.React.createElement(Fe,A({attr:D({},e.attr)},t),le(e.child))}function Fe(e){var t=i=>{var{attr:c,size:g,title:w}=e,y=je(e,Pe),v=g||i.size||"1em",m;return i.className&&(m=i.className),e.className&&(m=(m?m+" ":"")+e.className),o.React.createElement("svg",A({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},i.attr,c,y,{className:m,style:D(D({color:e.color||i.color},i.style),e.style),height:v,width:v,xmlns:"http://www.w3.org/2000/svg"}),w&&o.React.createElement("title",null,w),e.children)};return ie!==void 0?o.React.createElement(ie.Consumer,null,i=>t(i)):t(de)}function $e(e){return fe({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(e)}function Ae(e){return fe({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M476 480H324a36 36 0 0 1-36-36V96h-96v156a36 36 0 0 1-36 36H16a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h112V68a36 36 0 0 1 36-36h152a36 36 0 0 1 36 36v348h96V260a36 36 0 0 1 36-36h140a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H512v156a36 36 0 0 1-36 36z"},child:[]}]})(e)}var b=[];for(var J=0;J<256;++J)b.push((J+256).toString(16).slice(1));function De(e,t=0){return(b[e[t+0]]+b[e[t+1]]+b[e[t+2]]+b[e[t+3]]+"-"+b[e[t+4]]+b[e[t+5]]+"-"+b[e[t+6]]+b[e[t+7]]+"-"+b[e[t+8]]+b[e[t+9]]+"-"+b[e[t+10]]+b[e[t+11]]+b[e[t+12]]+b[e[t+13]]+b[e[t+14]]+b[e[t+15]]).toLowerCase()}var $,Me=new Uint8Array(16);function Te(){if(!$&&($=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!$))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return $(Me)}var qe=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const ae={randomUUID:qe};function K(e,t,i){if(ae.randomUUID&&!t&&!e)return ae.randomUUID();e=e||{};var c=e.random||(e.rng||Te)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,t){i=i||0;for(var g=0;g<16;++g)t[i+g]=c[g];return t}return De(c)}console.log("main.tsx is being executed");const Be=()=>{console.log("Main component is rendering");const[e,t]=o.reactExports.useState([]),[i,c]=o.reactExports.useState([]),[g,w]=o.reactExports.useState(!1),[y,v]=o.reactExports.useState(!1),[m,M]=o.reactExports.useState(!1),[W,T]=o.reactExports.useState(null),[q,B]=o.reactExports.useState(null),[S,pe]=o.reactExports.useState(!1),[V,ue]=o.reactExports.useState(!1),[He,G]=o.reactExports.useState(!1),[R,E]=o.reactExports.useState([]),[x,_]=o.reactExports.useState(null),I=o.reactExports.useRef(y),H=o.reactExports.useRef(m),ge=o.reactExports.useRef(W),P=o.reactExports.useRef(q),L=o.reactExports.useRef(null),u=o.reactExports.useRef(null);o.reactExports.useEffect(()=>{I.current=y},[y]),o.reactExports.useEffect(()=>{H.current=m},[m]),o.reactExports.useEffect(()=>{ge.current=W},[W]),o.reactExports.useEffect(()=>{P.current=q},[q]);const a=n=>{console.log("Debug log:",n),c(r=>[...r,n])},j=n=>{const r={LAlt:"Alt",RAlt:"Alt",LControl:"Ctrl",RControl:"Ctrl",ControlLeft:"Ctrl",ControlRight:"Ctrl",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",Numpad0:"0"},d=["ctrl","shift","alt"];return n.split("+").map(f=>r[f]||f).map(f=>f.toLowerCase()).sort((f,h)=>{const z=d.indexOf(f.charAt(0).toLowerCase()+f.slice(1)),U=d.indexOf(h.charAt(0).toLowerCase()+h.slice(1));return z===-1&&U===-1?f.localeCompare(h):z===-1?1:U===-1?-1:z-U}).join("+")},O=()=>{if(!x){a("No current profile selected. Please create a profile.");return}if(u.current&&u.current.readyState===WebSocket.OPEN){console.log("Loading config for profile:",x),G(!0);try{u.current.send(`LOAD_CONFIG:${x}`)}catch(n){G(!1),n instanceof Error?a(`Error loading config: ${n.message}`):a("Unexpected error loading config."),console.error("Error loading config:",n)}}else a("Cannot load config: WebSocket is not open.")};u.current&&(u.current.onmessage=n=>{var d;console.log("Received message from server:",n.data);const r=n.data;if(a(`Received message: ${r}`),typeof r=="string"){if(r.startsWith("CONFIG:")){if(!x){a("No current profile selected.");return}const s=JSON.parse(r.replace("CONFIG:","")),l=Object.entries(s).map(([f,h])=>({id:K(),key:j(f),binding:h}));t(l),a("Config loaded and converted to array successfully")}else if(r.startsWith("COMBO:")){const s=r.replace("COMBO:","");a(`Processed combo: ${s}`),I.current?H.current&&P.current?X(P.current,s):Z(s):Y(s)}else if(r.startsWith("PROFILES:")){const s=JSON.parse(r.replace("PROFILES:",""));E(s),ue(!0),a("Profiles loaded"),!x&&s.length>0&&_(s[0])}else if(r.startsWith("PROFILE_SWITCHED:")){const s=r.replace("PROFILE_SWITCHED:","");_(s),O()}else if(r.startsWith("PROFILE_CREATED:")){const s=r.replace("PROFILE_CREATED:","");E(l=>[...l,s]),_(s),t([]),a(`Profile created and switched to: ${s}`)}else if(r.startsWith("PROFILE_DELETED:")){const s=r.replace("PROFILE_DELETED:","");if(E(l=>l.filter(f=>f!==s)),x===s){const l=R.find(f=>f!==s)||null;_(l),l?((d=u.current)==null||d.send(`SWITCH_PROFILE:${l}`),t([]),O()):t([])}a(`Profile deleted: ${s}`)}else if(r.startsWith("ERROR:")){const s=r.replace("ERROR:","");a(`Error: ${s}`)}}});const ye=n=>{if(!u.current||!S){a("WebSocket is not initialized or ready.");return}_(n),t([]),localStorage.setItem("lastProfile",n),u.current.send(`SWITCH_PROFILE:${n}`)},N=n=>{if(!x){a("Cannot save config: No current profile selected.");return}if(!u.current){a("WebSocket is not initialized.");return}const r=n.reduce((d,s)=>(d[s.key]=s.binding,d),{});try{a(`Sending config to server for profile ${x}: ${JSON.stringify(r)}`);const d=JSON.stringify({profile:x,config:r});u.current.send(`SAVE_CONFIG:${d}`),a("Config sent successfully"),t(n)}catch(d){d instanceof Error?a(`Error saving config: ${d.message}`):a("Unexpected error saving config.")}},k=(n,r)=>{console.log("Updating binding with value:",r),t(d=>{const s=d.findIndex(f=>f.id===n);if(s===-1)return a(`Keybinding with id ${n} not found in config.`),d;const l=[...d];return l[s]={...l[s],binding:r},a(`Updating config for id: ${n} with value: ${JSON.stringify(r)}`),N(l),l})},C=()=>{a("Stopping key listener..."),v(!1),I.current=!1,a("isListeningForKey set to false"),w(!1),a("isAddingBinding set to false"),m&&(M(!1),T(null),B(null),a("Editing state reset"))},X=(n,r)=>{a(`Editing key binding with id ${n} to ${r}`);const d=j(r);t(s=>{if(s.some(h=>h.key===d))return a(`Key combination ${d} already exists in config.`),C(),s;const l=s.findIndex(h=>h.id===n);if(l===-1)return a(`Keybinding with id ${n} not found in config.`),C(),s;const f=[...s];return f[l]={...f[l],key:d},a(`Config after editing: ${JSON.stringify(f)}`),N(f),C(),M(!1),T(null),B(null),f})},Y=n=>{const r=j(n);e.some(d=>d.key===r)?a(`Processing combo: ${r}`):a(`Combo ${r} not found in config`)},Z=o.reactExports.useCallback(n=>{a(`Detected key combination: ${n}`);const r=j(n);a(`Normalized key combination: ${r}`),t(d=>{if(d.some(f=>f.key===r))return a(`Key combination ${r} already exists in config.`),C(),d;const s={id:K(),key:r,binding:{volume:0,pitch:0,track:"A1",path:""}},l=[...d,s];return a(`New config before saving: ${JSON.stringify(l)}`),N(l),a(`Key binding ${r} added to config.`),C(),l})},[a,N,C]);function Q(){if(u.current&&u.current.readyState===WebSocket.OPEN){a("WebSocket already connected");return}a("Establishing WebSocket connection..."),u.current=new WebSocket("ws://localhost:7878"),u.current.onopen=()=>{a("Connected to Rust server"),pe(!0),ne(),O()},u.current.onerror=n=>{a(`WebSocket Error: ${n instanceof ErrorEvent?n.message:"Unknown error"}`)},u.current.onclose=n=>{a(`Disconnected from Rust server: ${n.reason}`),setTimeout(()=>{a("Attempting to reconnect..."),Q()},5e3)},u.current.onmessage=n=>{var d;console.log("Received message from server:",n.data);const r=n.data;if(a(`Received message: ${r}`),typeof r=="string"){if(r.startsWith("CONFIG:")){if(!x){a("No current profile selected.");return}const s=JSON.parse(r.replace("CONFIG:","")),l=Object.entries(s).map(([f,h])=>({id:K(),key:j(f),binding:h}));t(l),a("Config loaded and converted to array successfully")}else if(r.startsWith("COMBO:")){const s=r.replace("COMBO:","");a(`Processed combo: ${s}`),I.current?H.current&&P.current?X(P.current,s):Z(s):Y(s)}else if(r.startsWith("PROFILES:")){const s=JSON.parse(r.replace("PROFILES:",""));E(s),!x&&s.length>0&&_(s[0])}else if(r.startsWith("PROFILE_SWITCHED:")){const s=r.replace("PROFILE_SWITCHED:","");_(s),O()}else if(r.startsWith("PROFILE_CREATED:")){const s=r.replace("PROFILE_CREATED:","");E(l=>[...l,s]),_(s),t([]),a(`Profile created and switched to: ${s}`)}else if(r.startsWith("PROFILE_DELETED:")){const s=r.replace("PROFILE_DELETED:","");if(E(l=>l.filter(f=>f!==s)),x===s){const l=R.find(f=>f!==s)||null;_(l),l?((d=u.current)==null||d.send(`SWITCH_PROFILE:${l}`),t([]),O()):t([])}a(`Profile deleted: ${s}`)}else if(r.startsWith("ERROR:")){const s=r.replace("ERROR:","");a(`Error: ${s}`)}}}}const ee=o.reactExports.useCallback(()=>{u.current&&u.current.readyState===WebSocket.OPEN?(a("WebSocket connection is open. Starting key listener..."),v(!0),I.current=!0,a("isListeningForKey set to true")):a("WebSocket connection is not open. Cannot start key listener.")},[a]),xe=(n,r)=>{!y&&!m&&(M(!0),T(r),B(n),a(`Editing binding for key: ${r} with id: ${n}`),ee())},me=()=>{!y&&!m&&(w(!0),a("Add binding clicked. isListeningForKey set to true"),ee())},be=n=>{a(`Attempting to select audio file for id: ${n}`),L.current?(a("File input reference is available."),L.current.click(),L.current.onchange=r=>{var s;a("File input change event triggered.");const d=(s=r.target.files)==null?void 0:s[0];if(d){a(`File selected: ${d.name}`);const l=d.path||d.name;a(`File path resolved to: ${l}`);const f=e.find(h=>h.id===n);f&&(k(n,{...f.binding,path:l}),a(`Selected audio file for id ${n}: ${l}`))}else a("No file selected.")}):a("File input reference is not available.")},we=n=>{t(r=>{const d=r.findIndex(l=>l.id===n);if(d===-1)return a(`Keybinding with id ${n} not found in config.`),r;const s=[...r];return s.splice(d,1),a(`Deleting binding with id: ${n}`),N(s),a(`Binding deleted for id ${n}`),s})},he=n=>{var r;return((r=n==null?void 0:n.split("\\").pop())==null?void 0:r.split("/").pop())||""},te=o.reactExports.useCallback((n,r,d)=>{if(d===""||d==="-"||d==="-."||/^-?\d*\.?\d*$/.test(d)){const l=e.find(f=>f.id===n);l&&k(n,{...l.binding,[r]:d})}const s=parseFloat(d);if(!isNaN(s)){if(r==="pitch"&&(s<-12||s>12))return;const l=e.find(f=>f.id===n);l&&k(n,{...l.binding,[r]:s})}},[e,k]),ne=()=>{if(u.current&&u.current.readyState===WebSocket.OPEN)try{u.current.send("GET_PROFILES")}catch(n){a(`Error loading profiles: ${n}`)}else a("Cannot load profiles: WebSocket is not open.")},F=()=>{var r;const n=prompt("Enter new profile name:");n&&((r=u.current)==null||r.send(`CREATE_PROFILE:${n}`),_(n),t([]),a(`New profile created and switched to: ${n}`))},_e=()=>{var n,r;if(confirm(`Are you sure you want to delete profile '${x}'?`)){(n=u.current)==null||n.send(`DELETE_PROFILE:${x}`),E(s=>s.filter(l=>l!==x));const d=R.find(s=>s!==x)||null;d?(_(d),t([]),(r=u.current)==null||r.send(`SWITCH_PROFILE:${d}`),O()):t([])}};return o.reactExports.useEffect(()=>{console.log("useEffect hook is running");const n=localStorage.getItem("lastProfile");Q();const r=()=>{var s;S?n?(_(n),(s=u.current)==null||s.send(`SWITCH_PROFILE:${n}`),O()):ne():console.log("WebSocket not ready yet. Waiting...")},d=setInterval(()=>{r(),S&&clearInterval(d)},100);return()=>{u.current&&u.current.close()}},[S]),!S||!V?o.jsx("div",{style:{fontFamily:"Roboto, sans-serif",backgroundColor:"#1e2057",color:"#ffffff",padding:"10px",textAlign:"center"},children:o.jsx("div",{children:"Loading profiles, please wait..."})}):x?o.jsx("div",{style:{fontFamily:"Roboto, sans-serif",backgroundColor:"#1e2057",color:"#ffffff",padding:"10px"},children:!S||!V?o.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[o.jsx("div",{style:{fontSize:"20px",marginBottom:"10px"},children:"Loading profiles, please wait..."}),o.jsx("div",{className:"spinner",style:{fontSize:"30px"},children:"🔄"})," "]}):o.jsx(o.Fragment,{children:x?o.jsxs(o.Fragment,{children:[o.jsx("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#2e2f77",borderRadius:"5px"},children:R.length>0&&x?o.jsx("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:o.jsxs("div",{children:[o.jsx("label",{htmlFor:"profile-select",style:{marginRight:"10px"},children:"Profile:"}),o.jsx("select",{id:"profile-select",value:x,onChange:n=>ye(n.target.value),style:{padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"},children:R.map(n=>o.jsx("option",{value:n,children:n},n))}),o.jsx("button",{onClick:F,style:{padding:"6px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",marginRight:"10px"},children:"New Profile"}),o.jsx("button",{onClick:_e,style:{padding:"6px",backgroundColor:"#ff5b3b",color:"#ffffff",borderRadius:"2px",border:"none",cursor:"pointer"},children:"Delete Profile"})]})}):o.jsxs("div",{children:[o.jsx("p",{children:"No profiles available. Please create a new profile."}),o.jsx("button",{onClick:F,style:{padding:"10px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",cursor:"pointer"},children:"Create Profile"})]})}),o.jsx("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#2e2f77",borderRadius:"5px"},children:o.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[o.jsx("input",{type:"text",readOnly:!0,value:y?m?`Editing ${W||""}: Press new key...`:"Press a key combination...":"Click Add Binding to start",style:{width:"250px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px"}}),o.jsx("button",{onClick:me,disabled:y||m,style:{width:"150px",padding:"6px",backgroundColor:y||m?"#2e3177":"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",cursor:y||m?"not-allowed":"pointer"},children:y?"Listening...":"Add Binding"})]})}),o.jsx("input",{type:"file",ref:L,style:{display:"none"},accept:"audio/*"}),o.jsx("div",{children:e.map(n=>o.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",backgroundColor:"#2e2f77",padding:"10px",borderRadius:"5px"},children:[o.jsx("button",{onClick:()=>we(n.id),style:{width:"30px",height:"30px",padding:"6px",backgroundColor:"transparent",color:"#ff5b3b",borderRadius:"50%",border:"none",cursor:"pointer",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"10px"},children:"✖"}),o.jsx("input",{type:"text",readOnly:!0,value:n.key,style:{width:"70px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px",textAlign:"center"}}),o.jsx("button",{onClick:()=>xe(n.id,n.key),disabled:y||m,style:{width:"50px",padding:"6px",backgroundColor:y||m?"#2e3177":"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",marginRight:"10px",cursor:y||m?"not-allowed":"pointer"},children:"Edit"}),o.jsx("select",{value:n.binding.track,onChange:r=>k(n.id,{...n.binding,track:r.target.value}),style:{width:"70px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"},children:Array.from({length:15},(r,d)=>o.jsxs("option",{value:`A${d+1}`,children:["A",d+1]},d))}),o.jsx("input",{type:"text",readOnly:!0,value:he(n.binding.path),style:{width:"120px",padding:"7px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"}}),o.jsx("button",{onClick:()=>be(n.id),style:{width:"120px",padding:"6px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",marginRight:"10px"},children:"Audio..."}),o.jsxs("div",{style:{display:"flex",alignItems:"center",marginRight:"15px",position:"relative"},children:[o.jsx($e,{style:{color:"#ffffff",marginRight:"10px"}}),o.jsxs("div",{style:{position:"relative"},children:[o.jsx("input",{type:"number",value:n.binding.volume,onChange:r=>te(n.id,"volume",r.target.value),style:{width:"40px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",textAlign:"center"}}),o.jsx("span",{style:{position:"absolute",right:"6px",top:"50%",transform:"translateY(-50%)",color:"#ffffff",fontSize:"12px",pointerEvents:"none"},children:"dB"})]})]}),o.jsxs("div",{style:{display:"flex",alignItems:"center",marginRight:"15px",position:"relative"},children:[o.jsx(Ae,{style:{marginRight:"0px",marginLeft:"-15px",width:"40px",padding:"0px"}}),o.jsxs("div",{style:{position:"relative"},children:[o.jsx("input",{type:"number",value:n.binding.pitch,onChange:r=>te(n.id,"pitch",r.target.value),min:"-12",max:"12",step:"1",style:{width:"40px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",textAlign:"center"}}),o.jsx("span",{style:{position:"absolute",right:"6px",top:"50%",transform:"translateY(-50%)",color:"#ffffff",fontSize:"12px",pointerEvents:"none"},children:"st"})]})]})]},n.id))})]}):o.jsx("div",{style:{fontFamily:"Roboto, sans-serif",backgroundColor:"#1e2057",color:"#ffffff",padding:"10px"},children:o.jsxs("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#2e2f77",borderRadius:"5px"},children:[o.jsx("p",{children:"No profiles available. Please create a new profile."}),o.jsx("button",{onClick:F,style:{padding:"10px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",cursor:"pointer"},children:"Create Profile"})]})})})}):o.jsx("div",{style:{fontFamily:"Roboto, sans-serif",backgroundColor:"#1e2057",color:"#ffffff",padding:"10px"},children:o.jsxs("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#2e2f77",borderRadius:"5px"},children:[o.jsx("p",{children:"No profiles available. Please create a new profile."}),o.jsx("button",{onClick:F,style:{padding:"10px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",cursor:"pointer"},children:"Create Profile"})]})})};console.log("Exporting Main component");Ie();o.client.createRoot(document.getElementById("root")).render(o.jsx(o.React.StrictMode,{children:o.jsx(Be,{})}));
//# sourceMappingURL=main-861358b5.js.map
