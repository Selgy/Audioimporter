"use strict";var exports = typeof exports === "undefined" ? {} : exports;;const s=typeof cep_node !== 'undefined'?cep_node.require(cep_node.global["__dir"+"name"] + "/assets/client-b54d271c.js"):require("../assets/client-b54d271c.js");function B(e,t,r){this.menuItemLabel=e,this.enabled=t,this.checked=r}function P(e,t,r){this.menuItemID=e,this.enabled=t,this.checked=r}function a(){}a.THEME_COLOR_CHANGED_EVENT="com.adobe.csxs.events.ThemeColorChanged";a.prototype.hostEnvironment=window.__adobe_cep__?JSON.parse(window.__adobe_cep__.getHostEnvironment()):null;a.prototype.getHostEnvironment=function(){return this.hostEnvironment=JSON.parse(window.__adobe_cep__.getHostEnvironment()),this.hostEnvironment};a.prototype.loadBinAsync=function(e,t){try{var r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("GET",e,!0),r.onerror=function(){return console.log("Unable to load snapshot from given URL"),!1},r.send(),r.onload=()=>{window.__adobe_cep__.loadSnapshot(r.response),typeof t=="function"?t():typeof t<"u"&&console.log("Provided callback is not a function")}}catch(c){return console.log(c),!1}return!0};a.prototype.loadBinSync=function(e){try{var t=this.getOSInformation();if(e.startsWith("file://"))return t.indexOf("Windows")>=0?e=e.replace("file:///",""):t.indexOf("Mac")>=0&&(e=e.replace("file://","")),window.__adobe_cep__.loadSnapshot(e),!0}catch(r){return console.log(r),!1}return!1};a.prototype.closeExtension=function(){window.__adobe_cep__.closeExtension()};a.prototype.getSystemPath=function(e){var t=decodeURI(window.__adobe_cep__.getSystemPath(e)),r=this.getOSInformation();return r.indexOf("Windows")>=0?t=t.replace("file:///",""):r.indexOf("Mac")>=0&&(t=t.replace("file://","")),t};a.prototype.evalScript=function(e,t){t==null&&(t=function(r){}),window.__adobe_cep__.evalScript(e,t)};a.prototype.getApplicationID=function(){var e=this.hostEnvironment.appId;return e};a.prototype.getHostCapabilities=function(){var e=JSON.parse(window.__adobe_cep__.getHostCapabilities());return e};a.prototype.dispatchEvent=function(e){typeof e.data=="object"&&(e.data=JSON.stringify(e.data)),window.__adobe_cep__.dispatchEvent(e)};a.prototype.addEventListener=function(e,t,r){window.__adobe_cep__.addEventListener(e,t,r)};a.prototype.removeEventListener=function(e,t,r){window.__adobe_cep__.removeEventListener(e,t,r)};a.prototype.requestOpenExtension=function(e,t){window.__adobe_cep__.requestOpenExtension(e,t)};a.prototype.getExtensions=function(e){var t=JSON.stringify(e),r=window.__adobe_cep__.getExtensions(t),c=JSON.parse(r);return c};a.prototype.getNetworkPreferences=function(){var e=window.__adobe_cep__.getNetworkPreferences(),t=JSON.parse(e);return t};a.prototype.initResourceBundle=function(){for(var e=JSON.parse(window.__adobe_cep__.initResourceBundle()),t=document.querySelectorAll("[data-locale]"),r=0;r<t.length;r++){var c=t[r],w=c.getAttribute("data-locale");if(w){for(var g in e)if(g.indexOf(w)===0){var l=e[g];if(g.length==w.length)c.innerHTML=l;else if(g.charAt(w.length)=="."){var m=g.substring(w.length+1);c[m]=l}}}}return e};a.prototype.dumpInstallationInfo=function(){return window.__adobe_cep__.dumpInstallationInfo()};a.prototype.getOSInformation=function(){var e=navigator.userAgent;if(navigator.platform=="Win32"||navigator.platform=="Windows"){var t="Windows",r="";return e.indexOf("Windows")>-1&&(e.indexOf("Windows NT 5.0")>-1?t="Windows 2000":e.indexOf("Windows NT 5.1")>-1?t="Windows XP":e.indexOf("Windows NT 5.2")>-1?t="Windows Server 2003":e.indexOf("Windows NT 6.0")>-1?t="Windows Vista":e.indexOf("Windows NT 6.1")>-1?t="Windows 7":e.indexOf("Windows NT 6.2")>-1?t="Windows 8":e.indexOf("Windows NT 6.3")>-1?t="Windows 8.1":e.indexOf("Windows NT 10")>-1&&(t="Windows 10"),e.indexOf("WOW64")>-1||e.indexOf("Win64")>-1?r=" 64-bit":r=" 32-bit"),t+r}else if(navigator.platform=="MacIntel"||navigator.platform=="Macintosh"){var c="Mac OS X";return e.indexOf("Mac OS X")>-1&&(c=e.substring(e.indexOf("Mac OS X"),e.indexOf(")")),c=c.replace(/_/g,".")),c}return"Unknown Operation System"};a.prototype.openURLInDefaultBrowser=function(e){return cep.util.openURLInDefaultBrowser(e)};a.prototype.getExtensionID=function(){return window.__adobe_cep__.getExtensionId()};a.prototype.getScaleFactor=function(){return window.__adobe_cep__.getScaleFactor()};navigator.appVersion.toLowerCase().indexOf("windows")>=0&&(a.prototype.getMonitorScaleFactor=function(){return window.__adobe_cep__.getMonitorScaleFactor()});a.prototype.setScaleFactorChangedHandler=function(e){window.__adobe_cep__.setScaleFactorChangedHandler(e)};a.prototype.getCurrentApiVersion=function(){var e=JSON.parse(window.__adobe_cep__.getCurrentApiVersion());return e};a.prototype.setPanelFlyoutMenu=function(e){typeof e=="string"&&window.__adobe_cep__.invokeSync("setPanelFlyoutMenu",e)};a.prototype.updatePanelMenuItem=function(e,t,r){var c=!1;if(this.getHostCapabilities().EXTENDED_PANEL_MENU){var w=new B(e,t,r);c=window.__adobe_cep__.invokeSync("updatePanelMenuItem",JSON.stringify(w))}return c};a.prototype.setContextMenu=function(e,t){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenu",e,t)};a.prototype.setContextMenuByJSON=function(e,t){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenuByJSON",e,t)};a.prototype.updateContextMenuItem=function(e,t,r){var c=new P(e,t,r);ret=window.__adobe_cep__.invokeSync("updateContextMenuItem",JSON.stringify(c))};a.prototype.isWindowVisible=function(){return window.__adobe_cep__.invokeSync("isWindowVisible","")};a.prototype.resizeContent=function(e,t){window.__adobe_cep__.resizeContent(e,t)};a.prototype.registerInvalidCertificateCallback=function(e){return window.__adobe_cep__.registerInvalidCertificateCallback(e)};a.prototype.registerKeyEventsInterest=function(e){return window.__adobe_cep__.registerKeyEventsInterest(e)};a.prototype.setWindowTitle=function(e){window.__adobe_cep__.invokeSync("setWindowTitle",e)};a.prototype.getWindowTitle=function(){return window.__adobe_cep__.invokeSync("getWindowTitle","")};String.format=function(e){if(arguments.length===0)return null;var t=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(r,c){return t[c]})};const D="0.0.1",T={version:D,id:"com.AudioImporterV2.cep",displayName:"Audio Importer V2",symlink:"local",port:3e3,servePort:5e3,startingDebugPort:8850,extensionManifestVersion:6,requiredRuntimeVersion:9,hosts:[{name:"PPRO",version:"[0.0,99.9]"}],type:"Panel",iconDarkNormal:"./src/assets/light-icon.png",iconNormal:"./src/assets/dark-icon.png",iconDarkNormalRollOver:"./src/assets/light-icon.png",iconNormalRollOver:"./src/assets/dark-icon.png",parameters:["--v=0","--enable-nodejs","--mixed-context"],width:500,height:550,panels:[{mainPath:"./main/index.html",name:"main",panelDisplayName:"Audio Importer V2",autoVisible:!0,width:690,height:650},{mainPath:"./settings/index.html",name:"settings",autoVisible:!1,type:"Custom",startOnEvents:["com.adobe.csxs.events.ApplicationInitialized","applicationActive"],height:1}],build:{jsxBin:"off",sourceMap:!0},zxp:{country:"US",province:"CA",org:"MyCompany",password:"mypassword",tsa:"http://timestamp.digicert.com/",sourceMap:!1,jsxBin:"off"},installModules:[],copyAssets:["./target/release/audio_importer.exe","./js","./jsx"],copyZipAssets:[]},J=T.id;typeof window.cep<"u"&&require("crypto");typeof window.cep<"u"&&require("assert");typeof window.cep<"u"&&require("buffer");typeof window.cep<"u"&&require("child_process");typeof window.cep<"u"&&require("cluster");typeof window.cep<"u"&&require("dgram");typeof window.cep<"u"&&require("dns");typeof window.cep<"u"&&require("domain");typeof window.cep<"u"&&require("events");const I=typeof window.cep<"u"?require("fs"):{};typeof window.cep<"u"&&require("http");typeof window.cep<"u"&&require("https");typeof window.cep<"u"&&require("net");typeof window.cep<"u"&&require("os");typeof window.cep<"u"&&require("path");typeof window.cep<"u"&&require("punycode");typeof window.cep<"u"&&require("querystring");typeof window.cep<"u"&&require("readline");typeof window.cep<"u"&&require("stream");typeof window.cep<"u"&&require("string_decoder");typeof window.cep<"u"&&require("timers");typeof window.cep<"u"&&require("tls");typeof window.cep<"u"&&require("tty");typeof window.cep<"u"&&require("url");typeof window.cep<"u"&&require("util");typeof window.cep<"u"&&require("v8");typeof window.cep<"u"&&require("vm");typeof window.cep<"u"&&require("zlib");const W=new a,U=(e,t=!1)=>new Promise(function(r,c){const g=(t?"":`var host = typeof $ !== 'undefined' ? $ : window; host["${J}"].`)+e;W.evalScript("try{"+g+"}catch(e){alert(e);}",l=>{r(l)})}),R=e=>U(`typeof $ !== 'undefined' ? $.evalFile("`+e+'") : fl.runScript(FLfile.platformPathToURI("'+e+'"));',!0),H=(e=!0)=>{if(window.cep){const t=W.getSystemPath("extension"),r=`${t}/jsx/index.js`,c=`${t}/jsx/index.jsxbin`;I.existsSync(r)?(e&&console.log(r),R(r)):I.existsSync(c)&&(e&&console.log(c),R(c))}};console.log("main.tsx is being executed");const K=()=>{console.log("Main component is rendering");const[e,t]=s.reactExports.useState({}),[r,c]=s.reactExports.useState([]),[w,g]=s.reactExports.useState(!1),[l,m]=s.reactExports.useState(!1),C=s.reactExports.useRef(l),b=s.reactExports.useRef(null),p=s.reactExports.useRef(null);s.reactExports.useEffect(()=>(console.log("useEffect hook is running"),S(),()=>{p.current&&p.current.close()}),[]),s.reactExports.useEffect(()=>{p.current&&(p.current.onmessage=n=>{const o=n.data;if(i(`Received message: ${o}`),typeof o=="string"){if(o.startsWith("CONFIG:")){const d=JSON.parse(o.replace("CONFIG:",""));t(d),i("Config loaded successfully from server")}else if(o.startsWith("COMBO:")){const d=o.replace("COMBO:","");i(`Processed combo: ${d}`),A(d)}}})},[]);const S=s.reactExports.useCallback(()=>{if(p.current&&p.current.readyState===WebSocket.OPEN){i("WebSocket already connected");return}i("Establishing WebSocket connection..."),p.current=new WebSocket("ws://localhost:7878"),p.current.onopen=()=>{i("Connected to Rust server"),j()},p.current.onmessage=n=>{const o=n.data;if(i(`Received message: ${o}`),typeof o=="string"&&o.startsWith("CONFIG:")){const d=JSON.parse(o.replace("CONFIG:",""));t(d),i("Config loaded successfully from server")}},p.current.onerror=n=>{i(`WebSocket Error: ${n instanceof ErrorEvent?n.message:"Unknown error"}`)},p.current.onclose=n=>{i(`Disconnected from Rust server: ${n.reason}`),setTimeout(S,5e3)}},[]),i=n=>{console.log("Debug log:",n),c(o=>[...o,n])},j=()=>{var n;console.log("Loading config");try{(n=p.current)==null||n.send("LOAD_CONFIG")}catch(o){o instanceof Error?i(`Error loading config: ${o.message}`):i("Unexpected error loading config."),console.error("Error loading config:",o)}},O=n=>{var o;try{i(`Sending config to server: ${JSON.stringify(n)}`),(o=p.current)==null||o.send(`SAVE_CONFIG:${JSON.stringify(n)}`),i("Config sent successfully"),t(n)}catch(d){d instanceof Error?i(`Error saving config: ${d.message}`):i("Unexpected error saving config.")}},A=n=>{const o=n.split("+").sort().join("+");e[o]?i(`Processing combo: ${o}`):i(`Combo ${o} not found in config`)},h=()=>{i("Stopping key listener..."),m(!1),C.current=!1,i("isListeningForKey set to false"),g(!1),i("isAddingBinding set to false")},E=s.reactExports.useCallback(n=>{i(`Detected key combination: ${n}`);const o=n.split("+").sort().join("+");i(`Sorted key combination: ${o}`),t(d=>{if(i(`Current config: ${JSON.stringify(d)}`),d[o])return i(`Key combination ${o} already exists in config.`),h(),d;{const f={...d,[o]:{volume:0,pitch:0,track:"A1",path:""}};return i(`New config before saving: ${JSON.stringify(f)}`),O(f),i(`Key binding ${o} added to config.`),h(),p.current&&(p.current.onmessage=u=>{const _=u.data;if(i(`Received message: ${_}`),typeof _=="string"&&_.startsWith("CONFIG:")){const x=JSON.parse(_.replace("CONFIG:",""));t(x),i("Config loaded successfully from server")}}),f}})},[h]),k=s.reactExports.useCallback(()=>{p.current&&p.current.readyState===WebSocket.OPEN?(i("WebSocket connection is open. Starting key listener..."),m(!0),C.current=!0,i("isListeningForKey set to true"),p.current.onmessage=n=>{const o=n.data;if(i(`Received message: ${o}`),typeof o=="string"&&o.startsWith("COMBO:")){const d=o.replace("COMBO:","");i(`Processed combo: ${d}`),E(d)}}):i("WebSocket connection is not open. Cannot start key listener.")},[E]),M=()=>{l||(g(!0),i("Add binding clicked. isListeningForKey set to true"),k())},$=n=>{i(`Attempting to select audio file for key: ${n}`),b.current?(i("File input reference is available."),b.current.click(),b.current.onchange=o=>{var f;i("File input change event triggered.");const d=(f=o.target.files)==null?void 0:f[0];if(d){i(`File selected: ${d.name}`);const u=d.path||d.name;i(`File path resolved to: ${u}`),y(n,{...e[n],path:u}),i(`Selected audio file for ${n}: ${u}`)}else i("No file selected.")}):i("File input reference is not available.")},y=(n,o)=>{console.log("Updating binding with pitch:",o.pitch),t(d=>{const f={...d,[n]:o};return i(`Updating config for key: ${n} with value: ${JSON.stringify(o)}`),f})},q=n=>{t(o=>{const{[n]:d,...f}=o;return i(`Deleting binding for key: ${n}`),O(f),i(`Binding deleted for ${n}`),f})},N=s.reactExports.useCallback((n,o,d)=>{const f=parseFloat(d);if(!isNaN(f)){if(o==="pitch"&&(f<-12||f>12))return;y(n,{...e[n],[o]:f})}},[e,y]),F=n=>{const o={LAlt:"Alt",RAlt:"Alt",LControl:"Ctrl",RControl:"Ctrl",ControlLeft:"Ctrl",ControlRight:"Ctrl",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",Numpad0:"0"},d=["Ctrl","Shift","Alt"];return n.split("+").map(u=>o[u]||u).sort((u,_)=>{const x=d.indexOf(u),v=d.indexOf(_);return x===-1&&v===-1?u.localeCompare(_):x===-1?1:v===-1?-1:x-v}).join("+")},L=n=>{var o;return((o=n.split("\\").pop())==null?void 0:o.split("/").pop())||""};return s.jsxs("div",{style:{fontFamily:"Roboto, sans-serif",backgroundColor:"#1e2057",color:"#ffffff",padding:"10px"},children:[s.jsx("div",{style:{marginBottom:"15px",padding:"10px",backgroundColor:"#2e2f77",borderRadius:"5px"},children:s.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[s.jsx("input",{type:"text",readOnly:!0,value:l?"Press a key combination...":"Click Add Binding to start",style:{width:"250px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px"}}),s.jsx("button",{onClick:M,disabled:l,style:{width:"150px",padding:"6px",backgroundColor:l?"#2e3177":"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",cursor:l?"not-allowed":"pointer"},children:l?"Listening...":"Add Binding"})]})}),s.jsx("input",{type:"file",ref:b,style:{display:"none"},accept:"audio/*"}),s.jsx("div",{children:Object.keys(e).map(n=>s.jsxs("div",{style:{display:"flex",alignItems:"center",marginBottom:"10px",backgroundColor:"#2e2f77",padding:"10px",borderRadius:"5px"},children:[s.jsx("button",{onClick:()=>q(n),style:{width:"30px",height:"30px",padding:"6px",backgroundColor:"transparent",color:"#ff5b3b",borderRadius:"50%",border:"none",cursor:"pointer",fontSize:"16px",display:"flex",alignItems:"center",justifyContent:"center",marginRight:"10px"},children:"✖"}),s.jsx("input",{type:"text",readOnly:!0,value:F(n),style:{width:"70px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px",textAlign:"center"}}),s.jsx("button",{onClick:()=>console.log(`Edit binding for ${n}`),style:{width:"50px",padding:"6px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",marginRight:"10px"},children:"Edit"}),s.jsx("select",{value:e[n].track,onChange:o=>y(n,{...e[n],track:o.target.value}),style:{width:"70px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"},children:Array.from({length:15},(o,d)=>s.jsxs("option",{value:`A${d+1}`,children:["A",d+1]},d))}),s.jsx("input",{type:"text",readOnly:!0,value:L(e[n].path),style:{width:"120px",padding:"7px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"10px"}}),s.jsx("button",{onClick:()=>$(n),style:{width:"120px",padding:"6px",backgroundColor:"#4e52ff",color:"#ffffff",borderRadius:"2px",border:"none",marginRight:"10px"},children:"Audio..."}),s.jsx("input",{type:"number",value:e[n].volume,onChange:o=>N(n,"volume",o.target.value),style:{width:"60px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"5px"}}),s.jsx("span",{style:{marginRight:"10px"},children:"dB"}),s.jsx("input",{type:"number",value:e[n].pitch,onChange:o=>N(n,"pitch",o.target.value),min:"-12",max:"12",step:"1",style:{width:"60px",padding:"6px",backgroundColor:"#3e41a8",color:"#ffffff",border:"none",borderRadius:"2px",marginRight:"5px"}}),s.jsx("span",{style:{marginRight:"10px"},children:"st"}),s.jsxs("label",{style:{display:"flex",alignItems:"center",marginLeft:"5px",justifyContent:"center"},children:[s.jsx("input",{type:"checkbox",checked:e[n].importInMiddle||!1,onChange:o=>y(n,{...e[n],importInMiddle:o.target.checked}),style:{marginRight:"5px"}}),"Middle"]})]},n))})]})};console.log("Exporting Main component");H();s.client.createRoot(document.getElementById("root")).render(s.jsx(s.React.StrictMode,{children:s.jsx(K,{})}));
//# sourceMappingURL=main-f4955cfb.js.map
