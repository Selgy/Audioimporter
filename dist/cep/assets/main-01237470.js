"use strict";var exports = typeof exports === "undefined" ? {} : exports;;const n=typeof cep_node !== 'undefined'?cep_node.require(cep_node.global["__dir"+"name"] + "/assets/client-97072a1f.js"):require("../assets/client-97072a1f.js");function $e(e,t,r){this.menuItemLabel=e,this.enabled=t,this.checked=r}function ke(e,t,r){this.menuItemID=e,this.enabled=t,this.checked=r}function p(){}p.THEME_COLOR_CHANGED_EVENT="com.adobe.csxs.events.ThemeColorChanged";p.prototype.hostEnvironment=window.__adobe_cep__?JSON.parse(window.__adobe_cep__.getHostEnvironment()):null;p.prototype.getHostEnvironment=function(){return this.hostEnvironment=JSON.parse(window.__adobe_cep__.getHostEnvironment()),this.hostEnvironment};p.prototype.loadBinAsync=function(e,t){try{var r=new XMLHttpRequest;r.responseType="arraybuffer",r.open("GET",e,!0),r.onerror=function(){return console.log("Unable to load snapshot from given URL"),!1},r.send(),r.onload=()=>{window.__adobe_cep__.loadSnapshot(r.response),typeof t=="function"?t():typeof t<"u"&&console.log("Provided callback is not a function")}}catch(c){return console.log(c),!1}return!0};p.prototype.loadBinSync=function(e){try{var t=this.getOSInformation();if(e.startsWith("file://"))return t.indexOf("Windows")>=0?e=e.replace("file:///",""):t.indexOf("Mac")>=0&&(e=e.replace("file://","")),window.__adobe_cep__.loadSnapshot(e),!0}catch(r){return console.log(r),!1}return!1};p.prototype.closeExtension=function(){window.__adobe_cep__.closeExtension()};p.prototype.getSystemPath=function(e){var t=decodeURI(window.__adobe_cep__.getSystemPath(e)),r=this.getOSInformation();return r.indexOf("Windows")>=0?t=t.replace("file:///",""):r.indexOf("Mac")>=0&&(t=t.replace("file://","")),t};p.prototype.evalScript=function(e,t){t==null&&(t=function(r){}),window.__adobe_cep__.evalScript(e,t)};p.prototype.getApplicationID=function(){var e=this.hostEnvironment.appId;return e};p.prototype.getHostCapabilities=function(){var e=JSON.parse(window.__adobe_cep__.getHostCapabilities());return e};p.prototype.dispatchEvent=function(e){typeof e.data=="object"&&(e.data=JSON.stringify(e.data)),window.__adobe_cep__.dispatchEvent(e)};p.prototype.addEventListener=function(e,t,r){window.__adobe_cep__.addEventListener(e,t,r)};p.prototype.removeEventListener=function(e,t,r){window.__adobe_cep__.removeEventListener(e,t,r)};p.prototype.requestOpenExtension=function(e,t){window.__adobe_cep__.requestOpenExtension(e,t)};p.prototype.getExtensions=function(e){var t=JSON.stringify(e),r=window.__adobe_cep__.getExtensions(t),c=JSON.parse(r);return c};p.prototype.getNetworkPreferences=function(){var e=window.__adobe_cep__.getNetworkPreferences(),t=JSON.parse(e);return t};p.prototype.initResourceBundle=function(){for(var e=JSON.parse(window.__adobe_cep__.initResourceBundle()),t=document.querySelectorAll("[data-locale]"),r=0;r<t.length;r++){var c=t[r],g=c.getAttribute("data-locale");if(g){for(var b in e)if(b.indexOf(g)===0){var x=e[b];if(b.length==g.length)c.innerHTML=x;else if(b.charAt(g.length)=="."){var h=b.substring(g.length+1);c[h]=x}}}}return e};p.prototype.dumpInstallationInfo=function(){return window.__adobe_cep__.dumpInstallationInfo()};p.prototype.getOSInformation=function(){var e=navigator.userAgent;if(navigator.platform=="Win32"||navigator.platform=="Windows"){var t="Windows",r="";return e.indexOf("Windows")>-1&&(e.indexOf("Windows NT 5.0")>-1?t="Windows 2000":e.indexOf("Windows NT 5.1")>-1?t="Windows XP":e.indexOf("Windows NT 5.2")>-1?t="Windows Server 2003":e.indexOf("Windows NT 6.0")>-1?t="Windows Vista":e.indexOf("Windows NT 6.1")>-1?t="Windows 7":e.indexOf("Windows NT 6.2")>-1?t="Windows 8":e.indexOf("Windows NT 6.3")>-1?t="Windows 8.1":e.indexOf("Windows NT 10")>-1&&(t="Windows 10"),e.indexOf("WOW64")>-1||e.indexOf("Win64")>-1?r=" 64-bit":r=" 32-bit"),t+r}else if(navigator.platform=="MacIntel"||navigator.platform=="Macintosh"){var c="Mac OS X";return e.indexOf("Mac OS X")>-1&&(c=e.substring(e.indexOf("Mac OS X"),e.indexOf(")")),c=c.replace(/_/g,".")),c}return"Unknown Operation System"};p.prototype.openURLInDefaultBrowser=function(e){return cep.util.openURLInDefaultBrowser(e)};p.prototype.getExtensionID=function(){return window.__adobe_cep__.getExtensionId()};p.prototype.getScaleFactor=function(){return window.__adobe_cep__.getScaleFactor()};navigator.appVersion.toLowerCase().indexOf("windows")>=0&&(p.prototype.getMonitorScaleFactor=function(){return window.__adobe_cep__.getMonitorScaleFactor()});p.prototype.setScaleFactorChangedHandler=function(e){window.__adobe_cep__.setScaleFactorChangedHandler(e)};p.prototype.getCurrentApiVersion=function(){var e=JSON.parse(window.__adobe_cep__.getCurrentApiVersion());return e};p.prototype.setPanelFlyoutMenu=function(e){typeof e=="string"&&window.__adobe_cep__.invokeSync("setPanelFlyoutMenu",e)};p.prototype.updatePanelMenuItem=function(e,t,r){var c=!1;if(this.getHostCapabilities().EXTENDED_PANEL_MENU){var g=new $e(e,t,r);c=window.__adobe_cep__.invokeSync("updatePanelMenuItem",JSON.stringify(g))}return c};p.prototype.setContextMenu=function(e,t){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenu",e,t)};p.prototype.setContextMenuByJSON=function(e,t){typeof e=="string"&&window.__adobe_cep__.invokeAsync("setContextMenuByJSON",e,t)};p.prototype.updateContextMenuItem=function(e,t,r){var c=new ke(e,t,r);ret=window.__adobe_cep__.invokeSync("updateContextMenuItem",JSON.stringify(c))};p.prototype.isWindowVisible=function(){return window.__adobe_cep__.invokeSync("isWindowVisible","")};p.prototype.resizeContent=function(e,t){window.__adobe_cep__.resizeContent(e,t)};p.prototype.registerInvalidCertificateCallback=function(e){return window.__adobe_cep__.registerInvalidCertificateCallback(e)};p.prototype.registerKeyEventsInterest=function(e){return window.__adobe_cep__.registerKeyEventsInterest(e)};p.prototype.setWindowTitle=function(e){window.__adobe_cep__.invokeSync("setWindowTitle",e)};p.prototype.getWindowTitle=function(){return window.__adobe_cep__.invokeSync("getWindowTitle","")};String.format=function(e){if(arguments.length===0)return null;var t=Array.prototype.slice.call(arguments,1);return e.replace(/\{(\d+)\}/g,function(r,c){return t[c]})};const Ae="0.0.1",Te={version:Ae,id:"com.AudioImporterV2.cep",displayName:"Audio Importer V2",symlink:"local",port:3e3,servePort:5e3,startingDebugPort:8850,extensionManifestVersion:6,requiredRuntimeVersion:9,hosts:[{name:"PPRO",version:"[0.0,99.9]"}],type:"Panel",iconDarkNormal:"./src/assets/light-icon.png",iconNormal:"./src/assets/dark-icon.png",iconDarkNormalRollOver:"./src/assets/light-icon.png",iconNormalRollOver:"./src/assets/dark-icon.png",parameters:["--v=0","--enable-nodejs","--mixed-context"],width:500,height:550,panels:[{mainPath:"./main/index.html",name:"main",panelDisplayName:"Audio Importer V2",autoVisible:!0,width:710,height:500,minWidth:710,minHeight:350,maxWidth:710,maxHeight:850,type:"Modeless"},{mainPath:"./settings/index.html",name:"settings",autoVisible:!1,type:"Custom",startOnEvents:["com.adobe.csxs.events.ApplicationInitialized","applicationActive"],height:1}],build:{jsxBin:"off",sourceMap:!0},zxp:{country:"US",province:"CA",org:"MyCompany",password:"mypassword",tsa:"http://timestamp.digicert.com/",sourceMap:!1,jsxBin:"off"},installModules:[],copyAssets:["./target/release/audio_importer.exe","./js","./jsx"],copyZipAssets:[]},Fe=Te.id;typeof window.cep<"u"&&require("crypto");typeof window.cep<"u"&&require("assert");typeof window.cep<"u"&&require("buffer");typeof window.cep<"u"&&require("child_process");typeof window.cep<"u"&&require("cluster");typeof window.cep<"u"&&require("dgram");typeof window.cep<"u"&&require("dns");typeof window.cep<"u"&&require("domain");typeof window.cep<"u"&&require("events");const oe=typeof window.cep<"u"?require("fs"):{};typeof window.cep<"u"&&require("http");typeof window.cep<"u"&&require("https");typeof window.cep<"u"&&require("net");typeof window.cep<"u"&&require("os");typeof window.cep<"u"&&require("path");typeof window.cep<"u"&&require("punycode");typeof window.cep<"u"&&require("querystring");typeof window.cep<"u"&&require("readline");typeof window.cep<"u"&&require("stream");typeof window.cep<"u"&&require("string_decoder");typeof window.cep<"u"&&require("timers");typeof window.cep<"u"&&require("tls");typeof window.cep<"u"&&require("tty");typeof window.cep<"u"&&require("url");typeof window.cep<"u"&&require("util");typeof window.cep<"u"&&require("v8");typeof window.cep<"u"&&require("vm");typeof window.cep<"u"&&require("zlib");const ue=new p,De=(e,t=!1)=>new Promise(function(r,c){const b=(t?"":`var host = typeof $ !== 'undefined' ? $ : window; host["${Fe}"].`)+e;ue.evalScript("try{"+b+"}catch(e){alert(e);}",x=>{r(x)})}),se=e=>De(`typeof $ !== 'undefined' ? $.evalFile("`+e+'") : fl.runScript(FLfile.platformPathToURI("'+e+'"));',!0),Me=(e=!0)=>{if(window.cep){const t=ue.getSystemPath("extension"),r=`${t}/jsx/index.js`,c=`${t}/jsx/index.jsxbin`;oe.existsSync(r)?(e&&console.log(r),se(r)):oe.existsSync(c)&&(e&&console.log(c),se(c))}};var pe={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},ae=n.React.createContext&&n.React.createContext(pe),qe=["attr","size","title"];function Be(e,t){if(e==null)return{};var r=Ue(e,t),c,g;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(e);for(g=0;g<b.length;g++)c=b[g],!(t.indexOf(c)>=0)&&Object.prototype.propertyIsEnumerable.call(e,c)&&(r[c]=e[c])}return r}function Ue(e,t){if(e==null)return{};var r={};for(var c in e)if(Object.prototype.hasOwnProperty.call(e,c)){if(t.indexOf(c)>=0)continue;r[c]=e[c]}return r}function M(){return M=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var c in r)Object.prototype.hasOwnProperty.call(r,c)&&(e[c]=r[c])}return e},M.apply(this,arguments)}function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter(function(g){return Object.getOwnPropertyDescriptor(e,g).enumerable})),r.push.apply(r,c)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?ce(Object(r),!0).forEach(function(c){He(e,c,r[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach(function(c){Object.defineProperty(e,c,Object.getOwnPropertyDescriptor(r,c))})}return e}function He(e,t,r){return t=Je(t),t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Je(e){var t=ze(e,"string");return typeof t=="symbol"?t:t+""}function ze(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var c=r.call(e,t||"default");if(typeof c!="object")return c;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function fe(e){return e&&e.map((t,r)=>n.React.createElement(t.tag,q({key:r},t.attr),fe(t.child)))}function ge(e){return t=>n.React.createElement(Ke,M({attr:q({},e.attr)},t),fe(e.child))}function Ke(e){var t=r=>{var{attr:c,size:g,title:b}=e,x=Be(e,qe),h=g||r.size||"1em",w;return r.className&&(w=r.className),e.className&&(w=(w?w+" ":"")+e.className),n.React.createElement("svg",M({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},r.attr,c,x,{className:w,style:q(q({color:e.color||r.color},r.style),e.style),height:h,width:h,xmlns:"http://www.w3.org/2000/svg"}),b&&n.React.createElement("title",null,b),e.children)};return ae!==void 0?n.React.createElement(ae.Consumer,null,r=>t(r)):t(pe)}function Ve(e){return ge({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M215.03 71.05L126.06 160H24c-13.26 0-24 10.74-24 24v144c0 13.25 10.74 24 24 24h102.06l88.97 88.95c15.03 15.03 40.97 4.47 40.97-16.97V88.02c0-21.46-25.96-31.98-40.97-16.97zm233.32-51.08c-11.17-7.33-26.18-4.24-33.51 6.95-7.34 11.17-4.22 26.18 6.95 33.51 66.27 43.49 105.82 116.6 105.82 195.58 0 78.98-39.55 152.09-105.82 195.58-11.17 7.32-14.29 22.34-6.95 33.5 7.04 10.71 21.93 14.56 33.51 6.95C528.27 439.58 576 351.33 576 256S528.27 72.43 448.35 19.97zM480 256c0-63.53-32.06-121.94-85.77-156.24-11.19-7.14-26.03-3.82-33.12 7.46s-3.78 26.21 7.41 33.36C408.27 165.97 432 209.11 432 256s-23.73 90.03-63.48 115.42c-11.19 7.14-14.5 22.07-7.41 33.36 6.51 10.36 21.12 15.14 33.12 7.46C447.94 377.94 480 319.54 480 256zm-141.77-76.87c-11.58-6.33-26.19-2.16-32.61 9.45-6.39 11.61-2.16 26.2 9.45 32.61C327.98 228.28 336 241.63 336 256c0 14.38-8.02 27.72-20.92 34.81-11.61 6.41-15.84 21-9.45 32.61 6.43 11.66 21.05 15.8 32.61 9.45 28.23-15.55 45.77-45 45.77-76.88s-17.54-61.32-45.78-76.86z"},child:[]}]})(e)}function Ge(e){return ge({tag:"svg",attr:{viewBox:"0 0 640 512"},child:[{tag:"path",attr:{d:"M476 480H324a36 36 0 0 1-36-36V96h-96v156a36 36 0 0 1-36 36H16a16 16 0 0 1-16-16v-32a16 16 0 0 1 16-16h112V68a36 36 0 0 1 36-36h152a36 36 0 0 1 36 36v348h96V260a36 36 0 0 1 36-36h140a16 16 0 0 1 16 16v32a16 16 0 0 1-16 16H512v156a36 36 0 0 1-36 36z"},child:[]}]})(e)}var _=[];for(var G=0;G<256;++G)_.push((G+256).toString(16).slice(1));function Xe(e,t=0){return(_[e[t+0]]+_[e[t+1]]+_[e[t+2]]+_[e[t+3]]+"-"+_[e[t+4]]+_[e[t+5]]+"-"+_[e[t+6]]+_[e[t+7]]+"-"+_[e[t+8]]+_[e[t+9]]+"-"+_[e[t+10]]+_[e[t+11]]+_[e[t+12]]+_[e[t+13]]+_[e[t+14]]+_[e[t+15]]).toLowerCase()}var F,Ze=new Uint8Array(16);function Qe(){if(!F&&(F=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!F))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return F(Ze)}var Ye=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const le={randomUUID:Ye};function de(e,t,r){if(le.randomUUID&&!t&&!e)return le.randomUUID();e=e||{};var c=e.random||(e.rng||Qe)();if(c[6]=c[6]&15|64,c[8]=c[8]&63|128,t){r=r||0;for(var g=0;g<16;++g)t[r+g]=c[g];return t}return Xe(c)}const D=({isOpen:e,onClose:t,onSubmit:r,title:c,submitText:g,cancelText:b,inputPlaceholder:x="",showInput:h=!0})=>{const[w,N]=n.reactExports.useState("");if(!e)return null;const P=O=>{O.preventDefault(),(!h||w.trim())&&(r(w.trim()),N(""),t())};return n.jsx("div",{className:"modal-overlay",children:n.jsxs("div",{className:"modal-content",children:[n.jsx("h2",{children:c}),n.jsxs("form",{onSubmit:P,children:[h&&n.jsx("input",{type:"text",value:w,onChange:O=>N(O.target.value),placeholder:x,className:"modal-input"}),n.jsxs("div",{className:"modal-buttons",children:[n.jsx("button",{type:"submit",className:"modal-button submit",children:g}),n.jsx("button",{type:"button",onClick:t,className:"modal-button cancel",children:b})]})]})]})})};console.log("main.tsx is being executed");const et=()=>{console.log("Main component is rendering");const[e,t]=n.reactExports.useState([]),[r,c]=n.reactExports.useState([]),[g,b]=n.reactExports.useState(!1),[x,h]=n.reactExports.useState(!1),[w,N]=n.reactExports.useState(!1),[P,O]=n.reactExports.useState(null),[B,U]=n.reactExports.useState(null),[L,X]=n.reactExports.useState(!1),[Z,me]=n.reactExports.useState(!1);n.reactExports.useState(null);const[tt,we]=n.reactExports.useState(!1),Q=window.electron?require("path"):null;require("os");const[ye,Y]=n.reactExports.useState(!1);n.reactExports.useState(!1);const[be,H]=n.reactExports.useState(!1),[xe,J]=n.reactExports.useState(!1),[ee,W]=n.reactExports.useState(!1);navigator.platform.toUpperCase().indexOf("MAC")>=0,navigator.platform.toUpperCase().indexOf("WIN")>=0;const[$,j]=n.reactExports.useState([]),[m,E]=n.reactExports.useState(null),C=n.reactExports.useRef(null),k=n.reactExports.useRef(x),te=n.reactExports.useRef(w),_e=n.reactExports.useRef(P),z=n.reactExports.useRef(B),he=n.reactExports.useRef(null),f=n.reactExports.useRef(null);n.reactExports.useEffect(()=>{k.current=x},[x]),n.reactExports.useEffect(()=>{te.current=w},[w]),n.reactExports.useEffect(()=>{_e.current=P},[P]),n.reactExports.useEffect(()=>{z.current=B},[B]);const s=i=>{console.log("Debug log:",i),c(o=>[...o,i])},A=i=>{const o={LAlt:"Alt",RAlt:"Alt",LControl:"Ctrl",RControl:"Ctrl",ControlLeft:"Ctrl",ControlRight:"Ctrl",MetaLeft:"Cmd",MetaRight:"Cmd",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",Numpad0:"0"},d=["ctrl","shift","alt"];return i.split("+").map(u=>o[u]||u).map(u=>u.toLowerCase()).sort((u,y)=>{const v=d.indexOf(u.charAt(0).toLowerCase()+u.slice(1)),V=d.indexOf(y.charAt(0).toLowerCase()+y.slice(1));return v===-1&&V===-1?u.localeCompare(y):v===-1?1:V===-1?-1:v-V}).join("+")},T=n.reactExports.useCallback(i=>{const o=i||m;if(!o){s("No profile specified or selected. Cannot load config.");return}s(`Attempting to load config for profile: ${o}`),f.current&&f.current.readyState===WebSocket.OPEN?(s(`WebSocket is open. Sending LOAD_CONFIG request for profile: ${o}`),we(!0),f.current.send(`LOAD_CONFIG:${o}`)):s("Cannot load config: WebSocket is not open.")},[m]),ve=n.reactExports.useCallback(i=>{s(`Switching profile to: ${i}`),f.current&&f.current.readyState===WebSocket.OPEN?(Y(!0),setTimeout(()=>{var o,d;E(i),C.current=i,t([]),(o=f.current)==null||o.send(`SAVE_LAST_SELECTED_PROFILE:${i}`),(d=f.current)==null||d.send(`SWITCH_PROFILE:${i}`),setTimeout(()=>{Y(!1)},50)},300)):s("WebSocket is not initialized or ready.")},[s,E,t]),I=i=>{const o=m||C.current;if(!o){s("Cannot save config: No current profile selected.");return}if(!f.current||f.current.readyState!==WebSocket.OPEN){s("WebSocket is not initialized or not ready.");return}const d=i.reduce((l,a)=>(l[a.key]=a.binding,l),{});try{const l=JSON.stringify({profile:o,config:d});s(`Sending updated config to server: ${l}`),f.current.send(`SAVE_CONFIG:${l}`),s("Config sent successfully"),t(i)}catch(l){l instanceof Error?s(`Error saving config: ${l.message}`):s("Unexpected error saving config.")}},R=(i,o)=>{console.log("Updating binding with value:",o),t(d=>{const l=d.findIndex(u=>u.id===i);if(l===-1)return s(`Keybinding with id ${i} not found in config.`),d;const a=[...d];return a[l]={...a[l],binding:o},s(`Updating config for id: ${i} with value: ${JSON.stringify(o)}`),I(a),a})},S=()=>{s("Stopping key listener..."),h(!1),k.current=!1,s("isListeningForKey set to false"),b(!1),s("isAddingBinding set to false"),w&&(N(!1),O(null),U(null),s("Editing state reset"))},Ee=(i,o)=>{if(s(`Editing key binding with id ${i} to ${o}`),!(m||C.current)){s("Cannot edit binding: No current profile selected."),S();return}const l=A(o);t(a=>{if(a.some(v=>v.key===l&&v.id!==i))return s(`Key combination ${l} already exists in config.`),S(),a;const u=a.findIndex(v=>v.id===i);if(u===-1)return s(`Keybinding with id ${i} not found in config.`),S(),a;const y=[...a];return y[u]={...y[u],key:l},s(`Config after editing: ${JSON.stringify(y)}`),I(y),S(),N(!1),O(null),U(null),y})},Se=i=>{const o=A(i);e.some(d=>d.key===o)?s(`Processing combo: ${o}`):s(`Combo ${o} not found in config`)},Oe=n.reactExports.useCallback(i=>{s(`Detected key combination: ${i}`);const o=A(i);if(s(`Normalized key combination: ${o}`),!(m||C.current)){s("Cannot add new binding: No current profile selected.");return}t(l=>{if(l.some(y=>y.key===o))return s(`Key combination ${o} already exists in config.`),S(),l;const a={id:de(),key:o,binding:{volume:0,pitch:0,track:"A1",path:""}},u=[...l,a];return s(`New config before saving: ${JSON.stringify(u)}`),I(u),s(`Key binding ${o} added to config.`),S(),u})},[s,I,S,m]);n.reactExports.useEffect(()=>(console.log("useEffect hook is running"),ne(),()=>{f.current&&f.current.close()}),[]);function ne(){if(f.current&&f.current.readyState===WebSocket.OPEN){s("WebSocket already connected");return}s("Establishing WebSocket connection..."),f.current=new WebSocket("ws://localhost:7878"),f.current.onopen=()=>{var i;s("Connected to server"),X(!0),Re(),(i=f.current)==null||i.send("GET_LAST_SELECTED_PROFILE")},f.current.onerror=i=>{s(`WebSocket Error: ${i}`)},f.current.onclose=i=>{s(`Disconnected from server: ${i.reason}`),X(!1),setTimeout(()=>{s("Attempting to reconnect..."),ne()},5e3)},f.current.onmessage=i=>{var d,l;const o=i.data;if(s(`Received message: ${o}`),o.startsWith("PROFILE_SWITCHED:")){const a=o.replace("PROFILE_SWITCHED:","");E(a),C.current=a,s(`Profile switched to: ${a}`)}if(o.startsWith("CONFIG:"))try{const a=JSON.parse(o.replace("CONFIG:",""));s(`Parsed config data: ${JSON.stringify(a)}`);const u=Object.entries(a).map(([y,v])=>({id:de(),key:A(y),binding:v}));s(`Converted config array: ${JSON.stringify(u)}`),t(u),s("Config loaded and converted to array successfully")}catch(a){s(`Error parsing CONFIG message: ${a}`)}if(o.startsWith("PROFILES:")){const a=JSON.parse(o.replace("PROFILES:",""));j(a),me(!0),s("Profiles loaded")}if(o.startsWith("LAST_SELECTED_PROFILE:")){const a=o.replace("LAST_SELECTED_PROFILE:","").trim();a&&a!=="None"?(E(a),C.current=a,s(`Restored last selected profile: ${a}`),(d=f.current)==null||d.send(`SWITCH_PROFILE:${a}`)):s("No last selected profile found")}if(o.startsWith("COMBO:")){const a=o.replace("COMBO:","");if(s(`Processed combo: ${a}`),!(m||C.current)){s("Cannot process combo: No current profile selected."),S();return}k.current?(te.current&&z.current?Ee(z.current,a):Oe(a),S()):Se(a)}if(o.startsWith("PROFILE_CREATED:")){const a=o.replace("PROFILE_CREATED:","");j(u=>[...u,a]),E(a),t([]),s(`Profile created and switched to: ${a}`)}if(o.startsWith("PROFILE_DELETED:")){const a=o.replace("PROFILE_DELETED:","");if(j(u=>u.filter(y=>y!==a)),m===a){const u=$.find(y=>y!==a)||null;E(u),u?((l=f.current)==null||l.send(`SWITCH_PROFILE:${u}`),t([]),T(u)):t([])}s(`Profile deleted: ${a}`)}if(o.startsWith("ERROR:")){const a=o.replace("ERROR:","");s(`Error: ${a}`)}}}const ie=n.reactExports.useCallback(()=>{f.current&&f.current.readyState===WebSocket.OPEN?(s("WebSocket connection is open. Starting key listener..."),h(!0),k.current=!0,s("isListeningForKey set to true")):s("WebSocket connection is not open. Cannot start key listener.")},[s]),Ce=(i,o)=>{!x&&!w&&(N(!0),O(o),U(i),s(`Editing binding for key: ${o} with id: ${i}`),ie())},Ne=()=>{!x&&!w&&(b(!0),s("Add binding clicked. isListeningForKey set to true"),ie())},Pe=i=>{if(s(`Attempting to select audio file for id: ${i}`),window.electron&&window.electron.ipcRenderer){window.electron.ipcRenderer.send("open-file-dialog",i);const o=(d,l,a)=>{if(l===i){s(`File selected: ${a}`);const u=e.find(y=>y.id===i);u&&(R(i,{...u.binding,path:a}),s(`Selected audio file for id ${i}: ${a}`)),window.electron.ipcRenderer.removeListener("selected-file",o)}};window.electron.ipcRenderer.on("selected-file",o)}else s("IPC Renderer not available.")},je=i=>{t(o=>{const d=o.findIndex(a=>a.id===i);if(d===-1)return s(`Keybinding with id ${i} not found in config.`),o;const l=[...o];return l.splice(d,1),s(`Deleting binding with id: ${i}`),I(l),s(`Binding deleted for id ${i}`),l})};n.reactExports.useEffect(()=>{m&&L&&(s(`Loading config for profile: ${m}`),T(m))},[m,L,T]);const Ie=i=>Q?Q.basename(i):i,re=n.reactExports.useCallback((i,o,d)=>{if(d===""||d==="-"||d==="-."||/^-?\d*\.?\d*$/.test(d)){const a=e.find(u=>u.id===i);a&&R(i,{...a.binding,[o]:d})}const l=parseFloat(d);if(!isNaN(l)){if(o==="pitch"&&(l<-12||l>12))return;const a=e.find(u=>u.id===i);a&&R(i,{...a.binding,[o]:l})}},[e,R]),Re=()=>{if(f.current&&f.current.readyState===WebSocket.OPEN)try{f.current.send("GET_PROFILES")}catch(i){s(`Error loading profiles: ${i}`)}else s("Cannot load profiles: WebSocket is not open.")},K=i=>{var o,d;if(i.trim())try{(o=f.current)==null||o.send(`CREATE_PROFILE:${i}`),j(a=>[...a,i]),E(i),t([]),s(`New profile created and switched to: ${i}`);const l={};(d=f.current)==null||d.send(`SAVE_CONFIG:${JSON.stringify({profile:i,config:l})}`),s(`New profile configuration saved for ${i}`)}catch(l){console.error("Error creating profile:",l),s(`Error creating profile: ${l}`)}else s("Attempted to create profile with empty name");W(!1)},Le=()=>{var i,o;if(m){(i=f.current)==null||i.send(`DELETE_PROFILE:${m}`),j(l=>l.filter(a=>a!==m));const d=$.find(l=>l!==m)||null;d?(E(d),t([]),(o=f.current)==null||o.send(`SWITCH_PROFILE:${d}`),T(d)):(E(null),t([])),s(`Profile '${m}' deleted successfully`)}J(!1)},We=()=>n.jsx("div",{className:"loading-screen",children:n.jsxs("div",{className:"loading-content",children:[n.jsx("div",{className:"spinner"}),n.jsx("p",{className:"loading-message",children:"Loading profiles, please wait..."})]})});return!L||!Z?n.jsx(We,{}):$.length===0?n.jsxs("div",{className:"main-container",children:[n.jsx("div",{className:"profile-section",children:n.jsxs("div",{children:[n.jsx("p",{children:"No profiles available. Please create a new profile."}),n.jsx("button",{className:"button",onClick:()=>W(!0),children:"Create Profile"})]})}),n.jsx(D,{isOpen:ee,onClose:()=>W(!1),onSubmit:K,title:"Create New Profile",submitText:"Create",cancelText:"Cancel",inputPlaceholder:"Enter profile name",showInput:!0})]}):n.jsxs("div",{className:"main-container",children:[!L||!Z?n.jsxs("div",{className:"spinner-container",children:[n.jsx("div",{className:"spinner-message",children:"Loading profiles, please wait..."}),n.jsx("div",{className:"spinner",children:"ðŸ”„"})]}):n.jsx(n.Fragment,{children:m?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"profile-section",children:n.jsxs("div",{className:"profile-select-wrapper",children:[n.jsxs("div",{children:[n.jsx("label",{htmlFor:"profile-select",style:{marginRight:"10px"},children:"Profile:"}),n.jsx("select",{id:"profile-select",value:m,onChange:i=>ve(i.target.value),className:"profile-select",children:$.map(i=>n.jsx("option",{value:i,children:i},i))})]}),n.jsxs("div",{className:"profile-buttons",children:[n.jsx("button",{className:"button",onClick:()=>H(!0),children:"New Profile"}),n.jsx("button",{className:"button delete-profile",onClick:()=>J(!0),children:"Delete Profile"})]})]})}),n.jsxs("div",{className:"add-binding-container",children:[n.jsx("input",{type:"text",readOnly:!0,value:x?w?`Editing ${P||""}: Press new key...`:"Press a key combination...":"Click Add Binding to start",className:"key-binding-input"}),n.jsx("button",{className:"button",onClick:Ne,disabled:x||w,children:x?"Listening...":"Add Binding"})]}),n.jsx("input",{type:"file",ref:he,className:"file-input",accept:"audio/*"}),n.jsx("div",{className:`binding-list-fade ${ye?"fade-out":""}`,children:e.map(i=>n.jsxs("div",{className:"binding-card",children:[n.jsx("button",{className:"delete-button",onClick:()=>je(i.id),children:"âœ–"}),n.jsx("input",{type:"text",readOnly:!0,value:i.key,className:"key-binding-input"}),n.jsx("button",{className:"button",onClick:()=>Ce(i.id,i.key),disabled:x||w,children:"Edit"}),n.jsx("select",{value:i.binding.track,onChange:o=>R(i.id,{...i.binding,track:o.target.value}),className:"track-select",children:Array.from({length:15},(o,d)=>n.jsxs("option",{value:`A${d+1}`,children:["A",d+1]},d))}),n.jsx("input",{type:"text",readOnly:!0,value:Ie(i.binding.path),className:"key-binding-input"}),n.jsx("button",{className:"button",onClick:()=>Pe(i.id),children:"Audio..."}),n.jsxs("div",{className:"input-wrapper",children:[n.jsx("span",{className:"volume-icon",children:n.jsx(Ve,{})}),n.jsx("input",{type:"number",value:i.binding.volume,onChange:o=>re(i.id,"volume",o.target.value),className:"number-input"}),n.jsx("span",{className:"input-label",children:"dB"})]}),n.jsxs("div",{className:"input-wrapper",children:[n.jsx("span",{className:"wave-square-icon",children:n.jsx(Ge,{})}),n.jsx("input",{type:"number",value:i.binding.pitch,onChange:o=>re(i.id,"pitch",o.target.value),min:"-12",max:"12",step:"1",className:"number-input"}),n.jsx("span",{className:"input-label",children:"st"})]})]},i.id))})]}):n.jsx("div",{className:"profile-section",children:n.jsxs("div",{children:[n.jsx("p",{children:"No profiles available. Please create a new profile."}),n.jsx("button",{className:"button",onClick:()=>H(!0),children:"Create Profile"})]})})}),n.jsx(D,{isOpen:be,onClose:()=>H(!1),onSubmit:K,title:"Create New Profile",submitText:"Create",cancelText:"Cancel",inputPlaceholder:"Enter profile name",showInput:!0}),n.jsx(D,{isOpen:xe,onClose:()=>J(!1),onSubmit:Le,title:`Delete Profile "${m}"`,submitText:"Delete",cancelText:"Cancel",showInput:!1}),n.jsx(D,{isOpen:ee,onClose:()=>W(!1),onSubmit:K,title:"Create New Profile",submitText:"Create",cancelText:"Cancel",inputPlaceholder:"Enter profile name",showInput:!0})]})};Me();n.client.createRoot(document.getElementById("root")).render(n.jsx(n.React.StrictMode,{children:n.jsx(et,{})}));
//# sourceMappingURL=main-01237470.js.map
