"use strict";var exports = typeof exports === "undefined" ? {} : exports;;const N=typeof cep_node !== 'undefined'?cep_node.require(cep_node.global["__dir"+"name"] + "/assets/client-b54d271c.js"):require("../assets/client-b54d271c.js");var x={exports:{}},ee={},ae=function(r){return r&&typeof r=="object"&&typeof r.copy=="function"&&typeof r.fill=="function"&&typeof r.readUInt8=="function"},V={exports:{}};typeof Object.create=="function"?V.exports=function(r,n){r.super_=n,r.prototype=Object.create(n.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}})}:V.exports=function(r,n){r.super_=n;var i=function(){};i.prototype=n.prototype,r.prototype=new i,r.prototype.constructor=r};var le=V.exports;(function(e){var r=/%[sdj%]/g;e.format=function(t){if(!b(t)){for(var o=[],s=0;s<arguments.length;s++)o.push(l(arguments[s]));return o.join(" ")}for(var s=1,g=arguments,j=g.length,h=String(t).replace(r,function(y){if(y==="%%")return"%";if(s>=j)return y;switch(y){case"%s":return String(g[s++]);case"%d":return Number(g[s++]);case"%j":try{return JSON.stringify(g[s++])}catch{return"[Circular]"}default:return y}}),f=g[s];s<j;f=g[++s])u(f)||!P(f)?h+=" "+f:h+=" "+l(f);return h},e.deprecate=function(t,o){if(S(N.commonjsGlobal.process))return function(){return e.deprecate(t,o).apply(this,arguments)};if(process.noDeprecation===!0)return t;var s=!1;function g(){if(!s){if(process.throwDeprecation)throw new Error(o);process.traceDeprecation?console.trace(o):console.error(o),s=!0}return t.apply(this,arguments)}return g};var n={},i;e.debuglog=function(t){if(S(i)&&(i={}.NODE_DEBUG||""),t=t.toUpperCase(),!n[t])if(new RegExp("\\b"+t+"\\b","i").test(i)){var o=process.pid;n[t]=function(){var s=e.format.apply(e,arguments);console.error("%s %d: %s",t,o,s)}}else n[t]=function(){};return n[t]};function l(t,o){var s={seen:[],stylize:d};return arguments.length>=3&&(s.depth=arguments[2]),arguments.length>=4&&(s.colors=arguments[3]),a(o)?s.showHidden=o:o&&e._extend(s,o),S(s.showHidden)&&(s.showHidden=!1),S(s.depth)&&(s.depth=2),S(s.colors)&&(s.colors=!1),S(s.customInspect)&&(s.customInspect=!0),s.colors&&(s.stylize=p),_(s,t,s.depth)}e.inspect=l,l.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},l.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"};function p(t,o){var s=l.styles[o];return s?"\x1B["+l.colors[s][0]+"m"+t+"\x1B["+l.colors[s][1]+"m":t}function d(t,o){return t}function c(t){var o={};return t.forEach(function(s,g){o[s]=!0}),o}function _(t,o,s){if(t.customInspect&&o&&J(o.inspect)&&o.inspect!==e.inspect&&!(o.constructor&&o.constructor.prototype===o)){var g=o.inspect(s,t);return b(g)||(g=_(t,g,s)),g}var j=C(t,o);if(j)return j;var h=Object.keys(o),f=c(h);if(t.showHidden&&(h=Object.getOwnPropertyNames(o)),R(o)&&(h.indexOf("message")>=0||h.indexOf("description")>=0))return k(o);if(h.length===0){if(J(o)){var y=o.name?": "+o.name:"";return t.stylize("[Function"+y+"]","special")}if(z(o))return t.stylize(RegExp.prototype.toString.call(o),"regexp");if(L(o))return t.stylize(Date.prototype.toString.call(o),"date");if(R(o))return k(o)}var E="",F=!1,U=["{","}"];if(I(o)&&(F=!0,U=["[","]"]),J(o)){var se=o.name?": "+o.name:"";E=" [Function"+se+"]"}if(z(o)&&(E=" "+RegExp.prototype.toString.call(o)),L(o)&&(E=" "+Date.prototype.toUTCString.call(o)),R(o)&&(E=" "+k(o)),h.length===0&&(!F||o.length==0))return U[0]+E+U[1];if(s<0)return z(o)?t.stylize(RegExp.prototype.toString.call(o),"regexp"):t.stylize("[Object]","special");t.seen.push(o);var q;return F?q=T(t,o,s,f,h):q=h.map(function(ce){return D(t,o,s,f,ce,F)}),t.seen.pop(),H(q,E,U)}function C(t,o){if(S(o))return t.stylize("undefined","undefined");if(b(o)){var s="'"+JSON.stringify(o).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(s,"string")}if(O(o))return t.stylize(""+o,"number");if(a(o))return t.stylize(""+o,"boolean");if(u(o))return t.stylize("null","null")}function k(t){return"["+Error.prototype.toString.call(t)+"]"}function T(t,o,s,g,j){for(var h=[],f=0,y=o.length;f<y;++f)Y(o,String(f))?h.push(D(t,o,s,g,String(f),!0)):h.push("");return j.forEach(function(E){E.match(/^\d+$/)||h.push(D(t,o,s,g,E,!0))}),h}function D(t,o,s,g,j,h){var f,y,E;if(E=Object.getOwnPropertyDescriptor(o,j)||{value:o[j]},E.get?E.set?y=t.stylize("[Getter/Setter]","special"):y=t.stylize("[Getter]","special"):E.set&&(y=t.stylize("[Setter]","special")),Y(g,j)||(f="["+j+"]"),y||(t.seen.indexOf(E.value)<0?(u(s)?y=_(t,E.value,null):y=_(t,E.value,s-1),y.indexOf(`
`)>-1&&(h?y=y.split(`
`).map(function(F){return"  "+F}).join(`
`).substr(2):y=`
`+y.split(`
`).map(function(F){return"   "+F}).join(`
`))):y=t.stylize("[Circular]","special")),S(f)){if(h&&j.match(/^\d+$/))return y;f=JSON.stringify(""+j),f.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(f=f.substr(1,f.length-2),f=t.stylize(f,"name")):(f=f.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),f=t.stylize(f,"string"))}return f+": "+y}function H(t,o,s){var g=t.reduce(function(j,h){return h.indexOf(`
`)>=0,j+h.replace(/\u001b\[\d\d?m/g,"").length+1},0);return g>60?s[0]+(o===""?"":o+`
 `)+" "+t.join(`,
  `)+" "+s[1]:s[0]+o+" "+t.join(", ")+" "+s[1]}function I(t){return Array.isArray(t)}e.isArray=I;function a(t){return typeof t=="boolean"}e.isBoolean=a;function u(t){return t===null}e.isNull=u;function m(t){return t==null}e.isNullOrUndefined=m;function O(t){return typeof t=="number"}e.isNumber=O;function b(t){return typeof t=="string"}e.isString=b;function $(t){return typeof t=="symbol"}e.isSymbol=$;function S(t){return t===void 0}e.isUndefined=S;function z(t){return P(t)&&K(t)==="[object RegExp]"}e.isRegExp=z;function P(t){return typeof t=="object"&&t!==null}e.isObject=P;function L(t){return P(t)&&K(t)==="[object Date]"}e.isDate=L;function R(t){return P(t)&&(K(t)==="[object Error]"||t instanceof Error)}e.isError=R;function J(t){return typeof t=="function"}e.isFunction=J;function ne(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}e.isPrimitive=ne,e.isBuffer=ae;function K(t){return Object.prototype.toString.call(t)}function X(t){return t<10?"0"+t.toString(10):t.toString(10)}var oe=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function ie(){var t=new Date,o=[X(t.getHours()),X(t.getMinutes()),X(t.getSeconds())].join(":");return[t.getDate(),oe[t.getMonth()],o].join(" ")}e.log=function(){console.log("%s - %s",ie(),e.format.apply(e,arguments))},e.inherits=le,e._extend=function(t,o){if(!o||!P(o))return t;for(var s=Object.keys(o),g=s.length;g--;)t[s[g]]=o[s[g]];return t};function Y(t,o){return Object.prototype.hasOwnProperty.call(t,o)}})(ee);var ue=process.platform==="win32",A=ee;function B(e,r){for(var n=[],i=0;i<e.length;i++){var l=e[i];!l||l==="."||(l===".."?n.length&&n[n.length-1]!==".."?n.pop():r&&n.push(".."):n.push(l))}return n}function W(e){for(var r=e.length-1,n=0;n<=r&&!e[n];n++);for(var i=r;i>=0&&!e[i];i--);return n===0&&i===r?e:n>i?[]:e.slice(n,i+1)}var re=/^([a-zA-Z]:|[\\\/]{2}[^\\\/]+[\\\/]+[^\\\/]+)?([\\\/])?([\s\S]*?)$/,fe=/^([\s\S]*?)((?:\.{1,2}|[^\\\/]+?|)(\.[^.\/\\]*|))(?:[\\\/]*)$/,v={};function G(e){var r=re.exec(e),n=(r[1]||"")+(r[2]||""),i=r[3]||"",l=fe.exec(i),p=l[1],d=l[2],c=l[3];return[n,p,d,c]}function Q(e){var r=re.exec(e),n=r[1]||"",i=!!n&&n[1]!==":";return{device:n,isUnc:i,isAbsolute:i||!!r[2],tail:r[3]}}function te(e){return"\\\\"+e.replace(/^[\\\/]+/,"").replace(/[\\\/]+/g,"\\")}v.resolve=function(){for(var e="",r="",n=!1,i=arguments.length-1;i>=-1;i--){var l;if(i>=0?l=arguments[i]:e?(l=process.env["="+e],(!l||l.substr(0,3).toLowerCase()!==e.toLowerCase()+"\\")&&(l=e+"\\")):l=process.cwd(),A.isString(l)){if(!l)continue}else throw new TypeError("Arguments to path.resolve must be strings");var p=Q(l),d=p.device,c=p.isUnc,_=p.isAbsolute,C=p.tail;if(!(d&&e&&d.toLowerCase()!==e.toLowerCase())&&(e||(e=d),n||(r=C+"\\"+r,n=_),e&&n))break}return c&&(e=te(e)),r=B(r.split(/[\\\/]+/),!n).join("\\"),e+(n?"\\":"")+r||"."};v.normalize=function(e){var r=Q(e),n=r.device,i=r.isUnc,l=r.isAbsolute,p=r.tail,d=/[\\\/]$/.test(p);return p=B(p.split(/[\\\/]+/),!l).join("\\"),!p&&!l&&(p="."),p&&d&&(p+="\\"),i&&(n=te(n)),n+(l?"\\":"")+p};v.isAbsolute=function(e){return Q(e).isAbsolute};v.join=function(){for(var e=[],r=0;r<arguments.length;r++){var n=arguments[r];if(!A.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&e.push(n)}var i=e.join("\\");return/^[\\\/]{2}[^\\\/]/.test(e[0])||(i=i.replace(/^[\\\/]{2,}/,"\\")),v.normalize(i)};v.relative=function(e,r){e=v.resolve(e),r=v.resolve(r);for(var n=e.toLowerCase(),i=r.toLowerCase(),l=W(r.split("\\")),p=W(n.split("\\")),d=W(i.split("\\")),c=Math.min(p.length,d.length),_=c,C=0;C<c;C++)if(p[C]!==d[C]){_=C;break}if(_==0)return r;for(var k=[],C=_;C<p.length;C++)k.push("..");return k=k.concat(l.slice(_)),k.join("\\")};v._makeLong=function(e){if(!A.isString(e))return e;if(!e)return"";var r=v.resolve(e);return/^[a-zA-Z]\:\\/.test(r)?"\\\\?\\"+r:/^\\\\[^?.]/.test(r)?"\\\\?\\UNC\\"+r.substring(2):e};v.dirname=function(e){var r=G(e),n=r[0],i=r[1];return!n&&!i?".":(i&&(i=i.substr(0,i.length-1)),n+i)};v.basename=function(e,r){var n=G(e)[2];return r&&n.substr(-1*r.length)===r&&(n=n.substr(0,n.length-r.length)),n};v.extname=function(e){return G(e)[3]};v.format=function(e){if(!A.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var r=e.root||"";if(!A.isString(r))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var n=e.dir,i=e.base||"";return n?n[n.length-1]===v.sep?n+i:n+v.sep+i:i};v.parse=function(e){if(!A.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var r=G(e);if(!r||r.length!==4)throw new TypeError("Invalid path '"+e+"'");return{root:r[0],dir:r[0]+r[1].slice(0,-1),base:r[2],ext:r[3],name:r[2].slice(0,r[2].length-r[3].length)}};v.sep="\\";v.delimiter=";";var pe=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,w={};function M(e){return pe.exec(e).slice(1)}w.resolve=function(){for(var e="",r=!1,n=arguments.length-1;n>=-1&&!r;n--){var i=n>=0?arguments[n]:process.cwd();if(A.isString(i)){if(!i)continue}else throw new TypeError("Arguments to path.resolve must be strings");e=i+"/"+e,r=i[0]==="/"}return e=B(e.split("/"),!r).join("/"),(r?"/":"")+e||"."};w.normalize=function(e){var r=w.isAbsolute(e),n=e&&e[e.length-1]==="/";return e=B(e.split("/"),!r).join("/"),!e&&!r&&(e="."),e&&n&&(e+="/"),(r?"/":"")+e};w.isAbsolute=function(e){return e.charAt(0)==="/"};w.join=function(){for(var e="",r=0;r<arguments.length;r++){var n=arguments[r];if(!A.isString(n))throw new TypeError("Arguments to path.join must be strings");n&&(e?e+="/"+n:e+=n)}return w.normalize(e)};w.relative=function(e,r){e=w.resolve(e).substr(1),r=w.resolve(r).substr(1);for(var n=W(e.split("/")),i=W(r.split("/")),l=Math.min(n.length,i.length),p=l,d=0;d<l;d++)if(n[d]!==i[d]){p=d;break}for(var c=[],d=p;d<n.length;d++)c.push("..");return c=c.concat(i.slice(p)),c.join("/")};w._makeLong=function(e){return e};w.dirname=function(e){var r=M(e),n=r[0],i=r[1];return!n&&!i?".":(i&&(i=i.substr(0,i.length-1)),n+i)};w.basename=function(e,r){var n=M(e)[2];return r&&n.substr(-1*r.length)===r&&(n=n.substr(0,n.length-r.length)),n};w.extname=function(e){return M(e)[3]};w.format=function(e){if(!A.isObject(e))throw new TypeError("Parameter 'pathObject' must be an object, not "+typeof e);var r=e.root||"";if(!A.isString(r))throw new TypeError("'pathObject.root' must be a string or undefined, not "+typeof e.root);var n=e.dir?e.dir+w.sep:"",i=e.base||"";return n+i};w.parse=function(e){if(!A.isString(e))throw new TypeError("Parameter 'pathString' must be a string, not "+typeof e);var r=M(e);if(!r||r.length!==4)throw new TypeError("Invalid path '"+e+"'");return r[1]=r[1]||"",r[2]=r[2]||"",r[3]=r[3]||"",{root:r[0],dir:r[0]+r[1].slice(0,-1),base:r[2],ext:r[3],name:r[2].slice(0,r[2].length-r[3].length)}};w.sep="/";w.delimiter=":";ue?x.exports=v:x.exports=w;x.exports.posix=w;x.exports.win32=v;var de=x.exports;const ge=N.getDefaultExportFromCjs(de),me=()=>{const e=N.reactExports.useRef(null),r=N.reactExports.useRef({}),[n,i]=N.reactExports.useState({}),[l,p]=N.reactExports.useState([]);N.reactExports.useEffect(()=>(console.log("useEffect hook is running"),d(),()=>{e.current&&e.current.close()}),[]),N.reactExports.useEffect(()=>{e.current&&(e.current.onmessage=a=>{const u=a.data;if(c(`Received message: ${u}`),typeof u=="string"){if(u.startsWith("CONFIG:")){const m=JSON.parse(u.replace("CONFIG:",""));i(m),r.current=m,c("Config loaded successfully from server"),c(`Updated config: ${JSON.stringify(m,null,2)}`)}else if(u.startsWith("COMBO:")){const m=u.replace("COMBO:","");c(`Combo received: ${m}`),D(m).catch(O=>{c(`Error in handleCombo: ${O}`)})}}})},[]),N.reactExports.useEffect(()=>{const a=setInterval(C,5e3);return()=>clearInterval(a)},[]);const d=N.reactExports.useCallback(()=>{if(console.log("Attempting to establish WebSocket connection..."),e.current&&e.current.readyState===WebSocket.OPEN){console.log("WebSocket is already connected");return}try{e.current=new WebSocket("ws://localhost:7878"),console.log("WebSocket connection object created"),e.current.onopen=()=>{console.log("WebSocket connected to Rust server"),c("Connected to Rust server"),_()},e.current.onerror=a=>{console.error("WebSocket error encountered:",a),c(`WebSocket error: ${a instanceof ErrorEvent?a.message:"Unknown error"}`)},e.current.onclose=a=>{console.log(`WebSocket closed: ${a.reason}`),c(`WebSocket closed: ${a.reason}`),setTimeout(d,5e3)}}catch(a){console.error("WebSocket connection failed:",a),c("WebSocket connection failed: "+a.message)}},[]),c=a=>{console.log("Debug log:",a),p(u=>[...u,a])},_=()=>{var a;try{(a=e.current)==null||a.send("LOAD_CONFIG")}catch(u){console.error("Error loading config:",u),I(`Error loading config: ${u}`)}},C=()=>{var a;((a=e.current)==null?void 0:a.readyState)===WebSocket.CLOSED&&(c("WebSocket disconnected. Attempting to reconnect..."),d())},k=()=>new Promise((a,u)=>{if(e.current&&e.current.readyState===WebSocket.OPEN){const m=O=>{var $;const b=O.data;if(typeof b=="string"&&b.startsWith("CONFIG:")){const S=JSON.parse(b.replace("CONFIG:",""));($=e.current)==null||$.removeEventListener("message",m),r.current=S,i(S),a(S)}};e.current.addEventListener("message",m),e.current.send("LOAD_CONFIG")}else u(new Error("WebSocket is not connected"))}),T=a=>{const u={LAlt:"Alt",RAlt:"Alt",LControl:"Ctrl",RControl:"Ctrl",ControlLeft:"Ctrl",ControlRight:"Ctrl",Numpad1:"1",Numpad2:"2",Numpad3:"3",Numpad4:"4",Numpad5:"5",Numpad6:"6",Numpad7:"7",Numpad8:"8",Numpad9:"9",Numpad0:"0"},m=["ctrl","shift","alt"];return a.split("+").map($=>u[$]||$).map($=>$.toLowerCase()).sort(($,S)=>{const z=m.indexOf($),P=m.indexOf(S);return z===-1&&P===-1?$.localeCompare(S):z===-1?1:P===-1?-1:z-P}).join("+")},D=async a=>{c(`Handling combo: ${a}`);try{const u=await k();if(c(`Fetched latest config: ${JSON.stringify(u,null,2)}`),Object.keys(u).length===0){c("Config is empty, no bindings to process");return}const m=T(a);c(`Normalized combo: ${m}`);const O=Object.fromEntries(Object.entries(u).map(([b,$])=>[T(b),$]));if(c(`Normalized config: ${JSON.stringify(O,null,2)}`),O[m]){const b=O[m];c(`Found binding for combo: ${m}`),b.path?(c(`Executing script for path: ${b.path}, track: ${b.track}, volume: ${b.volume}dB, and pitch: ${b.pitch} semitones`),H(b.path,parseInt(b.track.replace("A",""),10),b.volume,b.pitch||0)):c(`No path specified for combo: ${m}`)}else c(`Combo ${m} not found in config. Skipping execution.`)}catch(u){c(`Error handling combo: ${u}`)}},H=(a,u,m,O)=>{c(`Executing script with parameters: filePath=${a}, track=${u}, volume=${m}, pitch=${O}`);const b="./jsx/importAudio.jsx",S=ge.resolve(__dirname,b).replace(/\\/g,"\\\\"),z=a.replace(/\\/g,"\\\\"),P=`
            try {
                var jsxFile = new File("${S}");
                if (jsxFile.exists) {
                    $.evalFile(jsxFile);
                    var result = importAudioToTrack("${z}", ${u}, ${m}, ${O}, true);
                    result; // Return the result from the function
                } else {
                    throw new Error("JSX file not found at: " + jsxFile.fsName);
                }
            } catch(e) {
                // Return the error as a JSON string
                JSON.stringify({
                    success: false,
                    message: e.toString(),
                    debugLog: "Error occurred while executing JSX script."
                });
            }
        `;c(`Evaluating script:
${P}`),window.__adobe_cep__&&window.__adobe_cep__.evalScript?window.__adobe_cep__.evalScript(P,L=>{c(`Script execution result: ${L}`);try{const R=JSON.parse(L);R.success?c(`JSX script executed successfully: ${R.message}`):c(`Error in JSX script: ${R.message}`),c(`Debug Log:
${R.debugLog}`)}catch(R){c(`Failed to parse result from JSX script: ${R}`),c(`Raw result: ${L}`)}}):c("window.__adobe_cep__.evalScript is not available")},I=a=>{window.electron&&window.electron.ipcRenderer&&window.electron.ipcRenderer.send("background-log",a)};return null};N.client.createRoot(document.getElementById("root")).render(N.jsx(N.React.StrictMode,{children:N.jsx(me,{})}));const{spawn:be}=require("child_process"),Z=require("path"),he=require("fs");function ye(){if(console.log("Starting Rust server..."),typeof process<"u"&&process.versions!=null&&process.versions.node!=null){console.log("Node.js environment detected. Node version:",process.version);const e=ve();console.log("Extension root path:",e);let r=Z.join(e,"target","release","audio_importer.exe");if(r=r.replace("file:\\",""),r=Z.normalize(r),console.log("Corrected Rust executable path:",r),!he.existsSync(r)){console.error(`Rust executable not found at ${r}`);return}const n=be(r,[],{cwd:Z.dirname(r),env:process.env,stdio:"inherit"});n.on("error",i=>{console.error(`Failed to start Rust server: ${i}`)}),n.on("close",i=>{i!==0?console.error(`Rust server process exited with code ${i}`):console.log("Rust server process exited successfully")})}else console.error("This script should only be run in a Node.js environment.")}function ve(){return window.__adobe_cep__?window.__adobe_cep__.getSystemPath("extension"):process.cwd()}console.log("Background script loaded. Starting Rust server...");ye();
//# sourceMappingURL=settings-e8981aae.js.map
